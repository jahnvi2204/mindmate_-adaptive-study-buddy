(()=>{var e={};e.id=931,e.ids=[931],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2254:e=>{"use strict";e.exports=require("node:buffer")},7561:e=>{"use strict";e.exports=require("node:fs")},8849:e=>{"use strict";e.exports=require("node:http")},2286:e=>{"use strict";e.exports=require("node:https")},7503:e=>{"use strict";e.exports=require("node:net")},9411:e=>{"use strict";e.exports=require("node:path")},7742:e=>{"use strict";e.exports=require("node:process")},4492:e=>{"use strict";e.exports=require("node:stream")},9557:e=>{"use strict";e.exports=require("node:stream/web")},3020:e=>{"use strict";e.exports=require("node:url")},7261:e=>{"use strict";e.exports=require("node:util")},5628:e=>{"use strict";e.exports=require("node:zlib")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},7282:e=>{"use strict";e.exports=require("process")},3477:e=>{"use strict";e.exports=require("querystring")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},1267:e=>{"use strict";e.exports=require("worker_threads")},9796:e=>{"use strict";e.exports=require("zlib")},8359:()=>{},3739:()=>{},6324:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>c,routeModule:()=>h,tree:()=>u}),r(908),r(1506),r(5866);var n=r(3191),i=r(8716),s=r(7922),o=r.n(s),a=r(5231),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let u=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,908)),"C:\\Users\\JAHNVI SAXENA\\Desktop\\mindmate_-adaptive-study-buddy\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,1506)),"C:\\Users\\JAHNVI SAXENA\\Desktop\\mindmate_-adaptive-study-buddy\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\JAHNVI SAXENA\\Desktop\\mindmate_-adaptive-study-buddy\\app\\page.tsx"],d="/page",p={require:r,loadChunk:()=>Promise.resolve()},h=new n.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},1604:()=>{},2534:(e,t,r)=>{Promise.resolve().then(r.bind(r,2477))},2824:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},2477:(e,t,r)=>{"use strict";let n,i;r.r(t),r.d(t,{default:()=>nN});var s,o,a,l,u,c,d,p,h,f,m,g,y,v,_,b,E,x,w,A,T,S,C,O,N,I,k,R,P,j,M,U,D,L,G,F,q,H,B,V,$,J,W,z,K,Y,X,Q,Z,ee,et,er,en,ei,es,eo,ea,el,eu=r(326),ec=r(7577),ed=r.n(ec);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let ep=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),eh=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),ef=e=>{let t=eh(e);return t.charAt(0).toUpperCase()+t.slice(1)},em=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),eg=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ey={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let ev=(0,ec.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...a},l)=>(0,ec.createElement)("svg",{ref:l,...ey,width:t,height:t,stroke:e,strokeWidth:n?24*Number(r)/Number(t):r,className:em("lucide",i),...!s&&!eg(a)&&{"aria-hidden":"true"},...a},[...o.map(([e,t])=>(0,ec.createElement)(e,t)),...Array.isArray(s)?s:[s]])),e_=(e,t)=>{let r=(0,ec.forwardRef)(({className:r,...n},i)=>(0,ec.createElement)(ev,{ref:i,iconNode:t,className:em(`lucide-${ep(ef(e))}`,`lucide-${e}`,r),...n}));return r.displayName=ef(e),r},eb=e_("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),eE=e_("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),ex=e_("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),ew=e_("brain-circuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]),eA=e_("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),eT=e_("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]),eS=e_("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),eC=e_("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),eO=e_("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),eN=e_("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),eI=e_("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),ek=e_("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),eR=e_("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);(function(e){e.SIMPLE="Simple & Direct",e.DETAILED="Detailed Academic",e.ANALOGY="Analogy Based",e.SOCHRATIC="Socratic Method"})(s||(s={})),function(e){e.DASHBOARD="dashboard",e.MATERIALS="materials",e.PLAN="plan",e.QUIZ="quiz",e.TUTOR="tutor"}(o||(o={}));let eP=({activeTab:e,onTabChange:t,children:r})=>{let[n,i]=ed().useState(!1),[s,a]=(0,ec.useState)(null),[l,u]=(0,ec.useState)(!0);(0,ec.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/me",{credentials:"include"});if(e.ok){let t=await e.json();a(t.user)}else a(null)}catch(e){console.error(e),a(null)}finally{u(!1)}})()},[]);let c=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),a(null)}catch(e){console.error(e)}},d=[{id:o.DASHBOARD,label:"Dashboard",icon:eb},{id:o.MATERIALS,label:"Library",icon:eE},{id:o.PLAN,label:"Roadmap",icon:ex},{id:o.QUIZ,label:"Quiz Mode",icon:ew},{id:o.TUTOR,label:"AI Tutor",icon:eA}];return(0,eu.jsxs)("div",{className:"relative flex h-screen overflow-hidden font-sans text-slate-200",children:[eu.jsx("div",{className:"pointer-events-none absolute inset-0 -z-20 bg-slate-950 bg-[radial-gradient(circle_at_top,_rgba(129,140,248,0.18),_transparent_60%),radial-gradient(circle_at_bottom,_rgba(56,189,248,0.18),_transparent_60%)]"}),eu.jsx("div",{className:"pointer-events-none absolute -top-24 -left-10 h-72 w-72 rounded-full bg-fuchsia-500/25 blur-3xl"}),eu.jsx("div",{className:"pointer-events-none absolute bottom-[-18%] right-[-5%] h-72 w-72 rounded-full bg-cyan-400/20 blur-3xl"}),eu.jsx("div",{className:"pointer-events-none absolute top-1/2 left-1/3 h-80 w-80 -translate-y-1/2 rounded-full bg-violet-500/10 blur-3xl"}),n&&eu.jsx("div",{className:"fixed inset-0 z-40 bg-black/80 backdrop-blur-sm md:hidden transition-opacity duration-300",onClick:()=>i(!1)}),(0,eu.jsxs)("aside",{className:`
          glass-panel
          fixed md:relative inset-y-0 left-0 z-50
          flex w-72 flex-col justify-between
          border-r border-white/10
          bg-slate-950/70 backdrop-blur-2xl
          shadow-[0_20px_60px_rgba(15,23,42,0.95)]
          transform transition-transform duration-300 ease-out
          ${n?"translate-x-0":"-translate-x-full"}
          md:translate-x-0
        `,children:[(0,eu.jsxs)("div",{className:"relative p-7 pb-9",children:[(0,eu.jsxs)("div",{className:"mb-1 flex items-center gap-3",children:[(0,eu.jsxs)("div",{className:"relative flex h-11 w-11 items-center justify-center rounded-2xl bg-gradient-to-br from-violet-500 via-indigo-500 to-sky-500 shadow-[0_16px_40px_rgba(79,70,229,0.7)] ring-1 ring-white/20",children:[eu.jsx(eT,{className:"h-6 w-6 text-white"}),eu.jsx("span",{className:"pointer-events-none absolute -bottom-1.5 right-1 h-3 w-3 rounded-full bg-emerald-400 shadow-[0_0_12px_rgba(52,211,153,0.9)]"})]}),(0,eu.jsxs)("div",{children:[eu.jsx("h1",{className:"text-xl font-bold leading-tight tracking-tight text-white",children:"MindMate"}),eu.jsx("p",{className:"text-[10px] font-bold uppercase tracking-[0.24em] text-violet-300",children:"AI Study Sync"})]})]}),eu.jsx("p",{className:"mt-3 text-xs text-slate-400",children:"Align your notes, plans, and quizzes in one intelligent workspace."}),eu.jsx("button",{onClick:()=>i(!1),className:"absolute right-5 top-6 rounded-full p-1.5 text-slate-400 transition-colors hover:bg-white/10 hover:text-white md:hidden",children:eu.jsx(eS,{className:"h-5 w-5"})})]}),(0,eu.jsxs)("nav",{className:"custom-scrollbar flex-1 space-y-3 overflow-y-auto px-4 pb-4 pt-1",children:[eu.jsx("div",{className:"px-4 text-[11px] font-bold uppercase tracking-[0.22em] text-slate-500",children:"Main Menu"}),d.map(r=>{let n=r.icon,s=e===r.id;return(0,eu.jsxs)("button",{onClick:()=>{t(r.id),i(!1)},className:`
                  group relative flex w-full items-center gap-3 rounded-xl px-4 py-3.5
                  text-left text-sm transition-all duration-300
                  ${s?"bg-gradient-to-r from-violet-600/15 via-indigo-600/15 to-cyan-500/10 text-slate-50 shadow-[0_14px_40px_rgba(79,70,229,0.6)]":"text-slate-400 hover:bg-white/5 hover:text-slate-100"}
                `,children:[s&&eu.jsx("div",{className:"absolute left-1 top-1/2 h-9 w-1 -translate-y-1/2 rounded-full bg-gradient-to-b from-violet-400 via-indigo-400 to-cyan-300 shadow-[0_0_14px_rgba(129,140,248,0.85)]"}),eu.jsx("div",{className:`
                    flex h-8 w-8 items-center justify-center rounded-xl border transition-all duration-300
                    ${s?"border-violet-400/60 bg-violet-500/20 text-violet-200":"border-slate-700/60 bg-slate-900/60 text-slate-400 group-hover:border-slate-500 group-hover:bg-slate-900/80 group-hover:text-slate-100"}
                  `,children:eu.jsx(n,{className:"h-4.5 w-4.5"})}),(0,eu.jsxs)("div",{className:"flex flex-1 items-center justify-between gap-2",children:[eu.jsx("span",{className:`truncate ${s?"font-semibold":"font-medium"}`,children:r.label}),s&&(0,eu.jsxs)("span",{className:"flex items-center gap-1 text-[11px] font-semibold uppercase tracking-[0.16em] text-violet-200",children:[eu.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-violet-300 shadow-[0_0_10px_rgba(196,181,253,0.9)]"}),"Active"]})]})]},r.id)})]}),eu.jsx("div",{className:"mt-auto border-t border-white/5 p-4",children:(0,eu.jsxs)("div",{className:"relative overflow-hidden rounded-2xl border border-white/8 bg-gradient-to-br from-violet-900/30 via-slate-900/60 to-indigo-900/30 p-4 shadow-[0_14px_40px_rgba(15,23,42,0.9)]",children:[eu.jsx("div",{className:"pointer-events-none absolute -right-8 -top-6 h-28 w-28 rounded-full bg-violet-500/25 blur-2xl transition-all duration-500 group-hover:bg-violet-500/30"}),(0,eu.jsxs)("div",{className:"relative z-10 flex items-center gap-3",children:[eu.jsx("div",{className:"flex h-10 w-10 items-center justify-center overflow-hidden rounded-full border border-white/15 bg-slate-900 text-slate-200",children:s?.picture?eu.jsx("img",{src:s.picture,alt:"avatar",className:"h-full w-full object-cover"}):eu.jsx(eC,{className:"h-5 w-5"})}),(0,eu.jsxs)("div",{className:"flex-1 overflow-hidden",children:[eu.jsx("p",{className:"truncate text-sm font-semibold text-white",children:l?"Loading...":s?.name||"Guest"}),(0,eu.jsxs)("div",{className:"mt-0.5 flex items-center gap-1.5 text-xs text-violet-200",children:[eu.jsx(eO,{className:"h-3 w-3 fill-current"}),eu.jsx("span",{children:s?"Signed in":"Sign in to sync"})]})]}),l?(0,eu.jsxs)("div",{className:"rounded-full bg-white/5 px-2.5 py-1 text-[11px] font-semibold uppercase tracking-[0.16em] text-slate-200 flex items-center gap-1.5",children:[eu.jsx(eN,{className:"h-3.5 w-3.5 animate-spin"}),eu.jsx("span",{children:"Checking"})]}):s?(0,eu.jsxs)("button",{onClick:c,className:"inline-flex items-center gap-1 rounded-full bg-white/5 px-2.5 py-1 text-[11px] font-semibold uppercase tracking-[0.16em] text-slate-200 transition-all hover:bg-white/10 active:scale-95",children:[eu.jsx(eI,{className:"h-3.5 w-3.5"}),eu.jsx("span",{children:"Logout"})]}):(0,eu.jsxs)("button",{onClick:()=>{window.location.href="/api/auth/google"},className:"inline-flex items-center gap-1 rounded-full bg-gradient-to-r from-violet-500 to-cyan-500 px-2.5 py-1 text-[11px] font-semibold uppercase tracking-[0.16em] text-white transition-all hover:opacity-90 active:scale-95",children:[eu.jsx(ek,{className:"h-3.5 w-3.5"}),eu.jsx("span",{children:"Sign In"})]})]})]})})]}),(0,eu.jsxs)("main",{className:"relative flex min-w-0 flex-1 flex-col",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 z-0 overflow-hidden",children:[eu.jsx("div",{className:"absolute top-[-15%] left-[8%] h-[420px] w-[520px] rounded-full bg-violet-900/25 blur-[140px]"}),eu.jsx("div",{className:"absolute bottom-[-15%] right-[5%] h-[420px] w-[520px] rounded-full bg-sky-900/25 blur-[130px]"})]}),(0,eu.jsxs)("header",{className:"sticky top-0 z-30 flex items-center justify-between border-b border-white/10 bg-slate-950/85 px-4 py-3 backdrop-blur-2xl md:hidden",children:[(0,eu.jsxs)("div",{className:"flex items-center gap-2",children:[eu.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-xl bg-gradient-to-br from-violet-500 to-indigo-500",children:eu.jsx(ew,{className:"h-4.5 w-4.5 text-white"})}),(0,eu.jsxs)("div",{className:"flex flex-col",children:[eu.jsx("span",{className:"text-sm font-semibold text-white",children:"MindMate"}),eu.jsx("span",{className:"text-[10px] uppercase tracking-[0.18em] text-slate-400",children:"Study Dashboard"})]})]}),eu.jsx("button",{onClick:()=>i(!0),className:"rounded-lg p-2 text-slate-400 transition-colors hover:bg-white/10 hover:text-white",children:eu.jsx(eR,{className:"h-5 w-5"})})]}),(0,eu.jsxs)("header",{className:"hidden items-center justify-between border-b border-white/5 bg-slate-950/70 px-8 py-4 backdrop-blur-2xl md:flex z-20",children:[(0,eu.jsxs)("div",{className:"flex items-center gap-3",children:[(0,eu.jsxs)("div",{className:"rounded-full border border-emerald-400/40 bg-emerald-500/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.18em] text-emerald-200 flex items-center gap-1.5",children:[eu.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-emerald-400 shadow-[0_0_10px_rgba(52,211,153,0.9)]"}),"Focus Session"]}),eu.jsx("span",{className:"text-xs text-slate-400",children:"Optimize your session with dashboard, roadmap & quiz in sync."})]}),(0,eu.jsxs)("div",{className:"flex items-center gap-3",children:[(0,eu.jsxs)("button",{className:"hidden items-center gap-1.5 rounded-full border border-white/10 bg-white/5 px-3 py-1.5 text-xs font-medium text-slate-100 backdrop-blur hover:bg-white/10 lg:flex",children:[eu.jsx(eO,{className:"h-3.5 w-3.5 text-amber-300"}),"Quick Start"]}),(0,eu.jsxs)("button",{className:"flex items-center gap-1.5 rounded-full border border-white/10 bg-white/5 px-3 py-1.5 text-xs font-medium text-slate-100 backdrop-blur hover:bg-white/10",children:[eu.jsx(eI,{className:"h-3.5 w-3.5"}),"Logout"]})]})]}),eu.jsx("div",{className:"relative z-10 flex-1 overflow-y-auto overflow-x-hidden scroll-smooth px-4 py-4 md:px-8 md:py-8 lg:px-10 lg:py-10",children:eu.jsx("div",{className:"mx-auto h-full max-w-7xl animate-fadeIn",children:r})})]})]})},ej=e_("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),eM=e_("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),eU=e_("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),eD=e_("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),eL=e_("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),eG=({onLogin:e})=>{let t=[{icon:ew,title:"AI Study Copilot",desc:"Adaptive plans, quizzes, and tutoring from your notes."},{icon:ej,title:"Private & Secure",desc:"OAuth sign-in with Google. Your sessions stay in your browser."},{icon:ek,title:"Premium UI",desc:"Glassmorphism, neon glows, and smooth motion for focus."}];return(0,eu.jsxs)("div",{className:"relative min-h-screen bg-ambient text-slate-100",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[eu.jsx("div",{className:"absolute -top-24 -left-10 h-80 w-80 rounded-full bg-violet-500/25 blur-3xl"}),eu.jsx("div",{className:"absolute -bottom-32 right-0 h-96 w-96 rounded-full bg-cyan-400/25 blur-3xl"}),eu.jsx("div",{className:"absolute top-1/3 left-1/3 h-96 w-96 rounded-full bg-indigo-500/15 blur-3xl"})]}),(0,eu.jsxs)("div",{className:"relative mx-auto flex max-w-6xl flex-col gap-12 px-6 pb-16 pt-20",children:[(0,eu.jsxs)("div",{className:"flex items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-5 py-3 backdrop-blur-xl",children:[(0,eu.jsxs)("div",{className:"flex items-center gap-3",children:[eu.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-2xl bg-gradient-to-br from-violet-500 via-indigo-500 to-cyan-400 shadow-glow-1",children:eu.jsx(ew,{className:"h-5 w-5 text-white"})}),(0,eu.jsxs)("div",{children:[eu.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-violet-200",children:"MindMate"}),eu.jsx("p",{className:"text-sm text-slate-300",children:"Adaptive Study Buddy"})]})]}),(0,eu.jsxs)("button",{onClick:e,className:"inline-flex items-center gap-2 rounded-full bg-white px-4 py-2 text-sm font-semibold text-slate-950 shadow-[0_20px_60px_rgba(148,163,184,0.6)] transition hover:scale-105",children:[eu.jsx(eM,{className:"h-4 w-4"}),"Sign in with Google"]})]}),eu.jsx("div",{className:"overflow-hidden rounded-[2.5rem] border border-white/10 bg-slate-950/70 backdrop-blur-2xl shadow-[0_28px_90px_rgba(15,23,42,0.9)]",children:(0,eu.jsxs)("div",{className:"grid gap-10 px-8 py-10 md:grid-cols-[1.1fr_0.9fr] md:px-12 md:py-14",children:[(0,eu.jsxs)("div",{className:"space-y-6",children:[(0,eu.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-violet-200",children:[eu.jsx(ek,{className:"h-4 w-4"}),"AI-Powered Study"]}),(0,eu.jsxs)("h1",{className:"hero-title",children:[eu.jsx("span",{className:"text-slate-50",children:"Master faster with "}),eu.jsx("span",{className:"bg-gradient-to-r from-violet-300 via-indigo-200 to-cyan-200 bg-clip-text text-transparent",children:"intelligent guidance"})]}),eu.jsx("p",{className:"text-base leading-relaxed text-slate-300 md:text-lg",children:"Log in to sync your workspace, generate adaptive roadmaps, and chat with an AI tutor grounded in your own materials."}),(0,eu.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,eu.jsxs)("button",{onClick:e,className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-violet-500 via-indigo-500 to-cyan-400 px-6 py-3 text-sm font-bold text-white shadow-glow-1 transition hover:scale-105",children:[eu.jsx(eM,{className:"h-4 w-4"}),"Sign in with Google",eu.jsx(eU,{className:"h-4 w-4"})]}),(0,eu.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-300",children:[eu.jsx(eD,{className:"h-4 w-4 text-amber-300"}),eu.jsx("span",{children:"Premium UI \xb7 Secure OAuth"})]})]})]}),(0,eu.jsxs)("div",{className:"relative",children:[eu.jsx("div",{className:"pointer-events-none absolute -right-10 -top-10 h-40 w-40 rounded-full bg-violet-500/20 blur-3xl"}),eu.jsx("div",{className:"pointer-events-none absolute -left-6 bottom-0 h-32 w-32 rounded-full bg-cyan-400/20 blur-3xl"}),(0,eu.jsxs)("div",{className:"glass relative overflow-hidden rounded-3xl border border-white/10 p-6 shadow-[0_24px_80px_rgba(79,70,229,0.5)]",children:[(0,eu.jsxs)("div",{className:"mb-5 flex items-center justify-between",children:[(0,eu.jsxs)("div",{className:"pill bg-white/5 border-white/10 text-slate-200",children:[eu.jsx(ek,{className:"h-4 w-4"}),"Preview"]}),eu.jsx("div",{className:"text-[11px] uppercase tracking-[0.18em] text-violet-200",children:"Study Flow"})]}),eu.jsx("div",{className:"space-y-4",children:["Generate a tailored roadmap in seconds","Quiz mode with immediate explanations","Upload PDFs or notes to ground the AI","Personalized tutor styles (simple, analogy, Socratic)"].map((e,t)=>(0,eu.jsxs)("div",{className:"flex items-start gap-3 rounded-2xl border border-white/5 bg-white/5 p-3.5 text-sm text-slate-100",style:{animationDelay:`${80*t}ms`},children:[eu.jsx(eL,{className:"mt-0.5 h-5 w-5 text-emerald-300"}),eu.jsx("span",{children:e})]},e))})]})]})]})}),eu.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:t.map((e,t)=>{let r=e.icon;return(0,eu.jsxs)("div",{className:"group relative overflow-hidden rounded-2xl border border-white/8 bg-slate-950/70 p-5 shadow-[0_18px_60px_rgba(15,23,42,0.9)] backdrop-blur-xl transition hover:-translate-y-1 hover:border-white/20",children:[eu.jsx("div",{className:"pointer-events-none absolute -right-10 -top-16 h-32 w-32 rounded-full bg-white/5 blur-3xl opacity-0 transition-opacity duration-500 group-hover:opacity-70"}),eu.jsx("div",{className:"mb-4 inline-flex h-11 w-11 items-center justify-center rounded-xl border border-white/10 bg-white/5 text-violet-200",children:eu.jsx(r,{className:"h-5 w-5"})}),eu.jsx("h3",{className:"text-lg font-semibold text-white",children:e.title}),eu.jsx("p",{className:"mt-2 text-sm leading-relaxed text-slate-300",children:e.desc})]},e.title)})}),(0,eu.jsxs)("div",{className:"flex flex-col items-center gap-4 rounded-3xl border border-white/10 bg-gradient-to-r from-violet-600/20 via-indigo-600/20 to-cyan-500/15 px-6 py-8 text-center shadow-[0_26px_80px_rgba(15,23,42,0.9)]",children:[eu.jsx("div",{className:"pill border-white/20 bg-white/10 text-white",children:"Ready to dive in?"}),eu.jsx("h3",{className:"text-2xl font-bold text-white",children:"Sign in to unlock your adaptive study space"}),eu.jsx("p",{className:"max-w-2xl text-sm text-slate-200",children:"Your materials, plans, quizzes, and tutor history are available after secure Google login. Continue to your workspace in one click."}),(0,eu.jsxs)("button",{onClick:e,className:"mt-2 inline-flex items-center gap-2 rounded-full bg-white px-6 py-3 text-sm font-bold text-slate-950 shadow-[0_20px_60px_rgba(148,163,184,0.8)] transition hover:scale-105",children:[eu.jsx(eM,{className:"h-4 w-4"}),"Sign in with Google",eu.jsx(eU,{className:"h-4 w-4"})]})]})]})]})},eF=e_("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),eq=e_("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),eH=({materials:e,plan:t,onNavigate:r})=>{let n=[{label:"Materials",value:e.length,desc:"Documents uploaded",icon:eE,color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/20",action:o.MATERIALS},{label:"Study Plan",value:t.length>0?`${t.length} Days`:"Inactive",desc:"Current roadmap",icon:ex,color:"text-violet-400",bg:"bg-violet-500/10",border:"border-violet-500/20",action:o.PLAN},{label:"Quiz Mode",value:"Ready",desc:"Test your knowledge",icon:ew,color:"text-emerald-400",bg:"bg-emerald-500/10",border:"border-emerald-500/20",action:o.QUIZ}];return(0,eu.jsxs)("div",{className:"relative space-y-10 pb-12 pt-4 md:pt-6 animate-fadeIn",children:[eu.jsx("div",{className:"pointer-events-none absolute inset-0 -z-10 bg-slate-950 bg-[radial-gradient(circle_at_top,_rgba(129,140,248,0.12),_transparent_55%),radial-gradient(circle_at_bottom,_rgba(16,185,129,0.16),_transparent_55%)]"}),eu.jsx("div",{className:"pointer-events-none absolute -top-32 -left-16 h-72 w-72 rounded-full bg-purple-500/25 blur-3xl"}),eu.jsx("div",{className:"pointer-events-none absolute -bottom-40 -right-20 h-80 w-80 rounded-full bg-cyan-400/25 blur-3xl"}),eu.jsx("div",{className:"pointer-events-none absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 h-96 w-96 rounded-full bg-fuchsia-500/10 blur-3xl"}),(0,eu.jsxs)("div",{className:"relative w-full rounded-[2.5rem] overflow-hidden shadow-[0_32px_80px_rgba(15,23,42,0.85)] border border-white/10 group transition-transform duration-700 hover:-translate-y-1",children:[eu.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950"}),eu.jsx("div",{className:"absolute -top-32 -right-20 h-96 w-96 rounded-full bg-violet-600/30 blur-[120px] mix-blend-screen animate-pulse"}),eu.jsx("div",{className:"absolute -bottom-32 -left-16 h-80 w-80 rounded-full bg-indigo-500/30 blur-[110px] mix-blend-screen"}),eu.jsx("div",{className:"absolute top-1/3 left-10 h-40 w-40 rounded-full bg-emerald-400/10 blur-3xl mix-blend-screen"}),eu.jsx("div",{className:"relative z-10 flex flex-col items-center justify-center py-16 md:py-20 px-6 sm:px-10 text-center",children:(0,eu.jsxs)("div",{className:"backdrop-blur-2xl bg-white/5 border border-white/15 rounded-[2rem] md:rounded-[2.5rem] px-6 py-10 md:px-14 md:py-14 shadow-[0_24px_80px_rgba(15,23,42,0.9)] max-w-4xl mx-auto transform transition-all duration-700 group-hover:scale-[1.015] group-hover:shadow-[0_32px_120px_rgba(79,70,229,0.65)]",children:[(0,eu.jsxs)("div",{className:"inline-flex items-center gap-2.5 px-4 py-1.5 rounded-full bg-slate-900/60 border border-white/15 mb-7 shadow-inner",children:[(0,eu.jsxs)("span",{className:"relative flex h-2.5 w-2.5",children:[eu.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),eu.jsx("span",{className:"relative inline-flex h-2.5 w-2.5 rounded-full bg-emerald-500"})]}),eu.jsx("span",{className:"text-[11px] font-semibold tracking-[0.22em] text-slate-200 uppercase",children:"System Operational"})]}),(0,eu.jsxs)("h1",{className:"text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-extrabold tracking-tight mb-4 leading-tight",children:[eu.jsx("span",{className:"block text-slate-50",children:"Learn Something"}),eu.jsx("span",{className:"bg-gradient-to-r from-purple-400 via-violet-400 to-cyan-300 bg-clip-text text-transparent drop-shadow-[0_12px_40px_rgba(129,140,248,0.75)]",children:"Extraordinary"})]}),eu.jsx("p",{className:"text-slate-300 mt-4 text-base sm:text-lg md:text-xl leading-relaxed max-w-2xl mx-auto font-light",children:"Your AI-powered study companion. Upload your notes, generate adaptive plans, and master any subject with deeply personalized guidance."}),(0,eu.jsxs)("div",{className:"mt-9 flex flex-wrap gap-4 justify-center",children:[(0,eu.jsxs)("button",{onClick:()=>r(o.MATERIALS),className:"px-7 sm:px-8 py-3.5 rounded-full bg-gradient-to-r from-purple-600 via-indigo-600 to-cyan-500 text-white text-sm sm:text-base font-bold shadow-[0_18px_50px_rgba(79,70,229,0.8)] hover:shadow-[0_24px_70px_rgba(56,189,248,0.75)] hover:scale-105 active:scale-95 transition-all duration-300 flex items-center gap-2",children:[eu.jsx(eE,{className:"w-5 h-5"}),"Start Learning"]}),(0,eu.jsxs)("button",{onClick:()=>r(o.TUTOR),className:"px-7 sm:px-8 py-3.5 rounded-full border border-white/25 bg-white/5 text-white text-sm sm:text-base font-semibold hover:bg-white/10 hover:scale-105 active:scale-95 transition-all duration-300 backdrop-blur-xl flex items-center gap-2 shadow-[0_16px_40px_rgba(15,23,42,0.9)]",children:[eu.jsx(ek,{className:"w-5 h-5 text-violet-300"}),"AI Tutor"]})]})]})})]}),eu.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5 md:gap-6",children:n.map((e,t)=>{let n=e.icon;return(0,eu.jsxs)("button",{onClick:()=>r(e.action),className:"group relative h-44 sm:h-48 rounded-[1.9rem] border border-white/10 bg-slate-900/40 p-[1px] overflow-hidden text-left transition-all duration-500 hover:-translate-y-1 hover:border-white/25 hover:shadow-[0_18px_50px_rgba(15,23,42,0.9)]",style:{animationDelay:`${80*t}ms`},children:[(0,eu.jsxs)("div",{className:"relative h-full w-full bg-slate-950/60 backdrop-blur-xl rounded-[1.8rem] p-5 flex flex-col justify-between z-10 transition-all duration-500 group-hover:bg-slate-950/30",children:[(0,eu.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[eu.jsx("div",{className:`p-3.5 rounded-2xl border ${e.bg} ${e.border} ${e.color} transition-transform duration-300 group-hover:scale-110`,children:eu.jsx(n,{className:"w-6 h-6"})}),eu.jsx("div",{className:"w-10 h-10 rounded-full border border-white/15 flex items-center justify-center text-slate-500 group-hover:text-white group-hover:bg-white/10 transition-all duration-300",children:eu.jsx(eU,{className:"w-5 h-5 -rotate-45 group-hover:rotate-0 transition-transform duration-300"})})]}),(0,eu.jsxs)("div",{children:[eu.jsx("p",{className:"text-xs font-semibold text-slate-400 mb-1 uppercase tracking-[0.18em]",children:e.label}),eu.jsx("h3",{className:"text-3xl sm:text-4xl font-bold text-white tracking-tight mb-1 group-hover:translate-x-1 transition-transform",children:e.value}),eu.jsx("p",{className:"text-[13px] font-medium text-slate-400 group-hover:text-slate-200 transition-colors",children:e.desc})]})]}),eu.jsx("div",{className:"pointer-events-none absolute -right-16 -top-20 h-40 w-40 bg-gradient-to-br from-white/40 via-purple-400/20 to-transparent blur-3xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-700"})]},t)})}),(0,eu.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-7 lg:gap-8",children:[(0,eu.jsxs)("div",{className:"lg:col-span-2 relative rounded-[2.4rem] border border-white/10 bg-slate-950/70 backdrop-blur-2xl p-7 sm:p-8 md:p-10 overflow-hidden group shadow-[0_22px_70px_rgba(15,23,42,0.95)]",children:[eu.jsx("div",{className:"pointer-events-none absolute -top-10 -right-8 opacity-[0.04] group-hover:opacity-[0.09] transition-opacity duration-500 scale-150",children:eu.jsx(eF,{className:"w-64 h-64 text-white"})}),(0,eu.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-7 relative z-10",children:[(0,eu.jsxs)("div",{children:[eu.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-violet-300/80 mb-1",children:"Focus Stream"}),eu.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-white",children:eu.jsx("span",{className:"bg-gradient-to-r from-violet-300 via-purple-300 to-emerald-300 bg-clip-text text-transparent",children:"Current Focus"})}),eu.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Priority tasks from your personalized schedule."})]}),0===t.length&&eu.jsx("button",{onClick:()=>r(o.PLAN),className:"px-5 py-2.5 bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-500 hover:to-indigo-500 text-white text-xs sm:text-sm font-bold rounded-xl transition-all shadow-[0_16px_40px_rgba(79,70,229,0.65)] hover:scale-105 active:scale-95",children:"Generate Plan"})]}),t.length>0?eu.jsx("div",{className:"relative z-10 bg-slate-950/70 rounded-3xl p-6 border border-white/10 hover:border-white/20 transition-colors duration-300 shadow-[0_12px_40px_rgba(15,23,42,0.9)]",children:(0,eu.jsxs)("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[eu.jsx("div",{className:"flex-shrink-0",children:(0,eu.jsxs)("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-violet-600 via-purple-600 to-indigo-600 flex flex-col items-center justify-center shadow-[0_18px_50px_rgba(79,70,229,0.85)] text-white",children:[eu.jsx("span",{className:"text-[10px] font-semibold uppercase opacity-80 mb-1 tracking-[0.18em]",children:"Day"}),eu.jsx("span",{className:"text-3xl font-bold leading-none",children:t[0].day})]})}),(0,eu.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,eu.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-[10px] font-semibold uppercase tracking-[0.18em] bg-violet-500/10 text-violet-200 border border-violet-500/25 mb-3",children:[eu.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-violet-400"}),t[0].focusArea]}),eu.jsx("h4",{className:"text-xl sm:text-2xl font-semibold text-white mb-4 truncate",children:t[0].topic}),eu.jsx("div",{className:"space-y-3",children:t[0].activities.slice(0,3).map((e,t)=>(0,eu.jsxs)("div",{className:"flex items-start gap-3 group/item",children:[eu.jsx("div",{className:"mt-2 h-1.5 w-1.5 rounded-full bg-slate-600 group-hover/item:bg-violet-400 transition-colors"}),eu.jsx("span",{className:"text-slate-300 text-sm leading-relaxed group-hover/item:text-white transition-colors",children:e})]},t))})]})]})}):(0,eu.jsxs)("div",{className:"relative z-10 flex flex-col items-center justify-center py-10 text-center border-2 border-dashed border-white/10 rounded-3xl bg-slate-950/40",children:[eu.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-800/60 flex items-center justify-center mb-4 text-slate-400",children:eu.jsx(ex,{className:"w-6 h-6"})}),eu.jsx("p",{className:"text-slate-300 font-medium text-sm",children:"No active plan generated yet."}),eu.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"Create a roadmap and your focus area will appear here."})]})]}),(0,eu.jsxs)("div",{className:"relative rounded-[2.4rem] p-[1px] bg-gradient-to-br from-teal-400/40 via-emerald-500/35 to-slate-800/60 group overflow-hidden shadow-[0_22px_80px_rgba(15,23,42,0.95)]",children:[eu.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-400 via-emerald-400 to-cyan-300 opacity-0 group-hover:opacity-10 blur-2xl transition-opacity duration-700"}),eu.jsx("div",{className:"absolute -top-16 right-0 h-40 w-40 rounded-full bg-emerald-400/30 blur-3xl opacity-40"}),(0,eu.jsxs)("div",{className:"relative h-full rounded-[2.2rem] bg-slate-950/85 backdrop-blur-2xl p-7 sm:p-8 flex flex-col justify-between z-10",children:[(0,eu.jsxs)("div",{children:[eu.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-emerald-500/20 via-teal-500/20 to-cyan-500/20 flex items-center justify-center mb-6 border border-emerald-400/30 group-hover:scale-110 transition-transform duration-300 shadow-[0_12px_40px_rgba(16,185,129,0.65)]",children:eu.jsx(eq,{className:"w-7 h-7 text-emerald-300"})}),eu.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-white mb-2",children:eu.jsx("span",{className:"bg-gradient-to-r from-emerald-300 via-teal-300 to-cyan-300 bg-clip-text text-transparent",children:"Challenge Mode"})}),eu.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:"Ready to test your retention? Take a quick adaptive quiz generated from your uploaded notes to reinforce memory and spot weak areas instantly."})]}),(0,eu.jsxs)("button",{onClick:()=>r(o.QUIZ),className:"mt-7 w-full py-3.5 rounded-xl bg-white text-slate-950 text-sm sm:text-base font-bold hover:bg-emerald-300 hover:text-slate-950 transition-all duration-200 shadow-[0_18px_50px_rgba(148,163,184,0.8)] flex items-center justify-center gap-2 group-hover:scale-[1.02] active:scale-95",children:["Start Quiz",eu.jsx(eU,{className:"w-4 h-4"})]})]})]})]})]})},eB=e_("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),eV=e_("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),e$=e_("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),eJ=e_("book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]),eW=e_("file",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]]),ez=e_("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),eK=e_("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),eY=({materials:e,onAddMaterial:t,onRemoveMaterial:n})=>{let[i,s]=(0,ec.useState)(!1),[o,a]=(0,ec.useState)(""),[l,u]=(0,ec.useState)(""),[c,d]=(0,ec.useState)(!1),[p,h]=(0,ec.useState)(!1),f=(0,ec.useRef)(null),m=()=>{a(""),u(""),s(!1),d(!1),h(!1)},g=async e=>{let t=e.target.files?.[0];if(t){if("application/pdf"!==t.type){alert("Please select a PDF file.");return}d(!0),h(!0);try{let e=await r.e(579).then(r.bind(r,6605));e.GlobalWorkerOptions.workerSrc="/_next/static/pdfjs/pdf.worker.min.mjs";let n=await t.arrayBuffer(),i=await e.getDocument({data:n}).promise,s=Math.min(i.numPages,150),l="";for(let e=1;e<=s;e++){let t=await i.getPage(e),r=(await t.getTextContent()).items.map(e=>e.str).join(" ");l+=`--- Page ${e} ---
${r}

`,e%10==0&&await new Promise(e=>setTimeout(e,0))}i.numPages>s&&(l+=`
... (Content truncated at ${s} pages for performance) ...`),u(l),o||a(t.name.replace(".pdf",""))}catch(e){console.error("Error parsing PDF:",e),alert("Failed to extract text from the PDF. Please try another file or reduce size.")}finally{d(!1),f.current&&(f.current.value="")}}};return(0,eu.jsxs)("div",{className:"relative space-y-10 animate-fadeIn",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[eu.jsx("div",{className:"absolute -top-24 right-[15%] h-64 w-64 rounded-full bg-violet-600/20 blur-3xl"}),eu.jsx("div",{className:"absolute bottom-[-20%] left-[10%] h-72 w-72 rounded-full bg-indigo-500/20 blur-3xl"})]}),(0,eu.jsxs)("div",{className:"flex flex-col justify-between gap-6 border-b border-white/5 pb-6 md:flex-row md:items-end",children:[(0,eu.jsxs)("div",{className:"space-y-2",children:[(0,eu.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-violet-500/30 bg-violet-500/10 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-violet-200",children:[eu.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-violet-300 shadow-[0_0_10px_rgba(196,181,253,0.9)]"}),"Knowledge Base"]}),eu.jsx("h2",{className:"text-4xl font-extrabold tracking-tight text-white",children:eu.jsx("span",{className:"bg-gradient-to-r from-violet-300 via-indigo-300 to-cyan-300 bg-clip-text text-transparent",children:"Library"})}),eu.jsx("p",{className:"text-sm text-slate-400",children:"Upload notes, PDFs, and concepts to train your AI study companion."})]}),(0,eu.jsxs)("button",{onClick:()=>s(!0),className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-violet-600 via-indigo-600 to-cyan-500 px-6 py-3 text-sm font-bold text-white shadow-[0_18px_45px_rgba(79,70,229,0.65)] transition-all duration-300 hover:scale-105 hover:shadow-[0_24px_65px_rgba(56,189,248,0.7)] active:scale-95",children:[eu.jsx(eB,{className:"h-5 w-5"}),eu.jsx("span",{children:"Add Material"})]})]}),i&&(0,eu.jsxs)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[eu.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-xl transition-opacity",onClick:m}),(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[eu.jsx("div",{className:"absolute -top-20 left-0 h-64 w-64 rounded-full bg-violet-500/30 blur-3xl"}),eu.jsx("div",{className:"absolute bottom-[-15%] right-[-5%] h-64 w-64 rounded-full bg-cyan-400/25 blur-3xl"})]}),(0,eu.jsxs)("div",{className:"relative z-10 w-full max-w-2xl overflow-hidden rounded-[2rem] border border-white/15 bg-slate-950/90 shadow-[0_24px_80px_rgba(15,23,42,0.98)] backdrop-blur-2xl animate-fadeIn",children:[eu.jsx("div",{className:"h-1 w-full bg-gradient-to-r from-violet-500 via-indigo-500 to-cyan-400"}),(0,eu.jsxs)("div",{className:"relative p-7 md:p-9",children:[(0,eu.jsxs)("div",{className:"mb-7 flex items-center justify-between",children:[(0,eu.jsxs)("div",{className:"flex items-center gap-3",children:[eu.jsx("div",{className:"rounded-xl border border-violet-500/30 bg-violet-500/10 p-2.5 shadow-[0_12px_35px_rgba(129,140,248,0.4)]",children:eu.jsx(eV,{className:"h-5 w-5 text-violet-300"})}),(0,eu.jsxs)("div",{children:[eu.jsx("h3",{className:"text-xl font-bold text-white md:text-2xl",children:"Upload Material"}),eu.jsx("p",{className:"text-xs text-slate-400",children:"Import a PDF or paste your notes to enrich your study space."})]})]}),eu.jsx("button",{onClick:m,className:"rounded-full bg-slate-900/70 p-2 text-slate-500 transition-all hover:bg-slate-800 hover:text-white",children:eu.jsx(eS,{className:"h-5 w-5"})})]}),(0,eu.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o.trim()&&l.trim()&&(t({id:Date.now().toString(),title:o,content:l,dateAdded:Date.now(),type:p?"file":"text"}),m())},className:"space-y-6",children:[(0,eu.jsxs)("div",{children:[(0,eu.jsxs)("div",{className:"mb-2 ml-1 flex items-center justify-between",children:[eu.jsx("label",{className:"block text-[11px] font-bold uppercase tracking-[0.18em] text-slate-400",children:"Document Title"}),eu.jsx("input",{type:"file",ref:f,onChange:g,accept:"application/pdf",className:"hidden"}),eu.jsx("button",{type:"button",onClick:()=>{f.current?.click()},disabled:c,className:"inline-flex items-center gap-1.5 text-[11px] font-bold uppercase tracking-[0.18em] text-violet-300 transition-colors hover:text-violet-100 disabled:opacity-60",children:c?(0,eu.jsxs)(eu.Fragment,{children:[eu.jsx(eN,{className:"h-3 w-3 animate-spin"}),"Parsing PDF..."]}):(0,eu.jsxs)(eu.Fragment,{children:[eu.jsx(eV,{className:"h-3 w-3"}),"Import PDF"]})})]}),eu.jsx("input",{type:"text",value:o,onChange:e=>a(e.target.value),placeholder:"e.g. Physics Chapter 3: Thermodynamics",className:"w-full rounded-xl border border-white/10 bg-black/40 px-5 py-3.5 text-sm text-white outline-none transition-all placeholder:text-slate-600 focus:bg-black/70 focus:border-violet-500 focus:ring-1 focus:ring-violet-500",autoFocus:!0})]}),(0,eu.jsxs)("div",{children:[eu.jsx("label",{className:"mb-2 ml-1 block text-[11px] font-bold uppercase tracking-[0.18em] text-slate-400",children:"Content / Notes"}),(0,eu.jsxs)("div",{className:"relative",children:[eu.jsx("textarea",{value:l,onChange:e=>u(e.target.value),rows:10,disabled:c,placeholder:c?"Extracting text from PDF, please wait...":"Paste your text content, syllabus, or notes here...",className:`custom-scrollbar w-full resize-none rounded-xl border border-white/10 bg-black/40 px-5 py-3.5 text-sm font-mono leading-relaxed text-slate-300 outline-none transition-all placeholder:text-slate-600 focus:bg-black/70 focus:border-violet-500 focus:ring-1 focus:ring-violet-500 ${c?"opacity-60 animate-pulse":""}`}),c&&eu.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:eu.jsx(eN,{className:"h-8 w-8 animate-spin text-violet-500"})})]})]}),(0,eu.jsxs)("div",{className:"flex items-center justify-end gap-3 border-t border-white/5 pt-4",children:[eu.jsx("button",{type:"button",onClick:m,className:"rounded-xl px-6 py-2.5 text-sm font-semibold text-slate-400 transition-all hover:bg-white/5 hover:text-white",children:"Cancel"}),(0,eu.jsxs)("button",{type:"submit",disabled:!o.trim()||!l.trim()||c,className:"inline-flex items-center gap-2 rounded-xl bg-white px-7 py-2.5 text-sm font-bold text-slate-950 shadow-[0_16px_45px_rgba(148,163,184,0.7)] transition-all hover:bg-violet-50 hover:shadow-[0_20px_55px_rgba(129,140,248,0.8)] disabled:cursor-not-allowed disabled:opacity-60",children:[eu.jsx(e$,{className:"h-4 w-4"}),eu.jsx("span",{children:"Save to Library"})]})]})]})]})]})]}),0===e.length?(0,eu.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-[2.5rem] border-2 border-dashed border-white/8 bg-slate-950/60 py-20 text-center shadow-[0_22px_70px_rgba(15,23,42,0.95)]",children:[eu.jsx("div",{className:"mb-6 inline-flex h-24 w-24 items-center justify-center rounded-full border border-violet-500/40 bg-gradient-to-br from-slate-900 via-slate-950 to-slate-900 shadow-[0_18px_55px_rgba(15,23,42,0.9)]",children:eu.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-slate-900",children:eu.jsx(eJ,{className:"h-9 w-9 text-slate-500"})})}),eu.jsx("h3",{className:"mb-2 text-xl font-bold text-white",children:"Library Empty"}),eu.jsx("p",{className:"mb-7 max-w-sm text-sm leading-relaxed text-slate-400",children:"Upload course notes, syllabi, or articles to power the AI Tutor's personalization engine and build your knowledge base."}),eu.jsx("button",{onClick:()=>s(!0),className:"rounded-full border border-violet-400/40 bg-violet-500/10 px-6 py-2.5 text-sm font-medium text-violet-100 transition-all hover:bg-violet-500/20 hover:text-white hover:shadow-[0_16px_40px_rgba(129,140,248,0.8)]",children:"Add First Material"})]}):eu.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:e.map((e,t)=>(0,eu.jsxs)("div",{className:"group relative flex h-72 flex-col rounded-[2rem] border border-white/8 bg-slate-950/70 p-7 shadow-[0_16px_50px_rgba(15,23,42,0.95)] transition-all duration-300 hover:-translate-y-1 hover:border-violet-500/40 hover:shadow-[0_24px_70px_rgba(79,70,229,0.8)]",style:{animationDelay:`${80*t}ms`},children:[eu.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-[2rem] bg-gradient-to-b from-white/5 via-transparent to-transparent"}),(0,eu.jsxs)("div",{className:"relative z-10 mb-5 flex items-start justify-between",children:[eu.jsx("div",{className:`rounded-2xl border p-3.5 transition-all duration-300 ${"file"===e.type?"border-orange-500/30 bg-orange-500/10 text-orange-300 group-hover:border-orange-400/60 group-hover:bg-orange-500/20":"border-slate-600/50 bg-slate-900 text-slate-300 group-hover:border-violet-500/50 group-hover:bg-violet-900/20 group-hover:text-violet-200"}`,children:"file"===e.type?eu.jsx(eW,{className:"h-6 w-6"}):eu.jsx(ez,{className:"h-6 w-6"})}),eu.jsx("button",{onClick:()=>n(e.id),className:"rounded-xl p-2.5 text-slate-500 opacity-0 transition-all hover:bg-red-500/10 hover:text-red-400 group-hover:opacity-100",children:eu.jsx(eK,{className:"h-4 w-4"})})]}),eu.jsx("h3",{className:"relative z-10 mb-3 line-clamp-1 text-lg font-semibold text-white transition-colors group-hover:text-violet-100",children:e.title}),eu.jsx("div",{className:"relative z-10 flex-1 overflow-hidden",children:eu.jsx("p",{className:"line-clamp-3 text-sm leading-relaxed text-slate-500 transition-colors group-hover:text-slate-300",children:e.content})}),(0,eu.jsxs)("div",{className:"relative z-10 mt-5 flex items-center justify-between border-t border-white/5 pt-3 text-[11px] font-semibold uppercase tracking-[0.16em] text-slate-500",children:[eu.jsx("span",{children:new Date(e.dateAdded).toLocaleDateString()}),eu.jsx("span",{children:"file"===e.type?"PDF Import":"Text Note"})]})]},e.id))})]})},eX=e_("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),eQ=e_("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),eZ=e_("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),e0=e_("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var e1=r(4401),e2=r(7147);let e5=require("fs/promises");var e4=r(4492);let e3=require("node:stream/promises");r(2504),r(3958),r(4036);var e6=r(6342);r(359);var e8=r(1017);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class e9{}function e7(e,t){return e.replace(/\{([^}]+)\}/g,(e,r)=>{if(Object.prototype.hasOwnProperty.call(t,r)){let e=t[r];return null!=e?String(e):""}throw Error(`Key '${r}' not found in valueMap.`)})}function te(e,t,r){for(let n=0;n<t.length-1;n++){let i=t[n];if(i.endsWith("[]")){let s=i.slice(0,-2);if(!(s in e)){if(Array.isArray(r))e[s]=Array.from({length:r.length},()=>({}));else throw Error(`Value must be a list given an array path ${i}`)}if(Array.isArray(e[s])){let i=e[s];if(Array.isArray(r))for(let e=0;e<i.length;e++)te(i[e],t.slice(n+1),r[e]);else for(let e of i)te(e,t.slice(n+1),r)}return}if(i.endsWith("[0]")){let s=i.slice(0,-3);s in e||(e[s]=[{}]),te(e[s][0],t.slice(n+1),r);return}e[i]&&"object"==typeof e[i]||(e[i]={}),e=e[i]}let n=t[t.length-1],i=e[n];if(void 0!==i){if(!r||"object"==typeof r&&0===Object.keys(r).length||r===i)return;if("object"==typeof i&&"object"==typeof r&&null!==i&&null!==r)Object.assign(i,r);else throw Error(`Cannot set value for an existing key. Key: ${n}`)}else"_self"!==n||"object"!=typeof r||null===r||Array.isArray(r)?e[n]=r:Object.assign(e,r)}function tt(e,t,r){try{if(1===t.length&&"_self"===t[0])return e;for(let n=0;n<t.length;n++){if("object"!=typeof e||null===e)return r;let i=t[n];if(i.endsWith("[]")){let s=i.slice(0,-2);if(!(s in e))return r;{let i=e[s];if(!Array.isArray(i))return r;return i.map(e=>tt(e,t.slice(n+1),r))}}e=e[i]}return e}catch(e){if(e instanceof TypeError)return r;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tr(e){if("string"!=typeof e)throw Error("fromImageBytes must be a string");return e}function tn(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["metadata"]);null!=n&&te(t,["metadata"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);null!=s&&te(t,["error"],s);let o=tt(e,["response"]);return null!=o&&te(t,["response"],function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["parent"]);null!=n&&te(t,["parent"],n);let i=tt(e,["documentName"]);return null!=i&&te(t,["documentName"],i),t}(o)),t}(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(a||(a={})),function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"}(l||(l={})),function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"}(u||(u={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"}(c||(c={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(d||(d={})),function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"}(p||(p={})),function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"}(h||(h={})),function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"}(f||(f={})),function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"}(m||(m={})),function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.HIGH="HIGH"}(g||(g={})),function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"}(y||(y={})),function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"}(v||(v={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"}(_||(_={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE"}(b||(b={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(E||(E={})),function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(x||(x={})),function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"}(w||(w={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"}(A||(A={})),function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(T||(T={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"}(S||(S={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(C||(C={})),function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"}(O||(O={})),function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(N||(N={})),function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(I||(I={})),function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"}(k||(k={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(R||(R={})),function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"}(P||(P={})),function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"}(j||(j={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(M||(M={})),function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(U||(U={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"}(D||(D={})),function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(L||(L={})),function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"}(G||(G={})),function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"}(F||(F={})),function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(q||(q={})),function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(H||(H={})),function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(B||(B={})),function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(V||(V={})),function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"}($||($={})),function(e){e.ASSET="ASSET",e.STYLE="STYLE"}(J||(J={})),function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"}(W||(W={})),function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"}(z||(z={})),function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"}(K||(K={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"}(Y||(Y={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"}(X||(X={})),function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"}(Q||(Q={})),function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"}(Z||(Z={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"}(ee||(ee={})),function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(et||(et={})),function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(er||(er={})),function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"}(en||(en={})),function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(ei||(ei={})),function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(es||(es={})),function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"}(eo||(eo={})),function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"}(ea||(ea={}));class ti{constructor(e){let t={};for(let r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ts{get text(){var e,t,r,n,i,s,o,a;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let l="",u=!1,c=[];for(let e of null!==(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(let[t,r]of Object.entries(e))"text"!==t&&"thought"!==t&&"thoughtSignature"!==t&&(null!==r||void 0!==r)&&c.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,l+=e.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?l:void 0}get data(){var e,t,r,n,i,s,o,a;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let l="",u=[];for(let e of null!==(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(let[t,r]of Object.entries(e))"inlineData"!==t&&(null!==r||void 0!==r)&&u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(l+=atob(e.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),l.length>0?btoa(l):void 0}get functionCalls(){var e,t,r,n,i,s,o,a;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let l=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==l?void 0:l.length)!==0)return l}get executableCode(){var e,t,r,n,i,s,o,a,l;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null===(l=null==u?void 0:u[0])||void 0===l?void 0:l.code}get codeExecutionResult(){var e,t,r,n,i,s,o,a,l;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null===(l=null==u?void 0:u[0])||void 0===l?void 0:l.output}}class to{}class ta{}class tl{}class tu{}class tc{}class td{}class tp{}class th{}class tf{}class tm{}class tg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let r=new tg;return Object.assign(r,t?function(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["metadata"]);null!=n&&te(t,["metadata"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);null!=s&&te(t,["error"],s);let o=tt(e,["response"]);return null!=o&&te(t,["response"],function(e){let t={},r=tt(e,["videos"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["_self"]);return null!=r&&te(t,["video"],function(e){let t={},r=tt(e,["gcsUri"]);null!=r&&te(t,["uri"],r);let n=tt(e,["bytesBase64Encoded"]);null!=n&&te(t,["videoBytes"],tr(n));let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(r)),t})(e))),te(t,["generatedVideos"],e)}let n=tt(e,["raiMediaFilteredCount"]);null!=n&&te(t,["raiMediaFilteredCount"],n);let i=tt(e,["raiMediaFilteredReasons"]);return null!=i&&te(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e):function(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["metadata"]);null!=n&&te(t,["metadata"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);null!=s&&te(t,["error"],s);let o=tt(e,["response","generateVideoResponse"]);return null!=o&&te(t,["response"],function(e){let t={},r=tt(e,["generatedSamples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["video"]);return null!=r&&te(t,["video"],function(e){let t={},r=tt(e,["uri"]);null!=r&&te(t,["uri"],r);let n=tt(e,["encodedVideo"]);null!=n&&te(t,["videoBytes"],tr(n));let i=tt(e,["encoding"]);return null!=i&&te(t,["mimeType"],i),t}(r)),t})(e))),te(t,["generatedVideos"],e)}let n=tt(e,["raiMediaFilteredCount"]);null!=n&&te(t,["raiMediaFilteredCount"],n);let i=tt(e,["raiMediaFilteredReasons"]);return null!=i&&te(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e)),r}}class ty{}class tv{}class t_{}class tb{}class tE{}class tx{}class tw{}class tA{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let r=new tA;return Object.assign(r,function(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["metadata"]);null!=n&&te(t,["metadata"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);null!=s&&te(t,["error"],s);let o=tt(e,["response"]);return null!=o&&te(t,["response"],function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["parent"]);null!=n&&te(t,["parent"],n);let i=tt(e,["documentName"]);return null!=i&&te(t,["documentName"],i),t}(o)),t}(e)),r}}class tT{}class tS{}class tC{}class tO{}class tN{get text(){var e,t,r;let n="",i=!1,s=[];for(let o of null!==(r=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==r?r:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&s.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;i=!0,n+=o.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?n:void 0}get data(){var e,t,r;let n="",i=[];for(let s of null!==(r=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==r?r:[]){for(let[e,t]of Object.entries(s))"inlineData"!==e&&null!==t&&i.push(e);s.inlineData&&"string"==typeof s.inlineData.data&&(n+=atob(s.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),n.length>0?btoa(n):void 0}}class tI{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class tk{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let r=new tk;return Object.assign(r,tn(e)),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tR(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;{let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function tP(e,t){let r=tR(e,t);return r?r.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}`:r.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${r}`:r:""}function tj(e){return Array.isArray(e)?e.map(e=>tM(e)):[tM(e)]}function tM(e){if("object"==typeof e&&null!==e)return e;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function tU(e){let t=tM(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function tD(e){let t=tM(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function tL(e){if(null==e)throw Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw Error(`Unsupported part type: ${typeof e}`)}function tG(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>tL(e)):[tL(e)]}function tF(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function tq(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function tH(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function tB(e){if(null==e)throw Error("ContentUnion is required");return tF(e)?e:{role:"user",parts:tG(e)}}function tV(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{let t=tB(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){let e=tB(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>tB(e)):[tB(t)]}function t$(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("contents are required");if(!Array.isArray(e)){if(tq(e)||tH(e))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[tB(e)]}let t=[],r=[],n=tF(e[0]);for(let i of e){let e=tF(i);if(e!=n)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(i);else if(tq(i)||tH(i))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else r.push(i)}return n||t.push({role:"user",parts:tG(r)}),t}function tJ(e){let t={},r=["items"],n=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let s=e.anyOf;for(let[o,a]of(null!=s&&2==s.length&&("null"===s[0].type?(t.nullable=!0,e=s[1]):"null"===s[1].type&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let r=e.filter(e=>"null"!==e);if(1===r.length)t.type=Object.values(c).includes(r[0].toUpperCase())?r[0].toUpperCase():c.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],r))t.anyOf.push({type:Object.values(c).includes(e.toUpperCase())?e.toUpperCase():c.TYPE_UNSPECIFIED})}(e.type,t),Object.entries(e)))if(null!=a){if("type"==o){if("null"===a)throw Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(c).includes(a.toUpperCase())?a.toUpperCase():c.TYPE_UNSPECIFIED}else if(r.includes(o))t[o]=tJ(a);else if(n.includes(o)){let e=[];for(let r of a){if("null"==r.type){t.nullable=!0;continue}e.push(tJ(r))}t[o]=e}else if(i.includes(o)){let e={};for(let[t,r]of Object.entries(a))e[t]=tJ(r);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=a}}return t}function tW(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw Error(`Unsupported speechConfig type: ${typeof e}`)}function tz(e){if("multiSpeakerVoiceConfig"in e)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function tK(e){if(e.functionDeclarations)for(let t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=tJ(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=tJ(t.response));return e}function tY(e){if(null==e)throw Error("tools is required");if(!Array.isArray(e))throw Error("tools is required and must be an array of Tools");let t=[];for(let r of e)t.push(r);return t}function tX(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,r,n=1){let i=!t.startsWith(`${r}/`)&&t.split("/").length===n;if(e.isVertexAI())return t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${r}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}/${t}`:t;return i?`${r}/${t}`:t}(e,t,"cachedContents")}function tQ(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function tZ(e){return null!=e&&"object"==typeof e&&"video"in e}function t0(e){return null!=e&&"object"==typeof e&&"uri"in e}function t1(e){var t;let r;if(null!=e&&"object"==typeof e&&"name"in e&&(r=e.name),!(t0(e)&&void 0===(r=e.uri)||tZ(e)&&void 0===(r=null===(t=e.video)||void 0===t?void 0:t.uri))){if("string"==typeof e&&(r=e),void 0===r)throw Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){let e=r.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw Error(`Could not extract file name from URI ${r}`);r=e[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function t2(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels"}function t5(e){for(let t of["models","tunedModels","publisherModels"]){if(null!==e&&"object"==typeof e&&t in e)return e[t]}return[]}function t4(e,t){let r;if("string"==typeof t){if(e.isVertexAI()){if(t.startsWith("gs://"))r={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))r={format:"bigquery",bigqueryUri:t};else throw Error(`Unsupported string source for Vertex AI: ${t}`)}else if(t.startsWith("files/"))r={fileName:t};else throw Error(`Unsupported string source for Gemini API: ${t}`)}else if(Array.isArray(t)){if(e.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");r={inlinedRequests:t}}else r=t;let n=[r.gcsUri,r.bigqueryUri].filter(Boolean).length,i=[r.inlinedRequests,r.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||1!==n)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||1!==i)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return r}function t3(e){if("object"!=typeof e||null===e)return{};let t=e.inlinedResponses;if("object"!=typeof t||null===t)return e;let r=t.inlinedResponses;if(!Array.isArray(r)||0===r.length)return e;let n=!1;for(let e of r){if("object"!=typeof e||null===e)continue;let t=e.response;if("object"==typeof t&&null!==t&&void 0!==t.embedding){n=!0;break}}return n&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),e}function t6(e,t){if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw Error(`Invalid batch job name: ${t}.`)}function t8(e){if("BATCH_STATE_UNSPECIFIED"===e)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===e)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===e)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===e)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===e)return"JOB_STATE_FAILED";if("BATCH_STATE_CANCELLED"===e)return"JOB_STATE_CANCELLED";if("BATCH_STATE_EXPIRED"===e)return"JOB_STATE_EXPIRED";else return e}function t9(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["metadata","displayName"]);null!=n&&te(t,["displayName"],n);let i=tt(e,["metadata","state"]);null!=i&&te(t,["state"],t8(i));let s=tt(e,["metadata","createTime"]);null!=s&&te(t,["createTime"],s);let o=tt(e,["metadata","endTime"]);null!=o&&te(t,["endTime"],o);let a=tt(e,["metadata","updateTime"]);null!=a&&te(t,["updateTime"],a);let l=tt(e,["metadata","model"]);null!=l&&te(t,["model"],l);let u=tt(e,["metadata","output"]);return null!=u&&te(t,["dest"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){let t={},r=tt(e,["responsesFile"]);null!=r&&te(t,["fileName"],r);let n=tt(e,["inlinedResponses","inlinedResponses"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["response"]);null!=r&&te(t,["response"],function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["content"]);null!=r&&te(t,["content"],r);let n=tt(e,["citationMetadata"]);null!=n&&te(t,["citationMetadata"],function(e){let t={},r=tt(e,["citationSources"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["citations"],e)}return t}(n));let i=tt(e,["tokenCount"]);null!=i&&te(t,["tokenCount"],i);let s=tt(e,["finishReason"]);null!=s&&te(t,["finishReason"],s);let o=tt(e,["avgLogprobs"]);null!=o&&te(t,["avgLogprobs"],o);let a=tt(e,["groundingMetadata"]);null!=a&&te(t,["groundingMetadata"],a);let l=tt(e,["index"]);null!=l&&te(t,["index"],l);let u=tt(e,["logprobsResult"]);null!=u&&te(t,["logprobsResult"],u);let c=tt(e,["safetyRatings"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["safetyRatings"],e)}let d=tt(e,["urlContextMetadata"]);return null!=d&&te(t,["urlContextMetadata"],d),t})(e))),te(t,["candidates"],e)}let i=tt(e,["modelVersion"]);null!=i&&te(t,["modelVersion"],i);let s=tt(e,["promptFeedback"]);null!=s&&te(t,["promptFeedback"],s);let o=tt(e,["responseId"]);null!=o&&te(t,["responseId"],o);let a=tt(e,["usageMetadata"]);return null!=a&&te(t,["usageMetadata"],a),t}(r));let n=tt(e,["error"]);return null!=n&&te(t,["error"],n),t})(e))),te(t,["inlinedResponses"],e)}let i=tt(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["inlinedEmbedContentResponses"],e)}return t}(t3(u))),t}function t7(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["displayName"]);null!=n&&te(t,["displayName"],n);let i=tt(e,["state"]);null!=i&&te(t,["state"],t8(i));let s=tt(e,["error"]);null!=s&&te(t,["error"],s);let o=tt(e,["createTime"]);null!=o&&te(t,["createTime"],o);let a=tt(e,["startTime"]);null!=a&&te(t,["startTime"],a);let l=tt(e,["endTime"]);null!=l&&te(t,["endTime"],l);let u=tt(e,["updateTime"]);null!=u&&te(t,["updateTime"],u);let c=tt(e,["model"]);null!=c&&te(t,["model"],c);let d=tt(e,["inputConfig"]);null!=d&&te(t,["src"],function(e){let t={},r=tt(e,["instancesFormat"]);null!=r&&te(t,["format"],r);let n=tt(e,["gcsSource","uris"]);null!=n&&te(t,["gcsUri"],n);let i=tt(e,["bigquerySource","inputUri"]);return null!=i&&te(t,["bigqueryUri"],i),t}(d));let p=tt(e,["outputConfig"]);null!=p&&te(t,["dest"],function(e){let t={},r=tt(e,["predictionsFormat"]);null!=r&&te(t,["format"],r);let n=tt(e,["gcsDestination","outputUriPrefix"]);null!=n&&te(t,["gcsUri"],n);let i=tt(e,["bigqueryDestination","outputUri"]);return null!=i&&te(t,["bigqueryUri"],i),t}(t3(p)));let h=tt(e,["completionStats"]);return null!=h&&te(t,["completionStats"],h),t}function re(e){let t={},r=tt(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["mediaResolution"]);null!=r&&te(t,["mediaResolution"],r);let n=tt(e,["codeExecutionResult"]);null!=n&&te(t,["codeExecutionResult"],n);let i=tt(e,["executableCode"]);null!=i&&te(t,["executableCode"],i);let s=tt(e,["fileData"]);null!=s&&te(t,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=tt(e,["fileUri"]);null!=r&&te(t,["fileUri"],r);let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(s));let o=tt(e,["functionCall"]);null!=o&&te(t,["functionCall"],function(e){let t={},r=tt(e,["id"]);null!=r&&te(t,["id"],r);let n=tt(e,["args"]);null!=n&&te(t,["args"],n);let i=tt(e,["name"]);if(null!=i&&te(t,["name"],i),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(o));let a=tt(e,["functionResponse"]);null!=a&&te(t,["functionResponse"],a);let l=tt(e,["inlineData"]);null!=l&&te(t,["inlineData"],function(e){let t={},r=tt(e,["data"]);if(null!=r&&te(t,["data"],r),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(l));let u=tt(e,["text"]);null!=u&&te(t,["text"],u);let c=tt(e,["thought"]);null!=c&&te(t,["thought"],c);let d=tt(e,["thoughtSignature"]);null!=d&&te(t,["thoughtSignature"],d);let p=tt(e,["videoMetadata"]);return null!=p&&te(t,["videoMetadata"],p),t})(e))),te(t,["parts"],e)}let n=tt(e,["role"]);return null!=n&&te(t,["role"],n),t}function rt(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["src"]);null!=i&&te(r,["batch","inputConfig"],function(e,t){let r={};if(void 0!==tt(t,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==tt(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==tt(t,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let n=tt(t,["fileName"]);null!=n&&te(r,["fileName"],n);let i=tt(t,["inlinedRequests"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["request","model"],tR(e,n));let i=tt(t,["contents"]);if(null!=i){let e=t$(i);Array.isArray(e)&&(e=e.map(e=>re(e))),te(r,["request","contents"],e)}let s=tt(t,["metadata"]);null!=s&&te(r,["metadata"],s);let o=tt(t,["config"]);return null!=o&&te(r,["request","generationConfig"],function(e,t,r){let n={},i=tt(t,["systemInstruction"]);void 0!==r&&null!=i&&te(r,["systemInstruction"],re(tB(i)));let s=tt(t,["temperature"]);null!=s&&te(n,["temperature"],s);let o=tt(t,["topP"]);null!=o&&te(n,["topP"],o);let a=tt(t,["topK"]);null!=a&&te(n,["topK"],a);let l=tt(t,["candidateCount"]);null!=l&&te(n,["candidateCount"],l);let u=tt(t,["maxOutputTokens"]);null!=u&&te(n,["maxOutputTokens"],u);let c=tt(t,["stopSequences"]);null!=c&&te(n,["stopSequences"],c);let d=tt(t,["responseLogprobs"]);null!=d&&te(n,["responseLogprobs"],d);let p=tt(t,["logprobs"]);null!=p&&te(n,["logprobs"],p);let h=tt(t,["presencePenalty"]);null!=h&&te(n,["presencePenalty"],h);let f=tt(t,["frequencyPenalty"]);null!=f&&te(n,["frequencyPenalty"],f);let m=tt(t,["seed"]);null!=m&&te(n,["seed"],m);let g=tt(t,["responseMimeType"]);null!=g&&te(n,["responseMimeType"],g);let y=tt(t,["responseSchema"]);null!=y&&te(n,["responseSchema"],tJ(y));let v=tt(t,["responseJsonSchema"]);if(null!=v&&te(n,["responseJsonSchema"],v),void 0!==tt(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==tt(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let _=tt(t,["safetySettings"]);if(void 0!==r&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["category"]);if(null!=r&&te(t,["category"],r),void 0!==tt(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let n=tt(e,["threshold"]);return null!=n&&te(t,["threshold"],n),t})(e))),te(r,["safetySettings"],e)}let b=tt(t,["tools"]);if(void 0!==r&&null!=b){let e=tY(b);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=tt(e,["googleSearchRetrieval"]);null!=n&&te(t,["googleSearchRetrieval"],n);let i=tt(e,["computerUse"]);null!=i&&te(t,["computerUse"],i);let s=tt(e,["fileSearch"]);null!=s&&te(t,["fileSearch"],s);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=tt(e,["enableWidget"]);return null!=r&&te(t,["enableWidget"],r),t}(a));let l=tt(e,["googleSearch"]);null!=l&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let r=tt(e,["timeRangeFilter"]);return null!=r&&te(t,["timeRangeFilter"],r),t}(l));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(tK(e)))),te(r,["tools"],e)}let E=tt(t,["toolConfig"]);if(void 0!==r&&null!=E&&te(r,["toolConfig"],function(e){let t={},r=tt(e,["functionCallingConfig"]);null!=r&&te(t,["functionCallingConfig"],function(e){let t={},r=tt(e,["mode"]);null!=r&&te(t,["mode"],r);let n=tt(e,["allowedFunctionNames"]);if(null!=n&&te(t,["allowedFunctionNames"],n),void 0!==tt(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(r));let n=tt(e,["retrievalConfig"]);return null!=n&&te(t,["retrievalConfig"],n),t}(E)),void 0!==tt(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let x=tt(t,["cachedContent"]);void 0!==r&&null!=x&&te(r,["cachedContent"],tX(e,x));let w=tt(t,["responseModalities"]);null!=w&&te(n,["responseModalities"],w);let A=tt(t,["mediaResolution"]);null!=A&&te(n,["mediaResolution"],A);let T=tt(t,["speechConfig"]);if(null!=T&&te(n,["speechConfig"],tW(T)),void 0!==tt(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let S=tt(t,["thinkingConfig"]);null!=S&&te(n,["thinkingConfig"],S);let C=tt(t,["imageConfig"]);null!=C&&te(n,["imageConfig"],function(e){let t={},r=tt(e,["aspectRatio"]);null!=r&&te(t,["aspectRatio"],r);let n=tt(e,["imageSize"]);if(null!=n&&te(t,["imageSize"],n),void 0!==tt(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==tt(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(C));let O=tt(t,["enableEnhancedCivicAnswers"]);return null!=O&&te(n,["enableEnhancedCivicAnswers"],O),n}(e,o,tt(r,["request"],{}))),r})(e,t))),te(r,["requests","requests"],t)}return r}(e,t4(e,i)));let s=tt(t,["config"]);return null!=s&&function(e,t){let r=tt(e,["displayName"]);if(void 0!==t&&null!=r&&te(t,["batch","displayName"],r),void 0!==tt(e,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(s,r),r}!function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"}(el||(el={}));class rr{constructor(e,t,r,n){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,n)}init(e,t,r){var n,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let s={config:{}};(s=r&&0!==Object.keys(r).length?"object"==typeof r?Object.assign({},r):r:{config:{}}).config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=null!==(i=null===(n=s.config)||void 0===n?void 0:n.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rn extends e9{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new rr(el.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)}}createInlinedGenerateContentRequest(e){let t=rt(this.apiClient,e),r=e7("{model}:batchGenerateContent",t._url),n=t.batch.inputConfig.requests,i=n.requests,s=[];for(let e of i){let t=Object.assign({},e);if(t.systemInstruction){let e=t.systemInstruction;delete t.systemInstruction;let r=t.request;r.systemInstruction=e,t.request=r}s.push(t)}return n.requests=s,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){let r=t?Object.assign({},t):{},n=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${n}`),void 0===r.dest){let t=this.getGcsUri(e),i=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?r.dest=`${t.slice(0,-6)}/dest`:r.dest=`${t}_dest_${n}`;else if(i)r.dest=`${i}_dest_${n}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["model"],tR(e,n));let i=tt(t,["src"]);null!=i&&te(r,["inputConfig"],function(e){let t={},r=tt(e,["format"]);null!=r&&te(t,["instancesFormat"],r);let n=tt(e,["gcsUri"]);null!=n&&te(t,["gcsSource","uris"],n);let i=tt(e,["bigqueryUri"]);if(null!=i&&te(t,["bigquerySource","inputUri"],i),void 0!==tt(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==tt(e,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(t4(e,i)));let s=tt(t,["config"]);return null!=s&&function(e,t){let r=tt(e,["displayName"]);void 0!==t&&null!=r&&te(t,["displayName"],r);let n=tt(e,["dest"]);void 0!==t&&null!=n&&te(t,["outputConfig"],function(e){let t={},r=tt(e,["format"]);null!=r&&te(t,["predictionsFormat"],r);let n=tt(e,["gcsUri"]);null!=n&&te(t,["gcsDestination","outputUriPrefix"],n);let i=tt(e,["bigqueryUri"]);if(null!=i&&te(t,["bigqueryDestination","outputUri"],i),void 0!==tt(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==tt(e,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==tt(e,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw Error(`Unsupported destination: ${e}`)}(n)))}(s,r),r}(this.apiClient,e);return s=e7("batchPredictionJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>t7(e))}{let t=rt(this.apiClient,e);return s=e7("{model}:batchGenerateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>t9(e))}}async createEmbeddingsInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["src"]);null!=i&&te(r,["batch","inputConfig"],function(e,t){let r={},n=tt(t,["fileName"]);null!=n&&te(r,["file_name"],n);let i=tt(t,["inlinedRequests"]);return null!=i&&te(r,["requests"],function(e,t){let r={},n=tt(t,["contents"]);if(null!=n){let t=tV(e,n);Array.isArray(t)&&(t=t.map(e=>e)),te(r,["requests[]","request","content"],t)}let i=tt(t,["config"]);return null!=i&&(te(r,["_self"],function(e,t){let r=tt(e,["taskType"]);void 0!==t&&null!=r&&te(t,["requests[]","taskType"],r);let n=tt(e,["title"]);void 0!==t&&null!=n&&te(t,["requests[]","title"],n);let i=tt(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&te(t,["requests[]","outputDimensionality"],i),void 0!==tt(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==tt(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(i,r)),function(e,t){for(let[r,n]of Object.entries(t)){let t=r.split("."),i=n.split("."),s=new Set,o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break}if(-1!==o&&i.length>o)for(let e=o;e<i.length;e++){let t=i[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||s.add(t)}(function e(t,r,n,i,s){if(i>=r.length||"object"!=typeof t||null===t)return;let o=r[i];if(o.endsWith("[]")){let a=o.slice(0,-2);if(a in t&&Array.isArray(t[a]))for(let o of t[a])e(o,r,n,i+1,s)}else if("*"===o){if("object"==typeof t&&null!==t&&!Array.isArray(t)){let e=Object.keys(t).filter(e=>!e.startsWith("_")&&!s.has(e)),r={};for(let n of e)r[n]=t[n];for(let[e,s]of Object.entries(r)){let r=[];for(let t of n.slice(i))"*"===t?r.push(e):r.push(t);te(t,r,s)}for(let r of e)delete t[r]}}else o in t&&e(t[o],r,n,i+1,s)})(e,t,i,0,s)}}(r,{"requests[].*":"requests[].request.*"})),r}(e,i)),r}(e,i));let s=tt(t,["config"]);return null!=s&&function(e,t){let r=tt(e,["displayName"]);void 0!==t&&null!=r&&te(t,["batch","displayName"],r)}(s,r),r}(this.apiClient,e);return n=e7("{model}:asyncBatchEmbedContent",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>t9(e))}}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],t6(e,n)),r}(this.apiClient,e);return s=e7("batchPredictionJobs/{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>t7(e))}{let t=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],t6(e,n)),r}(this.apiClient,e);return s=e7("batches/{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>t9(e))}}async cancel(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],t6(e,n)),r}(this.apiClient,e);s=e7("batchPredictionJobs/{name}:cancel",n._url),o=n._query,delete n._url,delete n._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal})}else{let t=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],t6(e,n)),r}(this.apiClient,e);s=e7("batches/{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=tt(e,["config"]);return null!=r&&function(e,t){let r=tt(e,["pageSize"]);void 0!==t&&null!=r&&te(t,["_query","pageSize"],r);let n=tt(e,["pageToken"]);void 0!==t&&null!=n&&te(t,["_query","pageToken"],n);let i=tt(e,["filter"]);void 0!==t&&null!=i&&te(t,["_query","filter"],i)}(r,t),t}(e);return s=e7("batchPredictionJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["batchPredictionJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>t7(e))),te(t,["batchJobs"],e)}return t}(e),r=new tO;return Object.assign(r,t),r})}{let t=function(e){let t={},r=tt(e,["config"]);return null!=r&&function(e,t){let r=tt(e,["pageSize"]);void 0!==t&&null!=r&&te(t,["_query","pageSize"],r);let n=tt(e,["pageToken"]);if(void 0!==t&&null!=n&&te(t,["_query","pageToken"],n),void 0!==tt(e,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(r,t),t}(e);return s=e7("batches",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["operations"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>t9(e))),te(t,["batchJobs"],e)}return t}(e),r=new tO;return Object.assign(r,t),r})}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],t6(e,n)),r}(this.apiClient,e);return s=e7("batchPredictionJobs/{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["name"]);null!=n&&te(t,["name"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);return null!=s&&te(t,["error"],s),t})(e))}{let t=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],t6(e,n)),r}(this.apiClient,e);return s=e7("batches/{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["name"]);null!=n&&te(t,["name"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);return null!=s&&te(t,["error"],s),t})(e))}}}function ri(e){let t={},r=tt(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["mediaResolution"]);null!=r&&te(t,["mediaResolution"],r);let n=tt(e,["codeExecutionResult"]);null!=n&&te(t,["codeExecutionResult"],n);let i=tt(e,["executableCode"]);null!=i&&te(t,["executableCode"],i);let s=tt(e,["fileData"]);null!=s&&te(t,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=tt(e,["fileUri"]);null!=r&&te(t,["fileUri"],r);let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(s));let o=tt(e,["functionCall"]);null!=o&&te(t,["functionCall"],function(e){let t={},r=tt(e,["id"]);null!=r&&te(t,["id"],r);let n=tt(e,["args"]);null!=n&&te(t,["args"],n);let i=tt(e,["name"]);if(null!=i&&te(t,["name"],i),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(o));let a=tt(e,["functionResponse"]);null!=a&&te(t,["functionResponse"],a);let l=tt(e,["inlineData"]);null!=l&&te(t,["inlineData"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){let t={},r=tt(e,["data"]);if(null!=r&&te(t,["data"],r),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(l));let u=tt(e,["text"]);null!=u&&te(t,["text"],u);let c=tt(e,["thought"]);null!=c&&te(t,["thought"],c);let d=tt(e,["thoughtSignature"]);null!=d&&te(t,["thoughtSignature"],d);let p=tt(e,["videoMetadata"]);return null!=p&&te(t,["videoMetadata"],p),t})(e))),te(t,["parts"],e)}let n=tt(e,["role"]);return null!=n&&te(t,["role"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rs extends e9{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new rr(el.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["model"],tP(e,n));let i=tt(t,["config"]);return null!=i&&function(e,t){let r=tt(e,["ttl"]);void 0!==t&&null!=r&&te(t,["ttl"],r);let n=tt(e,["expireTime"]);void 0!==t&&null!=n&&te(t,["expireTime"],n);let i=tt(e,["displayName"]);void 0!==t&&null!=i&&te(t,["displayName"],i);let s=tt(e,["contents"]);if(void 0!==t&&null!=s){let e=t$(s);Array.isArray(e)&&(e=e.map(e=>e)),te(t,["contents"],e)}let o=tt(e,["systemInstruction"]);void 0!==t&&null!=o&&te(t,["systemInstruction"],tB(o));let a=tt(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tt(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=tt(e,["description"]);null!=r&&te(t,["description"],r);let n=tt(e,["name"]);null!=n&&te(t,["name"],n);let i=tt(e,["parameters"]);null!=i&&te(t,["parameters"],i);let s=tt(e,["parametersJsonSchema"]);null!=s&&te(t,["parametersJsonSchema"],s);let o=tt(e,["response"]);null!=o&&te(t,["response"],o);let a=tt(e,["responseJsonSchema"]);return null!=a&&te(t,["responseJsonSchema"],a),t})(e))),te(t,["functionDeclarations"],e)}let n=tt(e,["retrieval"]);null!=n&&te(t,["retrieval"],n);let i=tt(e,["googleSearchRetrieval"]);null!=i&&te(t,["googleSearchRetrieval"],i);let s=tt(e,["computerUse"]);if(null!=s&&te(t,["computerUse"],s),void 0!==tt(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tt(e,["codeExecution"]);null!=o&&te(t,["codeExecution"],o);let a=tt(e,["enterpriseWebSearch"]);null!=a&&te(t,["enterpriseWebSearch"],a);let l=tt(e,["googleMaps"]);null!=l&&te(t,["googleMaps"],l);let u=tt(e,["googleSearch"]);null!=u&&te(t,["googleSearch"],u);let c=tt(e,["urlContext"]);return null!=c&&te(t,["urlContext"],c),t})(e))),te(t,["tools"],e)}let l=tt(e,["toolConfig"]);void 0!==t&&null!=l&&te(t,["toolConfig"],l);let u=tt(e,["kmsKeyName"]);void 0!==t&&null!=u&&te(t,["encryption_spec","kmsKeyName"],u)}(i,r),r}(this.apiClient,e);return s=e7("cachedContents",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}{let t=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["model"],tP(e,n));let i=tt(t,["config"]);return null!=i&&function(e,t){let r=tt(e,["ttl"]);void 0!==t&&null!=r&&te(t,["ttl"],r);let n=tt(e,["expireTime"]);void 0!==t&&null!=n&&te(t,["expireTime"],n);let i=tt(e,["displayName"]);void 0!==t&&null!=i&&te(t,["displayName"],i);let s=tt(e,["contents"]);if(void 0!==t&&null!=s){let e=t$(s);Array.isArray(e)&&(e=e.map(e=>ri(e))),te(t,["contents"],e)}let o=tt(e,["systemInstruction"]);void 0!==t&&null!=o&&te(t,["systemInstruction"],ri(tB(o)));let a=tt(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=tt(e,["googleSearchRetrieval"]);null!=n&&te(t,["googleSearchRetrieval"],n);let i=tt(e,["computerUse"]);null!=i&&te(t,["computerUse"],i);let s=tt(e,["fileSearch"]);null!=s&&te(t,["fileSearch"],s);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=tt(e,["enableWidget"]);return null!=r&&te(t,["enableWidget"],r),t}(a));let l=tt(e,["googleSearch"]);null!=l&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let r=tt(e,["timeRangeFilter"]);return null!=r&&te(t,["timeRangeFilter"],r),t}(l));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(e))),te(t,["tools"],e)}let l=tt(e,["toolConfig"]);if(void 0!==t&&null!=l&&te(t,["toolConfig"],function(e){let t={},r=tt(e,["functionCallingConfig"]);null!=r&&te(t,["functionCallingConfig"],function(e){let t={},r=tt(e,["mode"]);null!=r&&te(t,["mode"],r);let n=tt(e,["allowedFunctionNames"]);if(null!=n&&te(t,["allowedFunctionNames"],n),void 0!==tt(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(r));let n=tt(e,["retrievalConfig"]);return null!=n&&te(t,["retrievalConfig"],n),t}(l)),void 0!==tt(e,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(i,r),r}(this.apiClient,e);return s=e7("cachedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],tX(e,n)),r}(this.apiClient,e);return s=e7("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}{let t=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],tX(e,n)),r}(this.apiClient,e);return s=e7("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],tX(e,n)),r}(this.apiClient,e);return s=e7("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);return null!=r&&te(t,["sdkHttpResponse"],r),t}(e),r=new t_;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=tt(t,["name"]);return null!=n&&te(r,["_url","name"],tX(e,n)),r}(this.apiClient,e);return s=e7("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);return null!=r&&te(t,["sdkHttpResponse"],r),t}(e),r=new t_;return Object.assign(r,t),r})}}async update(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["name"]);null!=n&&te(r,["_url","name"],tX(e,n));let i=tt(t,["config"]);return null!=i&&function(e,t){let r=tt(e,["ttl"]);void 0!==t&&null!=r&&te(t,["ttl"],r);let n=tt(e,["expireTime"]);void 0!==t&&null!=n&&te(t,["expireTime"],n)}(i,r),r}(this.apiClient,e);return s=e7("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}{let t=function(e,t){let r={},n=tt(t,["name"]);null!=n&&te(r,["_url","name"],tX(e,n));let i=tt(t,["config"]);return null!=i&&function(e,t){let r=tt(e,["ttl"]);void 0!==t&&null!=r&&te(t,["ttl"],r);let n=tt(e,["expireTime"]);void 0!==t&&null!=n&&te(t,["expireTime"],n)}(i,r),r}(this.apiClient,e);return s=e7("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>e)}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=tt(e,["config"]);return null!=r&&function(e,t){let r=tt(e,["pageSize"]);void 0!==t&&null!=r&&te(t,["_query","pageSize"],r);let n=tt(e,["pageToken"]);void 0!==t&&null!=n&&te(t,["_query","pageToken"],n)}(r,t),t}(e);return s=e7("cachedContents",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["cachedContents"],e)}return t}(e),r=new tb;return Object.assign(r,t),r})}{let t=function(e){let t={},r=tt(e,["config"]);return null!=r&&function(e,t){let r=tt(e,["pageSize"]);void 0!==t&&null!=r&&te(t,["_query","pageSize"],r);let n=tt(e,["pageToken"]);void 0!==t&&null!=n&&te(t,["_query","pageToken"],n)}(r,t),t}(e);return s=e7("cachedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["cachedContents"],e)}return t}(e),r=new tb;return Object.assign(r,t),r})}}}function ro(e){return this instanceof ro?(this.v=e,this):new ro(e)}function ra(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),n[Symbol.asyncIterator]=function(){return this},n;function o(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||a(e,t)})},t&&(n[e]=t(n[e])))}function a(e,t){try{var r;(r=i[e](t)).value instanceof ro?Promise.resolve(r.value.v).then(l,u):c(s[0][2],r)}catch(e){c(s[0][3],e)}}function l(e){a("next",e)}function u(e){a("throw",e)}function c(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function rl(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,i,(t=e[r](t)).done,t.value)})}}}function ru(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function rc(e){if(void 0===e||0===e.length)return[];let t=[],r=e.length,n=0;for(;n<r;)if("user"===e[n].role)t.push(e[n]),n++;else{let i=[],s=!0;for(;n<r&&"model"===e[n].role;)i.push(e[n]),s&&!ru(e[n])&&(s=!1),n++;s?t.push(...i):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class rd{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new rp(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class rp{constructor(e,t,r,n={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=n,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`)}}(i)}async sendMessage(e){var t;await this.sendPromise;let r=tB(e.message),n=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,i;let s=await n,o=null===(t=null===(e=s.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,a=s.automaticFunctionCallingHistory,l=this.getHistory(!0).length,u=[];null!=a&&(u=null!==(i=a.slice(l))&&void 0!==i?i:[]),this.recordHistory(r,o?[o]:[],u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),n}async sendMessageStream(e){var t;await this.sendPromise;let r=tB(e.message),n=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=n.then(()=>void 0).catch(()=>void 0);let i=await n;return this.processStreamResponse(i,r)}getHistory(e=!1){return structuredClone(e?rc(this.history):this.history)}processStreamResponse(e,t){return ra(this,arguments,function*(){let r=[];try{for(var n,i,s,o,a,l,u,c=!0,d=rl(e);!(n=(u=yield ro(d.next())).done);c=!0){if(o=u.value,c=!1,/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let r=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==r&&ru(r)}(o)){let e=null===(l=null===(a=o.candidates)||void 0===a?void 0:a[0])||void 0===l?void 0:l.content;void 0!==e&&r.push(e)}yield yield ro(o)}}catch(e){i={error:e}}finally{try{!c&&!n&&(s=d.return)&&(yield ro(s.call(d)))}finally{if(i)throw i.error}}this.recordHistory(t,r)})}recordHistory(e,t,r){let n=[];t.length>0&&t.every(e=>void 0!==e.role)?n=t:n.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...rc(r)):this.history.push(e),this.history.push(...n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,rh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rf extends e9{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new rr(el.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["config"]);return null!=r&&function(e,t){let r=tt(e,["pageSize"]);void 0!==t&&null!=r&&te(t,["_query","pageSize"],r);let n=tt(e,["pageToken"]);void 0!==t&&null!=n&&te(t,["_query","pageToken"],n)}(r,t),t}(e);return n=e7("files",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["files"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["files"],e)}return t}(e),r=new tT;return Object.assign(r,t),r})}}async createInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){let t={},r=tt(e,["file"]);return null!=r&&te(t,["file"],r),t}(e);return n=e7("upload/v1beta/files",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);return null!=r&&te(t,["sdkHttpResponse"],r),t}(e),r=new tS;return Object.assign(r,t),r})}}async get(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["name"]);return null!=r&&te(t,["_url","file"],t1(r)),t}(e);return n=e7("files/{file}",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["name"]);return null!=r&&te(t,["_url","file"],t1(r)),t}(e);return n=e7("files/{file}",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);return null!=r&&te(t,["sdkHttpResponse"],r),t}(e),r=new tC;return Object.assign(r,t),r})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rm(e){let t={},r=tt(e,["data"]);if(null!=r&&te(t,["data"],r),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}function rg(e){let t={},r=tt(e,["voiceConfig"]);null!=r&&te(t,["voiceConfig"],r);let n=tt(e,["languageCode"]);if(null!=n&&te(t,["languageCode"],n),void 0!==tt(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function ry(e){let t={},r=tt(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["mediaResolution"]);null!=r&&te(t,["mediaResolution"],r);let n=tt(e,["codeExecutionResult"]);null!=n&&te(t,["codeExecutionResult"],n);let i=tt(e,["executableCode"]);null!=i&&te(t,["executableCode"],i);let s=tt(e,["fileData"]);null!=s&&te(t,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=tt(e,["fileUri"]);null!=r&&te(t,["fileUri"],r);let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(s));let o=tt(e,["functionCall"]);null!=o&&te(t,["functionCall"],function(e){let t={},r=tt(e,["id"]);null!=r&&te(t,["id"],r);let n=tt(e,["args"]);null!=n&&te(t,["args"],n);let i=tt(e,["name"]);if(null!=i&&te(t,["name"],i),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(o));let a=tt(e,["functionResponse"]);null!=a&&te(t,["functionResponse"],a);let l=tt(e,["inlineData"]);null!=l&&te(t,["inlineData"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){let t={},r=tt(e,["data"]);if(null!=r&&te(t,["data"],r),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(l));let u=tt(e,["text"]);null!=u&&te(t,["text"],u);let c=tt(e,["thought"]);null!=c&&te(t,["thought"],c);let d=tt(e,["thoughtSignature"]);null!=d&&te(t,["thoughtSignature"],d);let p=tt(e,["videoMetadata"]);return null!=p&&te(t,["videoMetadata"],p),t})(e))),te(t,["parts"],e)}let n=tt(e,["role"]);return null!=n&&te(t,["role"],n),t}function rv(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["contents"]);if(null!=i){let e=t$(i);Array.isArray(e)&&(e=e.map(e=>ry(e))),te(r,["contents"],e)}let s=tt(t,["config"]);return null!=s&&te(r,["generationConfig"],function(e,t,r){let n={},i=tt(t,["systemInstruction"]);void 0!==r&&null!=i&&te(r,["systemInstruction"],ry(tB(i)));let s=tt(t,["temperature"]);null!=s&&te(n,["temperature"],s);let o=tt(t,["topP"]);null!=o&&te(n,["topP"],o);let a=tt(t,["topK"]);null!=a&&te(n,["topK"],a);let l=tt(t,["candidateCount"]);null!=l&&te(n,["candidateCount"],l);let u=tt(t,["maxOutputTokens"]);null!=u&&te(n,["maxOutputTokens"],u);let c=tt(t,["stopSequences"]);null!=c&&te(n,["stopSequences"],c);let d=tt(t,["responseLogprobs"]);null!=d&&te(n,["responseLogprobs"],d);let p=tt(t,["logprobs"]);null!=p&&te(n,["logprobs"],p);let h=tt(t,["presencePenalty"]);null!=h&&te(n,["presencePenalty"],h);let f=tt(t,["frequencyPenalty"]);null!=f&&te(n,["frequencyPenalty"],f);let m=tt(t,["seed"]);null!=m&&te(n,["seed"],m);let g=tt(t,["responseMimeType"]);null!=g&&te(n,["responseMimeType"],g);let y=tt(t,["responseSchema"]);null!=y&&te(n,["responseSchema"],tJ(y));let v=tt(t,["responseJsonSchema"]);if(null!=v&&te(n,["responseJsonSchema"],v),void 0!==tt(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==tt(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let _=tt(t,["safetySettings"]);if(void 0!==r&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["category"]);if(null!=r&&te(t,["category"],r),void 0!==tt(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let n=tt(e,["threshold"]);return null!=n&&te(t,["threshold"],n),t})(e))),te(r,["safetySettings"],e)}let b=tt(t,["tools"]);if(void 0!==r&&null!=b){let e=tY(b);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=tt(e,["googleSearchRetrieval"]);null!=n&&te(t,["googleSearchRetrieval"],n);let i=tt(e,["computerUse"]);null!=i&&te(t,["computerUse"],i);let s=tt(e,["fileSearch"]);null!=s&&te(t,["fileSearch"],s);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=tt(e,["enableWidget"]);return null!=r&&te(t,["enableWidget"],r),t}(a));let l=tt(e,["googleSearch"]);null!=l&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let r=tt(e,["timeRangeFilter"]);return null!=r&&te(t,["timeRangeFilter"],r),t}(l));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(tK(e)))),te(r,["tools"],e)}let E=tt(t,["toolConfig"]);if(void 0!==r&&null!=E&&te(r,["toolConfig"],function(e){let t={},r=tt(e,["functionCallingConfig"]);null!=r&&te(t,["functionCallingConfig"],function(e){let t={},r=tt(e,["mode"]);null!=r&&te(t,["mode"],r);let n=tt(e,["allowedFunctionNames"]);if(null!=n&&te(t,["allowedFunctionNames"],n),void 0!==tt(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(r));let n=tt(e,["retrievalConfig"]);return null!=n&&te(t,["retrievalConfig"],n),t}(E)),void 0!==tt(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let x=tt(t,["cachedContent"]);void 0!==r&&null!=x&&te(r,["cachedContent"],tX(e,x));let w=tt(t,["responseModalities"]);null!=w&&te(n,["responseModalities"],w);let A=tt(t,["mediaResolution"]);null!=A&&te(n,["mediaResolution"],A);let T=tt(t,["speechConfig"]);if(null!=T&&te(n,["speechConfig"],tW(T)),void 0!==tt(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let S=tt(t,["thinkingConfig"]);null!=S&&te(n,["thinkingConfig"],S);let C=tt(t,["imageConfig"]);null!=C&&te(n,["imageConfig"],function(e){let t={},r=tt(e,["aspectRatio"]);null!=r&&te(t,["aspectRatio"],r);let n=tt(e,["imageSize"]);if(null!=n&&te(t,["imageSize"],n),void 0!==tt(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==tt(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(C));let O=tt(t,["enableEnhancedCivicAnswers"]);return null!=O&&te(n,["enableEnhancedCivicAnswers"],O),n}(e,s,r)),r}function r_(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["contents"]);if(null!=i){let e=t$(i);Array.isArray(e)&&(e=e.map(e=>e)),te(r,["contents"],e)}let s=tt(t,["config"]);return null!=s&&te(r,["generationConfig"],function(e,t,r){let n={},i=tt(t,["systemInstruction"]);void 0!==r&&null!=i&&te(r,["systemInstruction"],tB(i));let s=tt(t,["temperature"]);null!=s&&te(n,["temperature"],s);let o=tt(t,["topP"]);null!=o&&te(n,["topP"],o);let a=tt(t,["topK"]);null!=a&&te(n,["topK"],a);let l=tt(t,["candidateCount"]);null!=l&&te(n,["candidateCount"],l);let u=tt(t,["maxOutputTokens"]);null!=u&&te(n,["maxOutputTokens"],u);let c=tt(t,["stopSequences"]);null!=c&&te(n,["stopSequences"],c);let d=tt(t,["responseLogprobs"]);null!=d&&te(n,["responseLogprobs"],d);let p=tt(t,["logprobs"]);null!=p&&te(n,["logprobs"],p);let h=tt(t,["presencePenalty"]);null!=h&&te(n,["presencePenalty"],h);let f=tt(t,["frequencyPenalty"]);null!=f&&te(n,["frequencyPenalty"],f);let m=tt(t,["seed"]);null!=m&&te(n,["seed"],m);let g=tt(t,["responseMimeType"]);null!=g&&te(n,["responseMimeType"],g);let y=tt(t,["responseSchema"]);null!=y&&te(n,["responseSchema"],tJ(y));let v=tt(t,["responseJsonSchema"]);null!=v&&te(n,["responseJsonSchema"],v);let _=tt(t,["routingConfig"]);null!=_&&te(n,["routingConfig"],_);let b=tt(t,["modelSelectionConfig"]);null!=b&&te(n,["modelConfig"],b);let E=tt(t,["safetySettings"]);if(void 0!==r&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>e)),te(r,["safetySettings"],e)}let x=tt(t,["tools"]);if(void 0!==r&&null!=x){let e=tY(x);Array.isArray(e)&&(e=e.map(e=>rk(tK(e)))),te(r,["tools"],e)}let w=tt(t,["toolConfig"]);void 0!==r&&null!=w&&te(r,["toolConfig"],w);let A=tt(t,["labels"]);void 0!==r&&null!=A&&te(r,["labels"],A);let T=tt(t,["cachedContent"]);void 0!==r&&null!=T&&te(r,["cachedContent"],tX(e,T));let S=tt(t,["responseModalities"]);null!=S&&te(n,["responseModalities"],S);let C=tt(t,["mediaResolution"]);null!=C&&te(n,["mediaResolution"],C);let O=tt(t,["speechConfig"]);null!=O&&te(n,["speechConfig"],rI(tW(O)));let N=tt(t,["audioTimestamp"]);null!=N&&te(n,["audioTimestamp"],N);let I=tt(t,["thinkingConfig"]);null!=I&&te(n,["thinkingConfig"],I);let k=tt(t,["imageConfig"]);if(null!=k&&te(n,["imageConfig"],function(e){let t={},r=tt(e,["aspectRatio"]);null!=r&&te(t,["aspectRatio"],r);let n=tt(e,["imageSize"]);null!=n&&te(t,["imageSize"],n);let i=tt(e,["outputMimeType"]);null!=i&&te(t,["imageOutputOptions","mimeType"],i);let s=tt(e,["outputCompressionQuality"]);return null!=s&&te(t,["imageOutputOptions","compressionQuality"],s),t}(k)),void 0!==tt(t,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}(e,s,r)),r}function rb(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["content"]);null!=r&&te(t,["content"],r);let n=tt(e,["citationMetadata"]);null!=n&&te(t,["citationMetadata"],function(e){let t={},r=tt(e,["citationSources"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["citations"],e)}return t}(n));let i=tt(e,["tokenCount"]);null!=i&&te(t,["tokenCount"],i);let s=tt(e,["finishReason"]);null!=s&&te(t,["finishReason"],s);let o=tt(e,["avgLogprobs"]);null!=o&&te(t,["avgLogprobs"],o);let a=tt(e,["groundingMetadata"]);null!=a&&te(t,["groundingMetadata"],a);let l=tt(e,["index"]);null!=l&&te(t,["index"],l);let u=tt(e,["logprobsResult"]);null!=u&&te(t,["logprobsResult"],u);let c=tt(e,["safetyRatings"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["safetyRatings"],e)}let d=tt(e,["urlContextMetadata"]);return null!=d&&te(t,["urlContextMetadata"],d),t})(e))),te(t,["candidates"],e)}let i=tt(e,["modelVersion"]);null!=i&&te(t,["modelVersion"],i);let s=tt(e,["promptFeedback"]);null!=s&&te(t,["promptFeedback"],s);let o=tt(e,["responseId"]);null!=o&&te(t,["responseId"],o);let a=tt(e,["usageMetadata"]);return null!=a&&te(t,["usageMetadata"],a),t}function rE(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["candidates"],e)}let i=tt(e,["createTime"]);null!=i&&te(t,["createTime"],i);let s=tt(e,["modelVersion"]);null!=s&&te(t,["modelVersion"],s);let o=tt(e,["promptFeedback"]);null!=o&&te(t,["promptFeedback"],o);let a=tt(e,["responseId"]);null!=a&&te(t,["responseId"],a);let l=tt(e,["usageMetadata"]);return null!=l&&te(t,["usageMetadata"],l),t}function rx(e){let t={},r=tt(e,["_self"]);null!=r&&te(t,["image"],rw(r));let n=tt(e,["raiFilteredReason"]);null!=n&&te(t,["raiFilteredReason"],n);let i=tt(e,["_self"]);null!=i&&te(t,["safetyAttributes"],rN(i));let s=tt(e,["prompt"]);return null!=s&&te(t,["enhancedPrompt"],s),t}function rw(e){let t={},r=tt(e,["gcsUri"]);null!=r&&te(t,["gcsUri"],r);let n=tt(e,["bytesBase64Encoded"]);null!=n&&te(t,["imageBytes"],tr(n));let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}function rA(e){let t={};if(void 0!==tt(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let r=tt(e,["imageBytes"]);null!=r&&te(t,["bytesBase64Encoded"],tr(r));let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}function rT(e){let t={},r=tt(e,["gcsUri"]);null!=r&&te(t,["gcsUri"],r);let n=tt(e,["imageBytes"]);null!=n&&te(t,["bytesBase64Encoded"],tr(n));let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}function rS(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["displayName"]);null!=n&&te(t,["displayName"],n);let i=tt(e,["description"]);null!=i&&te(t,["description"],i);let s=tt(e,["version"]);null!=s&&te(t,["version"],s);let o=tt(e,["_self"]);null!=o&&te(t,["tunedModelInfo"],function(e){let t={},r=tt(e,["baseModel"]);null!=r&&te(t,["baseModel"],r);let n=tt(e,["createTime"]);null!=n&&te(t,["createTime"],n);let i=tt(e,["updateTime"]);return null!=i&&te(t,["updateTime"],i),t}(o));let a=tt(e,["inputTokenLimit"]);null!=a&&te(t,["inputTokenLimit"],a);let l=tt(e,["outputTokenLimit"]);null!=l&&te(t,["outputTokenLimit"],l);let u=tt(e,["supportedGenerationMethods"]);null!=u&&te(t,["supportedActions"],u);let c=tt(e,["temperature"]);null!=c&&te(t,["temperature"],c);let d=tt(e,["maxTemperature"]);null!=d&&te(t,["maxTemperature"],d);let p=tt(e,["topP"]);null!=p&&te(t,["topP"],p);let h=tt(e,["topK"]);null!=h&&te(t,["topK"],h);let f=tt(e,["thinking"]);return null!=f&&te(t,["thinking"],f),t}function rC(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["displayName"]);null!=n&&te(t,["displayName"],n);let i=tt(e,["description"]);null!=i&&te(t,["description"],i);let s=tt(e,["versionId"]);null!=s&&te(t,["version"],s);let o=tt(e,["deployedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["endpoint"]);null!=r&&te(t,["name"],r);let n=tt(e,["deployedModelId"]);return null!=n&&te(t,["deployedModelId"],n),t})(e))),te(t,["endpoints"],e)}let a=tt(e,["labels"]);null!=a&&te(t,["labels"],a);let l=tt(e,["_self"]);null!=l&&te(t,["tunedModelInfo"],function(e){let t={},r=tt(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=r&&te(t,["baseModel"],r);let n=tt(e,["createTime"]);null!=n&&te(t,["createTime"],n);let i=tt(e,["updateTime"]);return null!=i&&te(t,["updateTime"],i),t}(l));let u=tt(e,["defaultCheckpointId"]);null!=u&&te(t,["defaultCheckpointId"],u);let c=tt(e,["checkpoints"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["checkpoints"],e)}return t}function rO(e){let t={},r=tt(e,["safetyAttributes","categories"]);null!=r&&te(t,["categories"],r);let n=tt(e,["safetyAttributes","scores"]);null!=n&&te(t,["scores"],n);let i=tt(e,["contentType"]);return null!=i&&te(t,["contentType"],i),t}function rN(e){let t={},r=tt(e,["safetyAttributes","categories"]);null!=r&&te(t,["categories"],r);let n=tt(e,["safetyAttributes","scores"]);null!=n&&te(t,["scores"],n);let i=tt(e,["contentType"]);return null!=i&&te(t,["contentType"],i),t}function rI(e){let t={},r=tt(e,["voiceConfig"]);null!=r&&te(t,["voiceConfig"],r);let n=tt(e,["languageCode"]);if(null!=n&&te(t,["languageCode"],n),void 0!==tt(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function rk(e){let t={},r=tt(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tt(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=tt(e,["description"]);null!=r&&te(t,["description"],r);let n=tt(e,["name"]);null!=n&&te(t,["name"],n);let i=tt(e,["parameters"]);null!=i&&te(t,["parameters"],i);let s=tt(e,["parametersJsonSchema"]);null!=s&&te(t,["parametersJsonSchema"],s);let o=tt(e,["response"]);null!=o&&te(t,["response"],o);let a=tt(e,["responseJsonSchema"]);return null!=a&&te(t,["responseJsonSchema"],a),t})(e))),te(t,["functionDeclarations"],e)}let n=tt(e,["retrieval"]);null!=n&&te(t,["retrieval"],n);let i=tt(e,["googleSearchRetrieval"]);null!=i&&te(t,["googleSearchRetrieval"],i);let s=tt(e,["computerUse"]);if(null!=s&&te(t,["computerUse"],s),void 0!==tt(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tt(e,["codeExecution"]);null!=o&&te(t,["codeExecution"],o);let a=tt(e,["enterpriseWebSearch"]);null!=a&&te(t,["enterpriseWebSearch"],a);let l=tt(e,["googleMaps"]);null!=l&&te(t,["googleMaps"],l);let u=tt(e,["googleSearch"]);null!=u&&te(t,["googleSearch"],u);let c=tt(e,["urlContext"]);return null!=c&&te(t,["urlContext"],c),t}function rR(e){let t={},r=tt(e,["uri"]);null!=r&&te(t,["uri"],r);let n=tt(e,["videoBytes"]);null!=n&&te(t,["encodedVideo"],tr(n));let i=tt(e,["mimeType"]);return null!=i&&te(t,["encoding"],i),t}function rP(e){let t={},r=tt(e,["uri"]);null!=r&&te(t,["gcsUri"],r);let n=tt(e,["videoBytes"]);null!=n&&te(t,["bytesBase64Encoded"],tr(n));let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}function rj(e,t){let r=tt(e,["mimeType"]);void 0!==t&&null!=r&&te(t,["mimeType"],r);let n=tt(e,["displayName"]);void 0!==t&&null!=n&&te(t,["displayName"],n);let i=tt(e,["customMetadata"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["customMetadata"],e)}let s=tt(e,["chunkingConfig"]);return void 0!==t&&null!=s&&te(t,["chunkingConfig"],s),{}}let rM="x-goog-api-client";class rU{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});let n={};this.clientOptions.vertexai?(n.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",n.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(n.apiVersion=null!==(r=this.clientOptions.apiVersion)&&void 0!==r?r:"v1beta",n.baseUrl="https://generativelanguage.googleapis.com/"),n.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=n,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(n,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=new URL(this.getBaseUrl());return e.protocol="http:"==e.protocol?"ws":"wss",e.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t,r){let n=[this.getRequestUrlInternal(t)];return r&&n.push(this.getBaseResourcePath()),""!==e&&n.push(e),new URL(`${n.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let r=this.shouldPrependVertexProjectPath(e),n=this.constructUrl(e.path,t,r);if(e.queryParams)for(let[t,r]of Object.entries(e.queryParams))n.searchParams.append(t,String(r));let i={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,n.toString(),e.abortSignal),this.unaryApiCall(n,i,e.httpMethod)}patchHttpOptions(e,t){let r=JSON.parse(JSON.stringify(e));for(let[e,n]of Object.entries(t))"object"==typeof n?r[e]=Object.assign(Object.assign({},r[e]),n):void 0!==n&&(r[e]=n);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let r=this.shouldPrependVertexProjectPath(e),n=this.constructUrl(e.path,t,r);n.searchParams.has("alt")&&"sse"===n.searchParams.get("alt")||n.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,n.toString(),e.abortSignal),this.streamApiCall(n,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r,n){if(t&&t.timeout||n){let r=new AbortController,i=r.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){let e=setTimeout(()=>r.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}n&&n.addEventListener("abort",()=>{r.abort()}),e.signal=i}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let r={};if("string"==typeof e.body&&e.body.length>0)try{let t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t)){console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}r=t}catch(e){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}let n=function e(t,r){let n=Object.assign({},t);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)){let i=r[t],s=n[t];i&&"object"==typeof i&&!Array.isArray(i)&&s&&"object"==typeof s&&!Array.isArray(s)?n[t]=e(s,i):(s&&i&&typeof s!=typeof i&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${t}". Original type: ${typeof s}, New type: ${typeof i}. Overwriting.`),n[t]=i)}return n}(r,t);e.body=JSON.stringify(n)}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,r),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async e=>(await rD(e),new ti(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async e=>(await rD(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){return ra(this,arguments,function*(){var t;let r=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),n=new TextDecoder("utf-8");if(!r)throw Error("Response body is empty");try{let t="",i="data:",s=["\n\n","\r\r","\r\n\r\n"];for(;;){let{done:o,value:a}=yield ro(r.read());if(o){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let l=n.decode(a,{stream:!0});try{let e=JSON.parse(l);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),r=t.status,n=t.code,i=`got status: ${r}. ${JSON.stringify(e)}`;if(n>=400&&n<600)throw new rh({message:i,status:n})}}catch(e){if("ApiError"===e.name)throw e}t+=l;let u=-1,c=0;for(;;){for(let e of(u=-1,c=0,s)){let r=t.indexOf(e);-1!==r&&(-1===u||r<u)&&(u=r,c=e.length)}if(-1===u)break;let r=t.substring(0,u);t=t.substring(u+c);let n=r.trim();if(n.startsWith(i)){let t=n.substring(i.length).trim();try{let r=new Response(t,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield ro(new ti(r))}catch(e){throw Error(`exception parsing stream chunk ${t}. ${e}`)}}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`)})}getDefaultHeaders(){let e={},t="google-genai-sdk/1.32.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[rM]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){let r=new Headers;if(e&&e.headers){for(let[t,n]of Object.entries(e.headers))r.append(t,n);e.timeout&&e.timeout>0&&r.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,t),r}getFileName(e){var t;let r="";return"string"==typeof e&&(r=null!==(t=(r=e.replace(/[/\\]+$/,"")).split(/[/\\]/).pop())&&void 0!==t?t:""),r}async uploadFile(e,t){var r;let n={};null!=t&&(n.mimeType=t.mimeType,n.name=t.name,n.displayName=t.displayName),n.name&&!n.name.startsWith("files/")&&(n.name=`files/${n.name}`);let i=this.clientOptions.uploader,s=await i.stat(e);n.sizeBytes=String(s.size);let o=null!==(r=null==t?void 0:t.mimeType)&&void 0!==r?r:s.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");n.mimeType=o;let a={file:n},l=this.getFileName(e),u=e7("upload/v1beta/files",a._url),c=await this.fetchUploadUrl(u,n.sizeBytes,n.mimeType,l,a,null==t?void 0:t.httpOptions);return i.upload(e,c,this)}async uploadFileToFileSearchStore(e,t,r){var n;let i=this.clientOptions.uploader,s=await i.stat(t),o=String(s.size),a=null!==(n=null==r?void 0:r.mimeType)&&void 0!==n?n:s.type;if(void 0===a||""===a)throw Error("Can not determine mimeType. Please provide mimeType in the config.");let l=`upload/v1beta/${e}:uploadToFileSearchStore`,u=this.getFileName(t),c={};null!=r&&rj(r,c);let d=await this.fetchUploadUrl(l,o,a,u,c,null==r?void 0:r.httpOptions);return i.uploadToFileSearchStore(t,d,this)}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,r,n,i,s){var o;let a={};a=s||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${r}`},n?{"X-Goog-Upload-File-Name":n}:{})};let l=await this.request({path:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:a});if(!l||!(null==l?void 0:l.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let u=null===(o=null==l?void 0:l.headers)||void 0===o?void 0:o["x-goog-upload-url"];if(void 0===u)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function rD(e){var t;if(void 0===e)throw Error("response is undefined");if(!e.ok){let r=e.status,n=JSON.stringify((null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}});if(r>=400&&r<600)throw new rh({message:n,status:r});throw Error(n)}}function rL(e){for(let t of e){if(null!==t&&"object"==typeof t&&t instanceof rF||"object"==typeof t&&"inputSchema"in t)return!0}return!1}function rG(e){var t;let r=null!==(t=e[rM])&&void 0!==t?t:"";e[rM]=(r+" mcp_used/unknown").trimStart()}class rF{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new rF(e,t)}async initialize(){var e,t,r,n;if(this.mcpTools.length>0)return;let i={},s=[];for(let u of this.mcpClients)try{for(var o,a=!0,l=(t=void 0,rl(function(e){return ra(this,arguments,function*(e,t=100){let r;let n=0;for(;n<t;){let t=yield ro(e.listTools({cursor:r}));for(let e of t.tools)yield yield ro(e),n++;if(!t.nextCursor)break;r=t.nextCursor}})}(u)));!(e=(o=await l.next()).done);a=!0){n=o.value,a=!1,s.push(n);let e=n.name;if(i[e])throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);i[e]=u}}catch(e){t={error:e}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(t)throw t.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(e,t={}){let r=[],n=new Set;for(let i of e){let e=i.name;if(n.has(e))throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);n.add(e);let s=function(e,t={}){let r={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return e.outputSchema&&(r.responseJsonSchema=e.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}(i,t);s.functionDeclarations&&r.push(...s.functionDeclarations)}return{functionDeclarations:r}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let r of e)if(r.name in this.functionNameToMcpClient){let e;let n=this.functionNameToMcpClient[r.name];this.config.timeout&&(e={timeout:this.config.timeout});let i=await n.callTool({name:r.name,arguments:r.args},void 0,e);t.push({functionResponse:{name:r.name,response:i.isError?{error:i}:i}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function rq(e,t,r){let n;let i=new tI;r.data instanceof Blob?n=JSON.parse(await r.data.text()):n=JSON.parse(r.data),Object.assign(i,n),t(i)}class rH{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let n=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=function(e){let t=new Headers;for(let[r,n]of Object.entries(e))t.append(r,n);return t}(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),a=`${n}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${o}`,l=()=>{},u=new Promise(e=>{l=e}),c=e.callbacks,d=this.apiClient,p={onopen:function(){l({})},onmessage:e=>{rq(d,c.onmessage,e)},onerror:null!==(t=null==c?void 0:c.onerror)&&void 0!==t?t:function(e){},onclose:null!==(r=null==c?void 0:c.onclose)&&void 0!==r?r:function(e){}},h=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,r)=>{t[r]=e}),t}(s),p);h.connect(),await u;let f=tR(this.apiClient,e.model);return h.send(JSON.stringify({setup:{model:f}})),new rB(h,this.apiClient)}}class rB{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=function(e){let t={},r=tt(e,["weightedPrompts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=function(e){let t={},r=tt(e,["musicGenerationConfig"]);return null!=r&&te(t,["musicGenerationConfig"],r),t}(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){this.conn.send(JSON.stringify({playbackControl:e}))}play(){this.sendPlaybackControl(ea.PLAY)}pause(){this.sendPlaybackControl(ea.PAUSE)}stop(){this.sendPlaybackControl(ea.STOP)}resetContext(){this.sendPlaybackControl(ea.RESET_CONTEXT)}close(){this.conn.close()}}async function rV(e,t,r){let n;let i=new tN;r.data instanceof Blob?n=await r.data.text():n=r.data instanceof ArrayBuffer?new TextDecoder().decode(r.data):r.data;let s=JSON.parse(n);e.isVertexAI()?Object.assign(i,function(e){let t={},r=tt(e,["setupComplete"]);null!=r&&te(t,["setupComplete"],r);let n=tt(e,["serverContent"]);null!=n&&te(t,["serverContent"],n);let i=tt(e,["toolCall"]);null!=i&&te(t,["toolCall"],i);let s=tt(e,["toolCallCancellation"]);null!=s&&te(t,["toolCallCancellation"],s);let o=tt(e,["usageMetadata"]);null!=o&&te(t,["usageMetadata"],function(e){let t={},r=tt(e,["promptTokenCount"]);null!=r&&te(t,["promptTokenCount"],r);let n=tt(e,["cachedContentTokenCount"]);null!=n&&te(t,["cachedContentTokenCount"],n);let i=tt(e,["candidatesTokenCount"]);null!=i&&te(t,["responseTokenCount"],i);let s=tt(e,["toolUsePromptTokenCount"]);null!=s&&te(t,["toolUsePromptTokenCount"],s);let o=tt(e,["thoughtsTokenCount"]);null!=o&&te(t,["thoughtsTokenCount"],o);let a=tt(e,["totalTokenCount"]);null!=a&&te(t,["totalTokenCount"],a);let l=tt(e,["promptTokensDetails"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["promptTokensDetails"],e)}let u=tt(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["cacheTokensDetails"],e)}let c=tt(e,["candidatesTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["responseTokensDetails"],e)}let d=tt(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["toolUsePromptTokensDetails"],e)}let p=tt(e,["trafficType"]);return null!=p&&te(t,["trafficType"],p),t}(o));let a=tt(e,["goAway"]);null!=a&&te(t,["goAway"],a);let l=tt(e,["sessionResumptionUpdate"]);return null!=l&&te(t,["sessionResumptionUpdate"],l),t}(s)):Object.assign(i,s),t(i)}class r${constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new rH(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,n,i,s,o;let a;if(e.config&&e.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion(),c=this.apiClient.getHeaders();e.config&&e.config.tools&&rL(e.config.tools)&&rG(c);let d=function(e){let t=new Headers;for(let[r,n]of Object.entries(e))t.append(r,n);return t}(c);if(this.apiClient.isVertexAI())a=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d,a);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",r="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==u&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",r="access_token"),a=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${t}?${r}=${e}`}let p=()=>{},h=new Promise(e=>{p=e}),f=e.callbacks,m=this.apiClient,g={onopen:function(){var e;null===(e=null==f?void 0:f.onopen)||void 0===e||e.call(f),p({})},onmessage:e=>{rV(m,f.onmessage,e)},onerror:null!==(t=null==f?void 0:f.onerror)&&void 0!==t?t:function(e){},onclose:null!==(r=null==f?void 0:f.onclose)&&void 0!==r?r:function(e){}},y=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,r)=>{t[r]=e}),t}(d),g);y.connect(),await h;let v=tR(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();v=`projects/${e}/locations/${t}/`+v}let _={};this.apiClient.isVertexAI()&&(null===(n=e.config)||void 0===n?void 0:n.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[S.AUDIO]}:e.config.responseModalities=[S.AUDIO]),(null===(i=e.config)||void 0===i?void 0:i.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let b=null!==(o=null===(s=e.config)||void 0===s?void 0:s.tools)&&void 0!==o?o:[],E=[];for(let e of b)this.isCallableTool(e)?E.push(await e.tool()):E.push(e);E.length>0&&(e.config.tools=E);let x={model:v,config:e.config,callbacks:e.callbacks};return _=this.apiClient.isVertexAI()?function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["setup","model"],tR(e,n));let i=tt(t,["config"]);return null!=i&&te(r,["config"],function(e,t){let r=tt(e,["generationConfig"]);void 0!==t&&null!=r&&te(t,["setup","generationConfig"],function(e){let t={},r=tt(e,["modelSelectionConfig"]);null!=r&&te(t,["modelConfig"],r);let n=tt(e,["responseJsonSchema"]);null!=n&&te(t,["responseJsonSchema"],n);let i=tt(e,["audioTimestamp"]);null!=i&&te(t,["audioTimestamp"],i);let s=tt(e,["candidateCount"]);null!=s&&te(t,["candidateCount"],s);let o=tt(e,["enableAffectiveDialog"]);null!=o&&te(t,["enableAffectiveDialog"],o);let a=tt(e,["frequencyPenalty"]);null!=a&&te(t,["frequencyPenalty"],a);let l=tt(e,["logprobs"]);null!=l&&te(t,["logprobs"],l);let u=tt(e,["maxOutputTokens"]);null!=u&&te(t,["maxOutputTokens"],u);let c=tt(e,["mediaResolution"]);null!=c&&te(t,["mediaResolution"],c);let d=tt(e,["presencePenalty"]);null!=d&&te(t,["presencePenalty"],d);let p=tt(e,["responseLogprobs"]);null!=p&&te(t,["responseLogprobs"],p);let h=tt(e,["responseMimeType"]);null!=h&&te(t,["responseMimeType"],h);let f=tt(e,["responseModalities"]);null!=f&&te(t,["responseModalities"],f);let m=tt(e,["responseSchema"]);null!=m&&te(t,["responseSchema"],m);let g=tt(e,["routingConfig"]);null!=g&&te(t,["routingConfig"],g);let y=tt(e,["seed"]);null!=y&&te(t,["seed"],y);let v=tt(e,["speechConfig"]);null!=v&&te(t,["speechConfig"],rg(v));let _=tt(e,["stopSequences"]);null!=_&&te(t,["stopSequences"],_);let b=tt(e,["temperature"]);null!=b&&te(t,["temperature"],b);let E=tt(e,["thinkingConfig"]);null!=E&&te(t,["thinkingConfig"],E);let x=tt(e,["topK"]);null!=x&&te(t,["topK"],x);let w=tt(e,["topP"]);if(null!=w&&te(t,["topP"],w),void 0!==tt(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(r));let n=tt(e,["responseModalities"]);void 0!==t&&null!=n&&te(t,["setup","generationConfig","responseModalities"],n);let i=tt(e,["temperature"]);void 0!==t&&null!=i&&te(t,["setup","generationConfig","temperature"],i);let s=tt(e,["topP"]);void 0!==t&&null!=s&&te(t,["setup","generationConfig","topP"],s);let o=tt(e,["topK"]);void 0!==t&&null!=o&&te(t,["setup","generationConfig","topK"],o);let a=tt(e,["maxOutputTokens"]);void 0!==t&&null!=a&&te(t,["setup","generationConfig","maxOutputTokens"],a);let l=tt(e,["mediaResolution"]);void 0!==t&&null!=l&&te(t,["setup","generationConfig","mediaResolution"],l);let u=tt(e,["seed"]);void 0!==t&&null!=u&&te(t,["setup","generationConfig","seed"],u);let c=tt(e,["speechConfig"]);void 0!==t&&null!=c&&te(t,["setup","generationConfig","speechConfig"],rg(tz(c)));let d=tt(e,["thinkingConfig"]);void 0!==t&&null!=d&&te(t,["setup","generationConfig","thinkingConfig"],d);let p=tt(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&te(t,["setup","generationConfig","enableAffectiveDialog"],p);let h=tt(e,["systemInstruction"]);void 0!==t&&null!=h&&te(t,["setup","systemInstruction"],tB(h));let f=tt(e,["tools"]);if(void 0!==t&&null!=f){let e=tY(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tt(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=tt(e,["description"]);null!=r&&te(t,["description"],r);let n=tt(e,["name"]);null!=n&&te(t,["name"],n);let i=tt(e,["parameters"]);null!=i&&te(t,["parameters"],i);let s=tt(e,["parametersJsonSchema"]);null!=s&&te(t,["parametersJsonSchema"],s);let o=tt(e,["response"]);null!=o&&te(t,["response"],o);let a=tt(e,["responseJsonSchema"]);return null!=a&&te(t,["responseJsonSchema"],a),t})(e))),te(t,["functionDeclarations"],e)}let n=tt(e,["retrieval"]);null!=n&&te(t,["retrieval"],n);let i=tt(e,["googleSearchRetrieval"]);null!=i&&te(t,["googleSearchRetrieval"],i);let s=tt(e,["computerUse"]);if(null!=s&&te(t,["computerUse"],s),void 0!==tt(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tt(e,["codeExecution"]);null!=o&&te(t,["codeExecution"],o);let a=tt(e,["enterpriseWebSearch"]);null!=a&&te(t,["enterpriseWebSearch"],a);let l=tt(e,["googleMaps"]);null!=l&&te(t,["googleMaps"],l);let u=tt(e,["googleSearch"]);null!=u&&te(t,["googleSearch"],u);let c=tt(e,["urlContext"]);return null!=c&&te(t,["urlContext"],c),t})(tK(e)))),te(t,["setup","tools"],e)}let m=tt(e,["sessionResumption"]);void 0!==t&&null!=m&&te(t,["setup","sessionResumption"],m);let g=tt(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&te(t,["setup","inputAudioTranscription"],g);let y=tt(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&te(t,["setup","outputAudioTranscription"],y);let v=tt(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&te(t,["setup","realtimeInputConfig"],v);let _=tt(e,["contextWindowCompression"]);void 0!==t&&null!=_&&te(t,["setup","contextWindowCompression"],_);let b=tt(e,["proactivity"]);return void 0!==t&&null!=b&&te(t,["setup","proactivity"],b),{}}(i,r)),r}(this.apiClient,x):function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["setup","model"],tR(e,n));let i=tt(t,["config"]);return null!=i&&te(r,["config"],function(e,t){let r=tt(e,["generationConfig"]);void 0!==t&&null!=r&&te(t,["setup","generationConfig"],r);let n=tt(e,["responseModalities"]);void 0!==t&&null!=n&&te(t,["setup","generationConfig","responseModalities"],n);let i=tt(e,["temperature"]);void 0!==t&&null!=i&&te(t,["setup","generationConfig","temperature"],i);let s=tt(e,["topP"]);void 0!==t&&null!=s&&te(t,["setup","generationConfig","topP"],s);let o=tt(e,["topK"]);void 0!==t&&null!=o&&te(t,["setup","generationConfig","topK"],o);let a=tt(e,["maxOutputTokens"]);void 0!==t&&null!=a&&te(t,["setup","generationConfig","maxOutputTokens"],a);let l=tt(e,["mediaResolution"]);void 0!==t&&null!=l&&te(t,["setup","generationConfig","mediaResolution"],l);let u=tt(e,["seed"]);void 0!==t&&null!=u&&te(t,["setup","generationConfig","seed"],u);let c=tt(e,["speechConfig"]);void 0!==t&&null!=c&&te(t,["setup","generationConfig","speechConfig"],tz(c));let d=tt(e,["thinkingConfig"]);void 0!==t&&null!=d&&te(t,["setup","generationConfig","thinkingConfig"],d);let p=tt(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&te(t,["setup","generationConfig","enableAffectiveDialog"],p);let h=tt(e,["systemInstruction"]);void 0!==t&&null!=h&&te(t,["setup","systemInstruction"],function(e){let t={},r=tt(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["mediaResolution"]);null!=r&&te(t,["mediaResolution"],r);let n=tt(e,["codeExecutionResult"]);null!=n&&te(t,["codeExecutionResult"],n);let i=tt(e,["executableCode"]);null!=i&&te(t,["executableCode"],i);let s=tt(e,["fileData"]);null!=s&&te(t,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=tt(e,["fileUri"]);null!=r&&te(t,["fileUri"],r);let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(s));let o=tt(e,["functionCall"]);null!=o&&te(t,["functionCall"],function(e){let t={},r=tt(e,["id"]);null!=r&&te(t,["id"],r);let n=tt(e,["args"]);null!=n&&te(t,["args"],n);let i=tt(e,["name"]);if(null!=i&&te(t,["name"],i),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(o));let a=tt(e,["functionResponse"]);null!=a&&te(t,["functionResponse"],a);let l=tt(e,["inlineData"]);null!=l&&te(t,["inlineData"],rm(l));let u=tt(e,["text"]);null!=u&&te(t,["text"],u);let c=tt(e,["thought"]);null!=c&&te(t,["thought"],c);let d=tt(e,["thoughtSignature"]);null!=d&&te(t,["thoughtSignature"],d);let p=tt(e,["videoMetadata"]);return null!=p&&te(t,["videoMetadata"],p),t})(e))),te(t,["parts"],e)}let n=tt(e,["role"]);return null!=n&&te(t,["role"],n),t}(tB(h)));let f=tt(e,["tools"]);if(void 0!==t&&null!=f){let e=tY(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=tt(e,["googleSearchRetrieval"]);null!=n&&te(t,["googleSearchRetrieval"],n);let i=tt(e,["computerUse"]);null!=i&&te(t,["computerUse"],i);let s=tt(e,["fileSearch"]);null!=s&&te(t,["fileSearch"],s);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=tt(e,["enableWidget"]);return null!=r&&te(t,["enableWidget"],r),t}(a));let l=tt(e,["googleSearch"]);null!=l&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let r=tt(e,["timeRangeFilter"]);return null!=r&&te(t,["timeRangeFilter"],r),t}(l));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(tK(e)))),te(t,["setup","tools"],e)}let m=tt(e,["sessionResumption"]);void 0!==t&&null!=m&&te(t,["setup","sessionResumption"],function(e){let t={},r=tt(e,["handle"]);if(null!=r&&te(t,["handle"],r),void 0!==tt(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(m));let g=tt(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&te(t,["setup","inputAudioTranscription"],g);let y=tt(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&te(t,["setup","outputAudioTranscription"],y);let v=tt(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&te(t,["setup","realtimeInputConfig"],v);let _=tt(e,["contextWindowCompression"]);void 0!==t&&null!=_&&te(t,["setup","contextWindowCompression"],_);let b=tt(e,["proactivity"]);return void 0!==t&&null!=b&&te(t,["setup","proactivity"],b),{}}(i,r)),r}(this.apiClient,x),delete _.config,y.send(JSON.stringify(_)),new rW(y,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}let rJ={turnComplete:!0};class rW{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let r=[];try{r=t$(t.turns),e.isVertexAI()||(r=r.map(e=>ry(e)))}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(null==t.functionResponses||0===(r=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of r){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},rJ),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e){let t={},r=tt(e,["media"]);if(null!=r){let e=tj(r);Array.isArray(e)&&(e=e.map(e=>e)),te(t,["mediaChunks"],e)}let n=tt(e,["audio"]);null!=n&&te(t,["audio"],tD(n));let i=tt(e,["audioStreamEnd"]);null!=i&&te(t,["audioStreamEnd"],i);let s=tt(e,["video"]);null!=s&&te(t,["video"],tU(s));let o=tt(e,["text"]);null!=o&&te(t,["text"],o);let a=tt(e,["activityStart"]);null!=a&&te(t,["activityStart"],a);let l=tt(e,["activityEnd"]);return null!=l&&te(t,["activityEnd"],l),t}(e)}:{realtimeInput:function(e){let t={},r=tt(e,["media"]);if(null!=r){let e=tj(r);Array.isArray(e)&&(e=e.map(e=>rm(e))),te(t,["mediaChunks"],e)}let n=tt(e,["audio"]);null!=n&&te(t,["audio"],rm(tD(n)));let i=tt(e,["audioStreamEnd"]);null!=i&&te(t,["audioStreamEnd"],i);let s=tt(e,["video"]);null!=s&&te(t,["video"],rm(tU(s)));let o=tt(e,["text"]);null!=o&&te(t,["text"],o);let a=tt(e,["activityStart"]);null!=a&&te(t,["activityStart"],a);let l=tt(e,["activityEnd"]);return null!=l&&te(t,["activityEnd"],l),t}(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function rz(e){var t,r,n;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let i=!1;for(let t of null!==(r=null==e?void 0:e.tools)&&void 0!==r?r:[])if(rK(t)){i=!0;break}if(!i)return!0;let s=null===(n=null==e?void 0:e.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls;return(!!s&&(s<0||!Number.isInteger(s))||0==s)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0)}function rK(e){return"callTool"in e&&"function"==typeof e.callTool}function rY(e){var t;let r=[];return(null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.tools)&&e.config.tools.forEach((e,t)=>{!rK(e)&&e.functionDeclarations&&e.functionDeclarations.length>0&&r.push(t)}),r}function rX(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rQ extends e9{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,r,n,i,s;let o,a;let l=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,r,n;return null!==(n=null===(r=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===r?void 0:r.some(e=>rK(e)))&&void 0!==n&&n}(e)||rz(e.config))return await this.generateContentInternal(l);let u=rY(e);if(u.length>0){let e=u.map(e=>`tools[${e}]`).join(", ");throw Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${e}.`)}let c=t$(l.contents),d=null!==(n=null===(r=null===(t=l.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===r?void 0:r.maximumRemoteCalls)&&void 0!==n?n:10,p=0;for(;p<d&&(o=await this.generateContentInternal(l)).functionCalls&&0!==o.functionCalls.length;){let t=o.candidates[0].content,r=[];for(let t of null!==(s=null===(i=e.config)||void 0===i?void 0:i.tools)&&void 0!==s?s:[])if(rK(t)){let e=await t.callTool(o.functionCalls);r.push(...e)}p++,a={role:"user",parts:r},l.contents=t$(l.contents),l.contents.push(t),l.contents.push(a),rX(l.config)&&(c.push(t),c.push(a))}return rX(l.config)&&(o.automaticFunctionCallingHistory=c),o},this.generateContentStream=async e=>{var t,r,n,i,s;if(this.maybeMoveToResponseJsonSchem(e),rz(e.config)){let t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}let o=rY(e);if(o.length>0){let e=o.map(e=>`tools[${e}]`).join(", ");throw Error(`Incompatible tools found at ${e}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let a=null===(n=null===(r=null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.toolConfig)||void 0===r?void 0:r.functionCallingConfig)||void 0===n?void 0:n.streamFunctionCallArguments,l=null===(s=null===(i=null==e?void 0:e.config)||void 0===i?void 0:i.automaticFunctionCalling)||void 0===s?void 0:s.disable;if(a&&!l)throw Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let r;let n=[];if(null==e?void 0:e.generatedImages)for(let i of e.generatedImages)i&&(null==i?void 0:i.safetyAttributes)&&(null===(t=null==i?void 0:i.safetyAttributes)||void 0===t?void 0:t.contentType)==="Positive Prompt"?r=null==i?void 0:i.safetyAttributes:n.push(i);return r?{generatedImages:n,positivePromptSafetyAttributes:r,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:n,sdkHttpResponse:e.sdkHttpResponse}}),this.list=async e=>{var t;let r={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!r.config.queryBase){if(null===(t=r.config)||void 0===t?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");r.config.filter="labels.tune-type:*"}return new rr(el.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(r),r)},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let r={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(r)},this.generateVideos=async e=>{var t,r,n,i,s,o;if((e.prompt||e.image||e.video)&&e.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null===(t=e.video)||void 0===t?void 0:t.uri)&&(null===(r=e.video)||void 0===r?void 0:r.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null===(i=null===(n=e.source)||void 0===n?void 0:n.video)||void 0===i?void 0:i.uri)&&(null===(o=null===(s=e.source)||void 0===s?void 0:s.video)||void 0===o?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&!e.config.responseJsonSchema&&Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema)}async processParamsMaybeAddMcpUsage(e){var t,r,n;let i=null===(t=e.config)||void 0===t?void 0:t.tools;if(!i)return e;let s=await Promise.all(i.map(async e=>rK(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(o.config.tools=s,e.config&&e.config.tools&&rL(e.config.tools)){let t=Object.assign({},null!==(n=null===(r=e.config.httpOptions)||void 0===r?void 0:r.headers)&&void 0!==n?n:{});0===Object.keys(t).length&&(t=this.apiClient.getDefaultHeaders()),rG(t),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:t})}return o}async initAfcToolsMap(e){var t,r,n;let i=new Map;for(let s of null!==(r=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==r?r:[])if(rK(s))for(let e of null!==(n=(await s.tool()).functionDeclarations)&&void 0!==n?n:[]){if(!e.name)throw Error("Function declaration name is required.");if(i.has(e.name))throw Error(`Duplicate tool declaration name: ${e.name}`);i.set(e.name,s)}return i}async processAfcStream(e){var t,r,n;let i=null!==(n=null===(r=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===r?void 0:r.maximumRemoteCalls)&&void 0!==n?n:10,s=!1,o=0;return function(e,t,r){return ra(this,arguments,function*(){for(;o<i;){s&&(o++,s=!1);let m=yield ro(e.processParamsMaybeAddMcpUsage(r)),g=yield ro(e.generateContentStreamInternal(m)),y=[],v=[];try{for(var n,a,l,u,c,d,p,h=!0,f=(a=void 0,rl(g));!(n=(p=yield ro(f.next())).done);h=!0)if(u=p.value,h=!1,yield yield ro(u),u.candidates&&(null===(c=u.candidates[0])||void 0===c?void 0:c.content)){for(let e of(v.push(u.candidates[0].content),null!==(d=u.candidates[0].content.parts)&&void 0!==d?d:[]))if(o<i&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let r=yield ro(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...r)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`)}}}catch(e){a={error:e}}finally{try{!h&&!n&&(l=f.return)&&(yield ro(l.call(f)))}finally{if(a)throw a.error}}if(y.length>0){s=!0;let e=new ts;e.candidates=[{content:{role:"user",parts:y}}],yield yield ro(e);let t=[];t.push(...v),t.push({role:"user",parts:y});let n=t$(r.contents).concat(t);r.contents=n}else break}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=r_(this.apiClient,e);return s=e7("{model}:generateContent",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=rE(e),r=new ts;return Object.assign(r,t),r})}{let t=rv(this.apiClient,e);return s=e7("{model}:generateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=rb(e),r=new ts;return Object.assign(r,t),r})}}async generateContentStreamInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=r_(this.apiClient,e);return s=e7("{model}:streamGenerateContent?alt=sse",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.requestStream({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(function(e){return ra(this,arguments,function*(){var t,r,n,i;try{for(var s,o=!0,a=rl(e);!(t=(s=yield ro(a.next())).done);o=!0){i=s.value,o=!1;let e=rE((yield ro(i.json())));e.sdkHttpResponse={headers:i.headers};let t=new ts;Object.assign(t,e),yield yield ro(t)}}catch(e){r={error:e}}finally{try{!o&&!t&&(n=a.return)&&(yield ro(n.call(a)))}finally{if(r)throw r.error}}})})}{let t=rv(this.apiClient,e);return s=e7("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.requestStream({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(function(e){return ra(this,arguments,function*(){var t,r,n,i;try{for(var s,o=!0,a=rl(e);!(t=(s=yield ro(a.next())).done);o=!0){i=s.value,o=!1;let e=rb((yield ro(i.json())));e.sdkHttpResponse={headers:i.headers};let t=new ts;Object.assign(t,e),yield yield ro(t)}}catch(e){r={error:e}}finally{try{!o&&!t&&(n=a.return)&&(yield ro(n.call(a)))}finally{if(r)throw r.error}}})})}}async embedContent(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["contents"]);if(null!=i){let t=tV(e,i);Array.isArray(t)&&(t=t.map(e=>e)),te(r,["instances[]","content"],t)}let s=tt(t,["config"]);return null!=s&&function(e,t){let r=tt(e,["taskType"]);void 0!==t&&null!=r&&te(t,["instances[]","task_type"],r);let n=tt(e,["title"]);void 0!==t&&null!=n&&te(t,["instances[]","title"],n);let i=tt(e,["outputDimensionality"]);void 0!==t&&null!=i&&te(t,["parameters","outputDimensionality"],i);let s=tt(e,["mimeType"]);void 0!==t&&null!=s&&te(t,["instances[]","mimeType"],s);let o=tt(e,["autoTruncate"]);void 0!==t&&null!=o&&te(t,["parameters","autoTruncate"],o)}(s,r),r}(this.apiClient,e);return s=e7("{model}:predict",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["predictions[]","embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["values"]);null!=r&&te(t,["values"],r);let n=tt(e,["statistics"]);return null!=n&&te(t,["statistics"],function(e){let t={},r=tt(e,["truncated"]);null!=r&&te(t,["truncated"],r);let n=tt(e,["token_count"]);return null!=n&&te(t,["tokenCount"],n),t}(n)),t})(e))),te(t,["embeddings"],e)}let i=tt(e,["metadata"]);return null!=i&&te(t,["metadata"],i),t}(e),r=new to;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["contents"]);if(null!=i){let t=tV(e,i);Array.isArray(t)&&(t=t.map(e=>e)),te(r,["requests[]","content"],t)}let s=tt(t,["config"]);null!=s&&function(e,t){let r=tt(e,["taskType"]);void 0!==t&&null!=r&&te(t,["requests[]","taskType"],r);let n=tt(e,["title"]);void 0!==t&&null!=n&&te(t,["requests[]","title"],n);let i=tt(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&te(t,["requests[]","outputDimensionality"],i),void 0!==tt(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==tt(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(s,r);let o=tt(t,["model"]);return void 0!==o&&te(r,["requests[]","model"],tR(e,o)),r}(this.apiClient,e);return s=e7("{model}:batchEmbedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["embeddings"],e)}let i=tt(e,["metadata"]);return null!=i&&te(t,["metadata"],i),t}(e),r=new to;return Object.assign(r,t),r})}}async generateImagesInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["prompt"]);null!=i&&te(r,["instances[0]","prompt"],i);let s=tt(t,["config"]);return null!=s&&function(e,t){let r=tt(e,["outputGcsUri"]);void 0!==t&&null!=r&&te(t,["parameters","storageUri"],r);let n=tt(e,["negativePrompt"]);void 0!==t&&null!=n&&te(t,["parameters","negativePrompt"],n);let i=tt(e,["numberOfImages"]);void 0!==t&&null!=i&&te(t,["parameters","sampleCount"],i);let s=tt(e,["aspectRatio"]);void 0!==t&&null!=s&&te(t,["parameters","aspectRatio"],s);let o=tt(e,["guidanceScale"]);void 0!==t&&null!=o&&te(t,["parameters","guidanceScale"],o);let a=tt(e,["seed"]);void 0!==t&&null!=a&&te(t,["parameters","seed"],a);let l=tt(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&te(t,["parameters","safetySetting"],l);let u=tt(e,["personGeneration"]);void 0!==t&&null!=u&&te(t,["parameters","personGeneration"],u);let c=tt(e,["includeSafetyAttributes"]);void 0!==t&&null!=c&&te(t,["parameters","includeSafetyAttributes"],c);let d=tt(e,["includeRaiReason"]);void 0!==t&&null!=d&&te(t,["parameters","includeRaiReason"],d);let p=tt(e,["language"]);void 0!==t&&null!=p&&te(t,["parameters","language"],p);let h=tt(e,["outputMimeType"]);void 0!==t&&null!=h&&te(t,["parameters","outputOptions","mimeType"],h);let f=tt(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&te(t,["parameters","outputOptions","compressionQuality"],f);let m=tt(e,["addWatermark"]);void 0!==t&&null!=m&&te(t,["parameters","addWatermark"],m);let g=tt(e,["labels"]);void 0!==t&&null!=g&&te(t,["labels"],g);let y=tt(e,["imageSize"]);void 0!==t&&null!=y&&te(t,["parameters","sampleImageSize"],y);let v=tt(e,["enhancePrompt"]);void 0!==t&&null!=v&&te(t,["parameters","enhancePrompt"],v)}(s,r),r}(this.apiClient,e);return s=e7("{model}:predict",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>rx(e))),te(t,["generatedImages"],e)}let i=tt(e,["positivePromptSafetyAttributes"]);return null!=i&&te(t,["positivePromptSafetyAttributes"],rN(i)),t}(e),r=new ta;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["prompt"]);null!=i&&te(r,["instances[0]","prompt"],i);let s=tt(t,["config"]);return null!=s&&function(e,t){if(void 0!==tt(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==tt(e,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let r=tt(e,["numberOfImages"]);void 0!==t&&null!=r&&te(t,["parameters","sampleCount"],r);let n=tt(e,["aspectRatio"]);void 0!==t&&null!=n&&te(t,["parameters","aspectRatio"],n);let i=tt(e,["guidanceScale"]);if(void 0!==t&&null!=i&&te(t,["parameters","guidanceScale"],i),void 0!==tt(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let s=tt(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&te(t,["parameters","safetySetting"],s);let o=tt(e,["personGeneration"]);void 0!==t&&null!=o&&te(t,["parameters","personGeneration"],o);let a=tt(e,["includeSafetyAttributes"]);void 0!==t&&null!=a&&te(t,["parameters","includeSafetyAttributes"],a);let l=tt(e,["includeRaiReason"]);void 0!==t&&null!=l&&te(t,["parameters","includeRaiReason"],l);let u=tt(e,["language"]);void 0!==t&&null!=u&&te(t,["parameters","language"],u);let c=tt(e,["outputMimeType"]);void 0!==t&&null!=c&&te(t,["parameters","outputOptions","mimeType"],c);let d=tt(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&te(t,["parameters","outputOptions","compressionQuality"],d),void 0!==tt(e,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==tt(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let p=tt(e,["imageSize"]);if(void 0!==t&&null!=p&&te(t,["parameters","sampleImageSize"],p),void 0!==tt(e,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(s,r),r}(this.apiClient,e);return s=e7("{model}:predict",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["_self"]);null!=r&&te(t,["image"],function(e){let t={},r=tt(e,["bytesBase64Encoded"]);null!=r&&te(t,["imageBytes"],tr(r));let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(r));let n=tt(e,["raiFilteredReason"]);null!=n&&te(t,["raiFilteredReason"],n);let i=tt(e,["_self"]);return null!=i&&te(t,["safetyAttributes"],rO(i)),t})(e))),te(t,["generatedImages"],e)}let i=tt(e,["positivePromptSafetyAttributes"]);return null!=i&&te(t,["positivePromptSafetyAttributes"],rO(i)),t}(e),r=new ta;return Object.assign(r,t),r})}}async editImageInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["prompt"]);null!=i&&te(r,["instances[0]","prompt"],i);let s=tt(t,["referenceImages"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["referenceImage"]);null!=r&&te(t,["referenceImage"],rT(r));let n=tt(e,["referenceId"]);null!=n&&te(t,["referenceId"],n);let i=tt(e,["referenceType"]);null!=i&&te(t,["referenceType"],i);let s=tt(e,["maskImageConfig"]);null!=s&&te(t,["maskImageConfig"],function(e){let t={},r=tt(e,["maskMode"]);null!=r&&te(t,["maskMode"],r);let n=tt(e,["segmentationClasses"]);null!=n&&te(t,["maskClasses"],n);let i=tt(e,["maskDilation"]);return null!=i&&te(t,["dilation"],i),t}(s));let o=tt(e,["controlImageConfig"]);null!=o&&te(t,["controlImageConfig"],function(e){let t={},r=tt(e,["controlType"]);null!=r&&te(t,["controlType"],r);let n=tt(e,["enableControlImageComputation"]);return null!=n&&te(t,["computeControl"],n),t}(o));let a=tt(e,["styleImageConfig"]);null!=a&&te(t,["styleImageConfig"],a);let l=tt(e,["subjectImageConfig"]);return null!=l&&te(t,["subjectImageConfig"],l),t})(e))),te(r,["instances[0]","referenceImages"],e)}let o=tt(t,["config"]);return null!=o&&function(e,t){let r=tt(e,["outputGcsUri"]);void 0!==t&&null!=r&&te(t,["parameters","storageUri"],r);let n=tt(e,["negativePrompt"]);void 0!==t&&null!=n&&te(t,["parameters","negativePrompt"],n);let i=tt(e,["numberOfImages"]);void 0!==t&&null!=i&&te(t,["parameters","sampleCount"],i);let s=tt(e,["aspectRatio"]);void 0!==t&&null!=s&&te(t,["parameters","aspectRatio"],s);let o=tt(e,["guidanceScale"]);void 0!==t&&null!=o&&te(t,["parameters","guidanceScale"],o);let a=tt(e,["seed"]);void 0!==t&&null!=a&&te(t,["parameters","seed"],a);let l=tt(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&te(t,["parameters","safetySetting"],l);let u=tt(e,["personGeneration"]);void 0!==t&&null!=u&&te(t,["parameters","personGeneration"],u);let c=tt(e,["includeSafetyAttributes"]);void 0!==t&&null!=c&&te(t,["parameters","includeSafetyAttributes"],c);let d=tt(e,["includeRaiReason"]);void 0!==t&&null!=d&&te(t,["parameters","includeRaiReason"],d);let p=tt(e,["language"]);void 0!==t&&null!=p&&te(t,["parameters","language"],p);let h=tt(e,["outputMimeType"]);void 0!==t&&null!=h&&te(t,["parameters","outputOptions","mimeType"],h);let f=tt(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&te(t,["parameters","outputOptions","compressionQuality"],f);let m=tt(e,["addWatermark"]);void 0!==t&&null!=m&&te(t,["parameters","addWatermark"],m);let g=tt(e,["labels"]);void 0!==t&&null!=g&&te(t,["labels"],g);let y=tt(e,["editMode"]);void 0!==t&&null!=y&&te(t,["parameters","editMode"],y);let v=tt(e,["baseSteps"]);void 0!==t&&null!=v&&te(t,["parameters","editConfig","baseSteps"],v)}(o,r),r}(this.apiClient,e);return n=e7("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>rx(e))),te(t,["generatedImages"],e)}return t}(e),r=new tl;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["image"]);null!=i&&te(r,["instances[0]","image"],rT(i));let s=tt(t,["upscaleFactor"]);null!=s&&te(r,["parameters","upscaleConfig","upscaleFactor"],s);let o=tt(t,["config"]);return null!=o&&function(e,t){let r=tt(e,["outputGcsUri"]);void 0!==t&&null!=r&&te(t,["parameters","storageUri"],r);let n=tt(e,["safetyFilterLevel"]);void 0!==t&&null!=n&&te(t,["parameters","safetySetting"],n);let i=tt(e,["personGeneration"]);void 0!==t&&null!=i&&te(t,["parameters","personGeneration"],i);let s=tt(e,["includeRaiReason"]);void 0!==t&&null!=s&&te(t,["parameters","includeRaiReason"],s);let o=tt(e,["outputMimeType"]);void 0!==t&&null!=o&&te(t,["parameters","outputOptions","mimeType"],o);let a=tt(e,["outputCompressionQuality"]);void 0!==t&&null!=a&&te(t,["parameters","outputOptions","compressionQuality"],a);let l=tt(e,["enhanceInputImage"]);void 0!==t&&null!=l&&te(t,["parameters","upscaleConfig","enhanceInputImage"],l);let u=tt(e,["imagePreservationFactor"]);void 0!==t&&null!=u&&te(t,["parameters","upscaleConfig","imagePreservationFactor"],u);let c=tt(e,["labels"]);void 0!==t&&null!=c&&te(t,["labels"],c);let d=tt(e,["numberOfImages"]);void 0!==t&&null!=d&&te(t,["parameters","sampleCount"],d);let p=tt(e,["mode"]);void 0!==t&&null!=p&&te(t,["parameters","mode"],p)}(o,r),r}(this.apiClient,e);return n=e7("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>rx(e))),te(t,["generatedImages"],e)}return t}(e),r=new tu;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["source"]);null!=i&&function(e,t){let r=tt(e,["prompt"]);void 0!==t&&null!=r&&te(t,["instances[0]","prompt"],r);let n=tt(e,["personImage"]);void 0!==t&&null!=n&&te(t,["instances[0]","personImage","image"],rT(n));let i=tt(e,["productImages"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["productImage"]);return null!=r&&te(t,["image"],rT(r)),t})(e))),te(t,["instances[0]","productImages"],e)}}(i,r);let s=tt(t,["config"]);return null!=s&&function(e,t){let r=tt(e,["numberOfImages"]);void 0!==t&&null!=r&&te(t,["parameters","sampleCount"],r);let n=tt(e,["baseSteps"]);void 0!==t&&null!=n&&te(t,["parameters","baseSteps"],n);let i=tt(e,["outputGcsUri"]);void 0!==t&&null!=i&&te(t,["parameters","storageUri"],i);let s=tt(e,["seed"]);void 0!==t&&null!=s&&te(t,["parameters","seed"],s);let o=tt(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&te(t,["parameters","safetySetting"],o);let a=tt(e,["personGeneration"]);void 0!==t&&null!=a&&te(t,["parameters","personGeneration"],a);let l=tt(e,["addWatermark"]);void 0!==t&&null!=l&&te(t,["parameters","addWatermark"],l);let u=tt(e,["outputMimeType"]);void 0!==t&&null!=u&&te(t,["parameters","outputOptions","mimeType"],u);let c=tt(e,["outputCompressionQuality"]);void 0!==t&&null!=c&&te(t,["parameters","outputOptions","compressionQuality"],c);let d=tt(e,["enhancePrompt"]);void 0!==t&&null!=d&&te(t,["parameters","enhancePrompt"],d);let p=tt(e,["labels"]);void 0!==t&&null!=p&&te(t,["labels"],p)}(s,r),r}(this.apiClient,e);return n=e7("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>rx(e))),te(t,["generatedImages"],e)}return t}(e),r=new tc;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["source"]);null!=i&&function(e,t){let r=tt(e,["prompt"]);void 0!==t&&null!=r&&te(t,["instances[0]","prompt"],r);let n=tt(e,["image"]);void 0!==t&&null!=n&&te(t,["instances[0]","image"],rT(n));let i=tt(e,["scribbleImage"]);void 0!==t&&null!=i&&te(t,["instances[0]","scribble"],function(e){let t={},r=tt(e,["image"]);return null!=r&&te(t,["image"],rT(r)),t}(i))}(i,r);let s=tt(t,["config"]);return null!=s&&function(e,t){let r=tt(e,["mode"]);void 0!==t&&null!=r&&te(t,["parameters","mode"],r);let n=tt(e,["maxPredictions"]);void 0!==t&&null!=n&&te(t,["parameters","maxPredictions"],n);let i=tt(e,["confidenceThreshold"]);void 0!==t&&null!=i&&te(t,["parameters","confidenceThreshold"],i);let s=tt(e,["maskDilation"]);void 0!==t&&null!=s&&te(t,["parameters","maskDilation"],s);let o=tt(e,["binaryColorThreshold"]);void 0!==t&&null!=o&&te(t,["parameters","binaryColorThreshold"],o);let a=tt(e,["labels"]);void 0!==t&&null!=a&&te(t,["labels"],a)}(s,r),r}(this.apiClient,e);return n=e7("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["_self"]);null!=r&&te(t,["mask"],rw(r));let n=tt(e,["labels"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["labels"],e)}return t})(e))),te(t,["generatedMasks"],e)}return t}(e),r=new td;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);return null!=n&&te(r,["_url","name"],tR(e,n)),r}(this.apiClient,e);return s=e7("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>rC(e))}{let t=function(e,t){let r={},n=tt(t,["model"]);return null!=n&&te(r,["_url","name"],tR(e,n)),r}(this.apiClient,e);return s=e7("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>rS(e))}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["config"]);return null!=n&&function(e,t,r){let n=tt(t,["pageSize"]);void 0!==r&&null!=n&&te(r,["_query","pageSize"],n);let i=tt(t,["pageToken"]);void 0!==r&&null!=i&&te(r,["_query","pageToken"],i);let s=tt(t,["filter"]);void 0!==r&&null!=s&&te(r,["_query","filter"],s);let o=tt(t,["queryBase"]);void 0!==r&&null!=o&&te(r,["_url","models_url"],t2(e,o))}(e,n,r),r}(this.apiClient,e);return s=e7("{models_url}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["_self"]);if(null!=i){let e=t5(i);Array.isArray(e)&&(e=e.map(e=>rC(e))),te(t,["models"],e)}return t}(e),r=new tp;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=tt(t,["config"]);return null!=n&&function(e,t,r){let n=tt(t,["pageSize"]);void 0!==r&&null!=n&&te(r,["_query","pageSize"],n);let i=tt(t,["pageToken"]);void 0!==r&&null!=i&&te(r,["_query","pageToken"],i);let s=tt(t,["filter"]);void 0!==r&&null!=s&&te(r,["_query","filter"],s);let o=tt(t,["queryBase"]);void 0!==r&&null!=o&&te(r,["_url","models_url"],t2(e,o))}(e,n,r),r}(this.apiClient,e);return s=e7("{models_url}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["_self"]);if(null!=i){let e=t5(i);Array.isArray(e)&&(e=e.map(e=>rS(e))),te(t,["models"],e)}return t}(e),r=new tp;return Object.assign(r,t),r})}}async update(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["config"]);return null!=i&&function(e,t){let r=tt(e,["displayName"]);void 0!==t&&null!=r&&te(t,["displayName"],r);let n=tt(e,["description"]);void 0!==t&&null!=n&&te(t,["description"],n);let i=tt(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&te(t,["defaultCheckpointId"],i)}(i,r),r}(this.apiClient,e);return s=e7("{model}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>rC(e))}{let t=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","name"],tR(e,n));let i=tt(t,["config"]);return null!=i&&function(e,t){let r=tt(e,["displayName"]);void 0!==t&&null!=r&&te(t,["displayName"],r);let n=tt(e,["description"]);void 0!==t&&null!=n&&te(t,["description"],n);let i=tt(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&te(t,["defaultCheckpointId"],i)}(i,r),r}(this.apiClient,e);return s=e7("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>rS(e))}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);return null!=n&&te(r,["_url","name"],tR(e,n)),r}(this.apiClient,e);return s=e7("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);return null!=r&&te(t,["sdkHttpResponse"],r),t}(e),r=new th;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=tt(t,["model"]);return null!=n&&te(r,["_url","name"],tR(e,n)),r}(this.apiClient,e);return s=e7("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);return null!=r&&te(t,["sdkHttpResponse"],r),t}(e),r=new th;return Object.assign(r,t),r})}}async countTokens(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["contents"]);if(null!=i){let e=t$(i);Array.isArray(e)&&(e=e.map(e=>e)),te(r,["contents"],e)}let s=tt(t,["config"]);return null!=s&&function(e,t){let r=tt(e,["systemInstruction"]);void 0!==t&&null!=r&&te(t,["systemInstruction"],tB(r));let n=tt(e,["tools"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>rk(e))),te(t,["tools"],e)}let i=tt(e,["generationConfig"]);void 0!==t&&null!=i&&te(t,["generationConfig"],function(e){let t={},r=tt(e,["modelSelectionConfig"]);null!=r&&te(t,["modelConfig"],r);let n=tt(e,["responseJsonSchema"]);null!=n&&te(t,["responseJsonSchema"],n);let i=tt(e,["audioTimestamp"]);null!=i&&te(t,["audioTimestamp"],i);let s=tt(e,["candidateCount"]);null!=s&&te(t,["candidateCount"],s);let o=tt(e,["enableAffectiveDialog"]);null!=o&&te(t,["enableAffectiveDialog"],o);let a=tt(e,["frequencyPenalty"]);null!=a&&te(t,["frequencyPenalty"],a);let l=tt(e,["logprobs"]);null!=l&&te(t,["logprobs"],l);let u=tt(e,["maxOutputTokens"]);null!=u&&te(t,["maxOutputTokens"],u);let c=tt(e,["mediaResolution"]);null!=c&&te(t,["mediaResolution"],c);let d=tt(e,["presencePenalty"]);null!=d&&te(t,["presencePenalty"],d);let p=tt(e,["responseLogprobs"]);null!=p&&te(t,["responseLogprobs"],p);let h=tt(e,["responseMimeType"]);null!=h&&te(t,["responseMimeType"],h);let f=tt(e,["responseModalities"]);null!=f&&te(t,["responseModalities"],f);let m=tt(e,["responseSchema"]);null!=m&&te(t,["responseSchema"],m);let g=tt(e,["routingConfig"]);null!=g&&te(t,["routingConfig"],g);let y=tt(e,["seed"]);null!=y&&te(t,["seed"],y);let v=tt(e,["speechConfig"]);null!=v&&te(t,["speechConfig"],rI(v));let _=tt(e,["stopSequences"]);null!=_&&te(t,["stopSequences"],_);let b=tt(e,["temperature"]);null!=b&&te(t,["temperature"],b);let E=tt(e,["thinkingConfig"]);null!=E&&te(t,["thinkingConfig"],E);let x=tt(e,["topK"]);null!=x&&te(t,["topK"],x);let w=tt(e,["topP"]);if(null!=w&&te(t,["topP"],w),void 0!==tt(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(i))}(s,r),r}(this.apiClient,e);return s=e7("{model}:countTokens",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["totalTokens"]);return null!=n&&te(t,["totalTokens"],n),t}(e),r=new tf;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["contents"]);if(null!=i){let e=t$(i);Array.isArray(e)&&(e=e.map(e=>ry(e))),te(r,["contents"],e)}let s=tt(t,["config"]);return null!=s&&function(e){if(void 0!==tt(e,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==tt(e,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==tt(e,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(s),r}(this.apiClient,e);return s=e7("{model}:countTokens",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["totalTokens"]);null!=n&&te(t,["totalTokens"],n);let i=tt(e,["cachedContentTokenCount"]);return null!=i&&te(t,["cachedContentTokenCount"],i),t}(e),r=new tf;return Object.assign(r,t),r})}}async computeTokens(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["contents"]);if(null!=i){let e=t$(i);Array.isArray(e)&&(e=e.map(e=>e)),te(r,["contents"],e)}return r}(this.apiClient,e);return n=e7("{model}:computeTokens",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["tokensInfo"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["tokensInfo"],e)}return t}(e),r=new tm;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["prompt"]);null!=i&&te(r,["instances[0]","prompt"],i);let s=tt(t,["image"]);null!=s&&te(r,["instances[0]","image"],rT(s));let o=tt(t,["video"]);null!=o&&te(r,["instances[0]","video"],rP(o));let a=tt(t,["source"]);null!=a&&function(e,t){let r=tt(e,["prompt"]);void 0!==t&&null!=r&&te(t,["instances[0]","prompt"],r);let n=tt(e,["image"]);void 0!==t&&null!=n&&te(t,["instances[0]","image"],rT(n));let i=tt(e,["video"]);void 0!==t&&null!=i&&te(t,["instances[0]","video"],rP(i))}(a,r);let l=tt(t,["config"]);return null!=l&&function(e,t){let r=tt(e,["numberOfVideos"]);void 0!==t&&null!=r&&te(t,["parameters","sampleCount"],r);let n=tt(e,["outputGcsUri"]);void 0!==t&&null!=n&&te(t,["parameters","storageUri"],n);let i=tt(e,["fps"]);void 0!==t&&null!=i&&te(t,["parameters","fps"],i);let s=tt(e,["durationSeconds"]);void 0!==t&&null!=s&&te(t,["parameters","durationSeconds"],s);let o=tt(e,["seed"]);void 0!==t&&null!=o&&te(t,["parameters","seed"],o);let a=tt(e,["aspectRatio"]);void 0!==t&&null!=a&&te(t,["parameters","aspectRatio"],a);let l=tt(e,["resolution"]);void 0!==t&&null!=l&&te(t,["parameters","resolution"],l);let u=tt(e,["personGeneration"]);void 0!==t&&null!=u&&te(t,["parameters","personGeneration"],u);let c=tt(e,["pubsubTopic"]);void 0!==t&&null!=c&&te(t,["parameters","pubsubTopic"],c);let d=tt(e,["negativePrompt"]);void 0!==t&&null!=d&&te(t,["parameters","negativePrompt"],d);let p=tt(e,["enhancePrompt"]);void 0!==t&&null!=p&&te(t,["parameters","enhancePrompt"],p);let h=tt(e,["generateAudio"]);void 0!==t&&null!=h&&te(t,["parameters","generateAudio"],h);let f=tt(e,["lastFrame"]);void 0!==t&&null!=f&&te(t,["instances[0]","lastFrame"],rT(f));let m=tt(e,["referenceImages"]);if(void 0!==t&&null!=m){let e=m;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["image"]);null!=r&&te(t,["image"],rT(r));let n=tt(e,["referenceType"]);return null!=n&&te(t,["referenceType"],n),t})(e))),te(t,["instances[0]","referenceImages"],e)}let g=tt(e,["mask"]);void 0!==t&&null!=g&&te(t,["instances[0]","mask"],function(e){let t={},r=tt(e,["image"]);null!=r&&te(t,["_self"],rT(r));let n=tt(e,["maskMode"]);return null!=n&&te(t,["maskMode"],n),t}(g));let y=tt(e,["compressionQuality"]);void 0!==t&&null!=y&&te(t,["parameters","compressionQuality"],y)}(l,r),r}(this.apiClient,e);return s=e7("{model}:predictLongRunning",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["metadata"]);null!=n&&te(t,["metadata"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);null!=s&&te(t,["error"],s);let o=tt(e,["response"]);return null!=o&&te(t,["response"],function(e){let t={},r=tt(e,["videos"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["_self"]);return null!=r&&te(t,["video"],function(e){let t={},r=tt(e,["gcsUri"]);null!=r&&te(t,["uri"],r);let n=tt(e,["bytesBase64Encoded"]);null!=n&&te(t,["videoBytes"],tr(n));let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(r)),t})(e))),te(t,["generatedVideos"],e)}let n=tt(e,["raiMediaFilteredCount"]);null!=n&&te(t,["raiMediaFilteredCount"],n);let i=tt(e,["raiMediaFilteredReasons"]);return null!=i&&te(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e),r=new tg;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["_url","model"],tR(e,n));let i=tt(t,["prompt"]);null!=i&&te(r,["instances[0]","prompt"],i);let s=tt(t,["image"]);null!=s&&te(r,["instances[0]","image"],rA(s));let o=tt(t,["video"]);null!=o&&te(r,["instances[0]","video"],rR(o));let a=tt(t,["source"]);null!=a&&function(e,t){let r=tt(e,["prompt"]);void 0!==t&&null!=r&&te(t,["instances[0]","prompt"],r);let n=tt(e,["image"]);void 0!==t&&null!=n&&te(t,["instances[0]","image"],rA(n));let i=tt(e,["video"]);void 0!==t&&null!=i&&te(t,["instances[0]","video"],rR(i))}(a,r);let l=tt(t,["config"]);return null!=l&&function(e,t){let r=tt(e,["numberOfVideos"]);if(void 0!==t&&null!=r&&te(t,["parameters","sampleCount"],r),void 0!==tt(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==tt(e,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let n=tt(e,["durationSeconds"]);if(void 0!==t&&null!=n&&te(t,["parameters","durationSeconds"],n),void 0!==tt(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let i=tt(e,["aspectRatio"]);void 0!==t&&null!=i&&te(t,["parameters","aspectRatio"],i);let s=tt(e,["resolution"]);void 0!==t&&null!=s&&te(t,["parameters","resolution"],s);let o=tt(e,["personGeneration"]);if(void 0!==t&&null!=o&&te(t,["parameters","personGeneration"],o),void 0!==tt(e,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let a=tt(e,["negativePrompt"]);void 0!==t&&null!=a&&te(t,["parameters","negativePrompt"],a);let l=tt(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&te(t,["parameters","enhancePrompt"],l),void 0!==tt(e,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let u=tt(e,["lastFrame"]);void 0!==t&&null!=u&&te(t,["instances[0]","lastFrame"],rA(u));let c=tt(e,["referenceImages"]);if(void 0!==t&&null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["image"]);null!=r&&te(t,["image"],rA(r));let n=tt(e,["referenceType"]);return null!=n&&te(t,["referenceType"],n),t})(e))),te(t,["instances[0]","referenceImages"],e)}if(void 0!==tt(e,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==tt(e,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(l,r),r}(this.apiClient,e);return s=e7("{model}:predictLongRunning",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["metadata"]);null!=n&&te(t,["metadata"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);null!=s&&te(t,["error"],s);let o=tt(e,["response","generateVideoResponse"]);return null!=o&&te(t,["response"],function(e){let t={},r=tt(e,["generatedSamples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["video"]);return null!=r&&te(t,["video"],function(e){let t={},r=tt(e,["uri"]);null!=r&&te(t,["uri"],r);let n=tt(e,["encodedVideo"]);null!=n&&te(t,["videoBytes"],tr(n));let i=tt(e,["encoding"]);return null!=i&&te(t,["mimeType"],i),t}(r)),t})(e))),te(t,["generatedVideos"],e)}let n=tt(e,["raiMediaFilteredCount"]);null!=n&&te(t,["raiMediaFilteredCount"],n);let i=tt(e,["raiMediaFilteredReasons"]);return null!=i&&te(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e),r=new tg;return Object.assign(r,t),r})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rZ extends e9{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,r=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e;let n=t.name.split("/operations/")[0];r&&"httpOptions"in r&&(e=r.httpOptions);let i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:n,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){let t=e.operation,r=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e;let n=t.name.split("/operations/")[0];r&&"httpOptions"in r&&(e=r.httpOptions);let i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:n,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=tt(e,["operationName"]);return null!=r&&te(t,["_url","operationName"],r),t}(e);return s=e7("{operationName}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json())}{let t=function(e){let t={},r=tt(e,["operationName"]);return null!=r&&te(t,["_url","operationName"],r),t}(e);return s=e7("{operationName}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json())}}async fetchPredictVideosOperationInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){let t={},r=tt(e,["operationName"]);null!=r&&te(t,["operationName"],r);let n=tt(e,["resourceName"]);return null!=n&&te(t,["_url","resourceName"],n),t}(e);return n=e7("{resourceName}:fetchPredictOperation",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json())}throw Error("This method is only supported by the Vertex AI.")}}class r0 extends e9{constructor(e){super(),this.apiClient=e}async create(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let s=function(e,t){let r={},n=tt(t,["config"]);return null!=n&&te(r,["config"],function(e,t,r){let n=tt(t,["expireTime"]);void 0!==r&&null!=n&&te(r,["expireTime"],n);let i=tt(t,["newSessionExpireTime"]);void 0!==r&&null!=i&&te(r,["newSessionExpireTime"],i);let s=tt(t,["uses"]);void 0!==r&&null!=s&&te(r,["uses"],s);let o=tt(t,["liveConnectConstraints"]);void 0!==r&&null!=o&&te(r,["bidiGenerateContentSetup"],function(e,t){let r={},n=tt(t,["model"]);null!=n&&te(r,["setup","model"],tR(e,n));let i=tt(t,["config"]);return null!=i&&te(r,["config"],function(e,t){let r=tt(e,["generationConfig"]);void 0!==t&&null!=r&&te(t,["setup","generationConfig"],r);let n=tt(e,["responseModalities"]);void 0!==t&&null!=n&&te(t,["setup","generationConfig","responseModalities"],n);let i=tt(e,["temperature"]);void 0!==t&&null!=i&&te(t,["setup","generationConfig","temperature"],i);let s=tt(e,["topP"]);void 0!==t&&null!=s&&te(t,["setup","generationConfig","topP"],s);let o=tt(e,["topK"]);void 0!==t&&null!=o&&te(t,["setup","generationConfig","topK"],o);let a=tt(e,["maxOutputTokens"]);void 0!==t&&null!=a&&te(t,["setup","generationConfig","maxOutputTokens"],a);let l=tt(e,["mediaResolution"]);void 0!==t&&null!=l&&te(t,["setup","generationConfig","mediaResolution"],l);let u=tt(e,["seed"]);void 0!==t&&null!=u&&te(t,["setup","generationConfig","seed"],u);let c=tt(e,["speechConfig"]);void 0!==t&&null!=c&&te(t,["setup","generationConfig","speechConfig"],tz(c));let d=tt(e,["thinkingConfig"]);void 0!==t&&null!=d&&te(t,["setup","generationConfig","thinkingConfig"],d);let p=tt(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&te(t,["setup","generationConfig","enableAffectiveDialog"],p);let h=tt(e,["systemInstruction"]);void 0!==t&&null!=h&&te(t,["setup","systemInstruction"],function(e){let t={},r=tt(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["mediaResolution"]);null!=r&&te(t,["mediaResolution"],r);let n=tt(e,["codeExecutionResult"]);null!=n&&te(t,["codeExecutionResult"],n);let i=tt(e,["executableCode"]);null!=i&&te(t,["executableCode"],i);let s=tt(e,["fileData"]);null!=s&&te(t,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=tt(e,["fileUri"]);null!=r&&te(t,["fileUri"],r);let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(s));let o=tt(e,["functionCall"]);null!=o&&te(t,["functionCall"],function(e){let t={},r=tt(e,["id"]);null!=r&&te(t,["id"],r);let n=tt(e,["args"]);null!=n&&te(t,["args"],n);let i=tt(e,["name"]);if(null!=i&&te(t,["name"],i),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(o));let a=tt(e,["functionResponse"]);null!=a&&te(t,["functionResponse"],a);let l=tt(e,["inlineData"]);null!=l&&te(t,["inlineData"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){let t={},r=tt(e,["data"]);if(null!=r&&te(t,["data"],r),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["mimeType"]);return null!=n&&te(t,["mimeType"],n),t}(l));let u=tt(e,["text"]);null!=u&&te(t,["text"],u);let c=tt(e,["thought"]);null!=c&&te(t,["thought"],c);let d=tt(e,["thoughtSignature"]);null!=d&&te(t,["thoughtSignature"],d);let p=tt(e,["videoMetadata"]);return null!=p&&te(t,["videoMetadata"],p),t})(e))),te(t,["parts"],e)}let n=tt(e,["role"]);return null!=n&&te(t,["role"],n),t}(tB(h)));let f=tt(e,["tools"]);if(void 0!==t&&null!=f){let e=tY(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=tt(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=tt(e,["googleSearchRetrieval"]);null!=n&&te(t,["googleSearchRetrieval"],n);let i=tt(e,["computerUse"]);null!=i&&te(t,["computerUse"],i);let s=tt(e,["fileSearch"]);null!=s&&te(t,["fileSearch"],s);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=tt(e,["enableWidget"]);return null!=r&&te(t,["enableWidget"],r),t}(a));let l=tt(e,["googleSearch"]);null!=l&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let r=tt(e,["timeRangeFilter"]);return null!=r&&te(t,["timeRangeFilter"],r),t}(l));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(tK(e)))),te(t,["setup","tools"],e)}let m=tt(e,["sessionResumption"]);void 0!==t&&null!=m&&te(t,["setup","sessionResumption"],function(e){let t={},r=tt(e,["handle"]);if(null!=r&&te(t,["handle"],r),void 0!==tt(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(m));let g=tt(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&te(t,["setup","inputAudioTranscription"],g);let y=tt(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&te(t,["setup","outputAudioTranscription"],y);let v=tt(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&te(t,["setup","realtimeInputConfig"],v);let _=tt(e,["contextWindowCompression"]);void 0!==t&&null!=_&&te(t,["setup","contextWindowCompression"],_);let b=tt(e,["proactivity"]);return void 0!==t&&null!=b&&te(t,["setup","proactivity"],b),{}}(i,r)),r}(e,o));let a=tt(t,["lockAdditionalFields"]);return void 0!==r&&null!=a&&te(r,["fieldMask"],a),{}}(e,n,r)),r}(this.apiClient,e);n=e7("auth_tokens",s._url),i=s._query,delete s.config,delete s._url,delete s._query;let o=function(e,t){let r=null,n=e.bidiGenerateContentSetup;if("object"==typeof n&&null!==n&&"setup"in n){let t=n.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,r=t):delete e.bidiGenerateContentSetup}else void 0!==n&&delete e.bidiGenerateContentSetup;let i=e.fieldMask;if(r){let n=/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){let t=[];for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let n=e[r];if("object"==typeof n&&null!=n&&Object.keys(n).length>0){let e=Object.keys(n).map(e=>`${r}.${e}`);t.push(...e)}else t.push(r)}return t.join(",")}(r);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)n?e.fieldMask=n:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],r=[];i.length>0&&(r=i.map(e=>t.includes(e)?`generationConfig.${e}`:e));let s=[];n&&s.push(n),r.length>0&&s.push(...r),s.length>0?e.fieldMask=s.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}(s,e.config);return this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r1 extends e9{constructor(e){super(),this.apiClient=e,this.list=async e=>new rr(el.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["name"]);return null!=r&&te(t,["_url","name"],r),t}(e);return n=e7("{name}",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["_url","name"],r);let n=tt(e,["config"]);return null!=n&&/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let r=tt(e,["force"]);void 0!==t&&null!=r&&te(t,["_query","force"],r)}(n,t),t}(e);n=e7("{name}",s._url),i=s._query,delete s._url,delete s._query,await this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal})}}async listInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["parent"]);null!=r&&te(t,["_url","parent"],r);let n=tt(e,["config"]);return null!=n&&function(e,t){let r=tt(e,["pageSize"]);void 0!==t&&null!=r&&te(t,["_query","pageSize"],r);let n=tt(e,["pageToken"]);void 0!==t&&null!=n&&te(t,["_query","pageToken"],n)}(n,t),t}(e);return n=e7("{parent}/documents",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["documents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["documents"],e)}return t}(e),r=new tE;return Object.assign(r,t),r})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r2 extends e9{constructor(e,t=new r1(e)){super(),this.apiClient=e,this.documents=t,this.list=async(e={})=>new rr(el.PAGED_ITEM_FILE_SEARCH_STORES,e=>this.listInternal(e),await this.listInternal(e),e)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["config"]);return null!=r&&/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let r=tt(e,["displayName"]);void 0!==t&&null!=r&&te(t,["displayName"],r)}(r,t),t}(e);return n=e7("fileSearchStores",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["name"]);return null!=r&&te(t,["_url","name"],r),t}(e);return n=e7("{name}",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["_url","name"],r);let n=tt(e,["config"]);return null!=n&&function(e,t){let r=tt(e,["force"]);void 0!==t&&null!=r&&te(t,["_query","force"],r)}(n,t),t}(e);n=e7("{name}",s._url),i=s._query,delete s._url,delete s._query,await this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal})}}async listInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["config"]);return null!=r&&function(e,t){let r=tt(e,["pageSize"]);void 0!==t&&null!=r&&te(t,["_query","pageSize"],r);let n=tt(e,["pageToken"]);void 0!==t&&null!=n&&te(t,["_query","pageToken"],n)}(r,t),t}(e);return n=e7("fileSearchStores",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["nextPageToken"]);null!=n&&te(t,["nextPageToken"],n);let i=tt(e,["fileSearchStores"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["fileSearchStores"],e)}return t}(e),r=new tx;return Object.assign(r,t),r})}}async uploadToFileSearchStoreInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["fileSearchStoreName"]);null!=r&&te(t,["_url","file_search_store_name"],r);let n=tt(e,["config"]);return null!=n&&rj(n,t),t}(e);return n=e7("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["sdkHttpResponse"]);return null!=r&&te(t,["sdkHttpResponse"],r),t}(e),r=new tw;return Object.assign(r,t),r})}}async importFile(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=tt(e,["fileSearchStoreName"]);null!=r&&te(t,["_url","file_search_store_name"],r);let n=tt(e,["fileName"]);null!=n&&te(t,["fileName"],n);let i=tt(e,["config"]);return null!=i&&function(e,t){let r=tt(e,["customMetadata"]);if(void 0!==t&&null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["customMetadata"],e)}let n=tt(e,["chunkingConfig"]);void 0!==t&&null!=n&&te(t,["chunkingConfig"],n)}(i,t),t}(e);return n=e7("{file_search_store_name}:importFile",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=tt(e,["name"]);null!=r&&te(t,["name"],r);let n=tt(e,["metadata"]);null!=n&&te(t,["metadata"],n);let i=tt(e,["done"]);null!=i&&te(t,["done"],i);let s=tt(e,["error"]);null!=s&&te(t,["error"],s);let o=tt(e,["response"]);return null!=o&&te(t,["response"],function(e){let t={},r=tt(e,["sdkHttpResponse"]);null!=r&&te(t,["sdkHttpResponse"],r);let n=tt(e,["parent"]);null!=n&&te(t,["parent"],n);let i=tt(e,["documentName"]);return null!=i&&te(t,["documentName"],i),t}(o)),t}(e),r=new tA;return Object.assign(r,t),r})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let r5="x-goog-api-key",r4="https://www.googleapis.com/auth/cloud-platform";class r3{constructor(e){if(void 0!==e.apiKey){this.apiKey=e.apiKey;return}let t=function(e){if(!e)return{scopes:[r4]};if(e.scopes){if("string"==typeof e.scopes&&e.scopes!==r4||Array.isArray(e.scopes)&&0>e.scopes.indexOf(r4))throw Error(`Invalid auth scopes. Scopes must include: ${r4}`)}else e.scopes=[r4];return e}(e.googleAuthOptions);this.googleAuth=new e1.eE(t)}async addAuthHeaders(e,t){if(void 0!==this.apiKey){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");this.addKeyHeader(e);return}return this.addGoogleAuthHeaders(e,t)}addKeyHeader(e){if(null===e.get(r5)){if(void 0===this.apiKey)throw Error("Trying to set API key header but apiKey is not set");e.append(r5,this.apiKey)}}async addGoogleAuthHeaders(e,t){if(void 0===this.googleAuth)throw Error("Trying to set google-auth headers but googleAuth is unset");for(let[r,n]of(await this.googleAuth.getRequestHeaders(t)))null===e.get(r)&&e.append(r,n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r6{async download(e,t){if(e.downloadPath){let r=await r8(e,t);if(r instanceof ti){let t=(0,e2.createWriteStream)(e.downloadPath);e4.Readable.fromWeb(r.responseInternal.body).pipe(t),await (0,e3.finished)(t)}else try{await (0,e5.writeFile)(e.downloadPath,r,{encoding:"base64"})}catch(t){throw Error(`Failed to write file to ${e.downloadPath}: ${t}`)}}}}async function r8(e,t){var r,n,i;let s=t1(e.file);if(void 0!==s)return await t.request({path:`files/${s}:download`,httpMethod:"GET",queryParams:{alt:"media"},httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal});if(tZ(e.file)){let t=null===(i=e.file.video)||void 0===i?void 0:i.videoBytes;if("string"==typeof t)return t;throw Error("Failed to download generated video, Uri or videoBytes not found.")}if(t0(e.file)){let t=e.file.videoBytes;if("string"==typeof t)return t;throw Error("Failed to download video, Uri or videoBytes not found.")}throw Error("Unsupported file type")}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r9{create(e,t,r){return new r7(e,t,r)}}class r7{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new e6(this.url,{headers:this.headers}),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}function ne(e,t){let r={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(r,["sdkHttpResponse"],n);let i=tt(e,["name"]);null!=i&&te(r,["name"],i);let s=tt(e,["state"]);null!=s&&te(r,["state"],tQ(s));let o=tt(e,["createTime"]);null!=o&&te(r,["createTime"],o);let a=tt(e,["tuningTask","startTime"]);null!=a&&te(r,["startTime"],a);let l=tt(e,["tuningTask","completeTime"]);null!=l&&te(r,["endTime"],l);let u=tt(e,["updateTime"]);null!=u&&te(r,["updateTime"],u);let c=tt(e,["description"]);null!=c&&te(r,["description"],c);let d=tt(e,["baseModel"]);null!=d&&te(r,["baseModel"],d);let p=tt(e,["_self"]);return null!=p&&te(r,["tunedModel"],function(e,t){let r={},n=tt(e,["name"]);null!=n&&te(r,["model"],n);let i=tt(e,["name"]);return null!=i&&te(r,["endpoint"],i),r}(p)),r}function nt(e,t){let r={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(r,["sdkHttpResponse"],n);let i=tt(e,["name"]);null!=i&&te(r,["name"],i);let s=tt(e,["state"]);null!=s&&te(r,["state"],tQ(s));let o=tt(e,["createTime"]);null!=o&&te(r,["createTime"],o);let a=tt(e,["startTime"]);null!=a&&te(r,["startTime"],a);let l=tt(e,["endTime"]);null!=l&&te(r,["endTime"],l);let u=tt(e,["updateTime"]);null!=u&&te(r,["updateTime"],u);let c=tt(e,["error"]);null!=c&&te(r,["error"],c);let d=tt(e,["description"]);null!=d&&te(r,["description"],d);let p=tt(e,["baseModel"]);null!=p&&te(r,["baseModel"],p);let h=tt(e,["tunedModel"]);null!=h&&te(r,["tunedModel"],h);let f=tt(e,["preTunedModel"]);null!=f&&te(r,["preTunedModel"],f);let m=tt(e,["supervisedTuningSpec"]);null!=m&&te(r,["supervisedTuningSpec"],m);let g=tt(e,["preferenceOptimizationSpec"]);null!=g&&te(r,["preferenceOptimizationSpec"],g);let y=tt(e,["tuningDataStats"]);null!=y&&te(r,["tuningDataStats"],y);let v=tt(e,["encryptionSpec"]);null!=v&&te(r,["encryptionSpec"],v);let _=tt(e,["partnerModelTuningSpec"]);null!=_&&te(r,["partnerModelTuningSpec"],_);let b=tt(e,["customBaseModel"]);null!=b&&te(r,["customBaseModel"],b);let E=tt(e,["experiment"]);null!=E&&te(r,["experiment"],E);let x=tt(e,["labels"]);null!=x&&te(r,["labels"],x);let w=tt(e,["outputUri"]);null!=w&&te(r,["outputUri"],w);let A=tt(e,["pipelineJob"]);null!=A&&te(r,["pipelineJob"],A);let T=tt(e,["serviceAccount"]);null!=T&&te(r,["serviceAccount"],T);let S=tt(e,["tunedModelDisplayName"]);null!=S&&te(r,["tunedModelDisplayName"],S);let C=tt(e,["veoTuningSpec"]);return null!=C&&te(r,["veoTuningSpec"],C),r}function nr(e,t){let r={},n=tt(e,["gcsUri"]);null!=n&&te(r,["validationDatasetUri"],n);let i=tt(e,["vertexDatasetResource"]);return null!=i&&te(r,["validationDatasetUri"],i),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nn extends e9{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new rr(el.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.get=async e=>await this.getInternal(e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI()){if(e.baseModel.startsWith("projects/")){let r={tunedModelName:e.baseModel};(null===(t=e.config)||void 0===t?void 0:t.preTunedModelCheckpointId)&&(r.checkpointId=e.config.preTunedModelCheckpointId);let n=Object.assign(Object.assign({},e),{preTunedModel:r});return n.baseModel=void 0,await this.tuneInternal(n)}{let t=Object.assign({},e);return await this.tuneInternal(t)}}{let t=Object.assign({},e),r=await this.tuneMldevInternal(t),n="";return void 0!==r.metadata&&void 0!==r.metadata.tunedModel?n=r.metadata.tunedModel:void 0!==r.name&&r.name.includes("/operations/")&&(n=r.name.split("/operations/")[0]),{name:n,state:I.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(e,["name"]);return null!=n&&te(r,["_url","name"],n),r}(e);return s=e7("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>nt(e))}{let t=function(e,t){let r={},n=tt(e,["name"]);return null!=n&&te(r,["_url","name"],n),r}(e);return s=e7("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>ne(e))}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(e,["config"]);return null!=n&&function(e,t,r){let n=tt(e,["pageSize"]);void 0!==t&&null!=n&&te(t,["_query","pageSize"],n);let i=tt(e,["pageToken"]);void 0!==t&&null!=i&&te(t,["_query","pageToken"],i);let s=tt(e,["filter"]);void 0!==t&&null!=s&&te(t,["_query","filter"],s)}(n,r),r}(e);return s=e7("tuningJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let r={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(r,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(r,["nextPageToken"],i);let s=tt(e,["tuningJobs"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>nt(e))),te(r,["tuningJobs"],e)}return r}(e),r=new ty;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=tt(e,["config"]);return null!=n&&function(e,t,r){let n=tt(e,["pageSize"]);void 0!==t&&null!=n&&te(t,["_query","pageSize"],n);let i=tt(e,["pageToken"]);void 0!==t&&null!=i&&te(t,["_query","pageToken"],i);let s=tt(e,["filter"]);void 0!==t&&null!=s&&te(t,["_query","filter"],s)}(n,r),r}(e);return s=e7("tunedModels",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let r={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(r,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(r,["nextPageToken"],i);let s=tt(e,["tunedModels"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>ne(e))),te(r,["tuningJobs"],e)}return r}(e),r=new ty;return Object.assign(r,t),r})}}async cancel(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=tt(e,["name"]);return null!=n&&te(r,["_url","name"],n),r}(e);return s=e7("{name}:cancel",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let r={},n=tt(e,["sdkHttpResponse"]);return null!=n&&te(r,["sdkHttpResponse"],n),r}(e),r=new tv;return Object.assign(r,t),r})}{let t=/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let r={},n=tt(e,["name"]);return null!=n&&te(r,["_url","name"],n),r}(e);return s=e7("{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let r={},n=tt(e,["sdkHttpResponse"]);return null!=n&&te(r,["sdkHttpResponse"],n),r}(e),r=new tv;return Object.assign(r,t),r})}}async tuneInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=tt(e,["baseModel"]);null!=n&&te(r,["baseModel"],n);let i=tt(e,["preTunedModel"]);null!=i&&te(r,["preTunedModel"],i);let s=tt(e,["trainingDataset"]);null!=s&&function(e,t,r){let n=tt(r,["config","method"]);if(void 0===n&&(n="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===n){let r=tt(e,["gcsUri"]);void 0!==t&&null!=r&&te(t,["supervisedTuningSpec","trainingDatasetUri"],r)}else if("PREFERENCE_TUNING"===n){let r=tt(e,["gcsUri"]);void 0!==t&&null!=r&&te(t,["preferenceOptimizationSpec","trainingDatasetUri"],r)}let i=tt(r,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let r=tt(e,["vertexDatasetResource"]);void 0!==t&&null!=r&&te(t,["supervisedTuningSpec","trainingDatasetUri"],r)}else if("PREFERENCE_TUNING"===i){let r=tt(e,["vertexDatasetResource"]);void 0!==t&&null!=r&&te(t,["preferenceOptimizationSpec","trainingDatasetUri"],r)}if(void 0!==tt(e,["examples"]))throw Error("examples parameter is not supported in Vertex AI.")}(s,r,t);let o=tt(e,["config"]);return null!=o&&function(e,t,r){let n=tt(r,["config","method"]);if(void 0===n&&(n="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===n){let r=tt(e,["validationDataset"]);void 0!==t&&null!=r&&te(t,["supervisedTuningSpec"],nr(r))}else if("PREFERENCE_TUNING"===n){let r=tt(e,["validationDataset"]);void 0!==t&&null!=r&&te(t,["preferenceOptimizationSpec"],nr(r))}let i=tt(e,["tunedModelDisplayName"]);void 0!==t&&null!=i&&te(t,["tunedModelDisplayName"],i);let s=tt(e,["description"]);void 0!==t&&null!=s&&te(t,["description"],s);let o=tt(r,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){let r=tt(e,["epochCount"]);void 0!==t&&null!=r&&te(t,["supervisedTuningSpec","hyperParameters","epochCount"],r)}else if("PREFERENCE_TUNING"===o){let r=tt(e,["epochCount"]);void 0!==t&&null!=r&&te(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],r)}let a=tt(r,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){let r=tt(e,["learningRateMultiplier"]);void 0!==t&&null!=r&&te(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],r)}else if("PREFERENCE_TUNING"===a){let r=tt(e,["learningRateMultiplier"]);void 0!==t&&null!=r&&te(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],r)}let l=tt(r,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){let r=tt(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=r&&te(t,["supervisedTuningSpec","exportLastCheckpointOnly"],r)}else if("PREFERENCE_TUNING"===l){let r=tt(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=r&&te(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],r)}let u=tt(r,["config","method"]);if(void 0===u&&(u="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===u){let r=tt(e,["adapterSize"]);void 0!==t&&null!=r&&te(t,["supervisedTuningSpec","hyperParameters","adapterSize"],r)}else if("PREFERENCE_TUNING"===u){let r=tt(e,["adapterSize"]);void 0!==t&&null!=r&&te(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],r)}if(void 0!==tt(e,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==tt(e,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let c=tt(e,["labels"]);void 0!==t&&null!=c&&te(t,["labels"],c);let d=tt(e,["beta"]);void 0!==t&&null!=d&&te(t,["preferenceOptimizationSpec","hyperParameters","beta"],d)}(o,r,t),r}(e,e);return n=e7("tuningJobs",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>nt(e))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let r={},n=tt(e,["baseModel"]);null!=n&&te(r,["baseModel"],n);let i=tt(e,["preTunedModel"]);null!=i&&te(r,["preTunedModel"],i);let s=tt(e,["trainingDataset"]);null!=s&&function(e,t){if(void 0!==tt(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==tt(e,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let r=tt(e,["examples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),te({},["examples","examples"],e)}}(s);let o=tt(e,["config"]);return null!=o&&function(e,t,r){if(void 0!==tt(e,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let n=tt(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=n&&te(t,["displayName"],n),void 0!==tt(e,["description"]))throw Error("description parameter is not supported in Gemini API.");let i=tt(e,["epochCount"]);void 0!==t&&null!=i&&te(t,["tuningTask","hyperparameters","epochCount"],i);let s=tt(e,["learningRateMultiplier"]);if(null!=s&&te({},["tuningTask","hyperparameters","learningRateMultiplier"],s),void 0!==tt(e,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==tt(e,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==tt(e,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let o=tt(e,["batchSize"]);void 0!==t&&null!=o&&te(t,["tuningTask","hyperparameters","batchSize"],o);let a=tt(e,["learningRate"]);if(void 0!==t&&null!=a&&te(t,["tuningTask","hyperparameters","learningRate"],a),void 0!==tt(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");if(void 0!==tt(e,["beta"]))throw Error("beta parameter is not supported in Gemini API.")}(o,r),r}(e);return n=e7("tunedModels",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e,t){let r={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(r,["sdkHttpResponse"],n);let i=tt(e,["name"]);null!=i&&te(r,["name"],i);let s=tt(e,["metadata"]);null!=s&&te(r,["metadata"],s);let o=tt(e,["done"]);null!=o&&te(r,["done"],o);let a=tt(e,["error"]);return null!=a&&te(r,["error"],a),r})(e))}}}let ni="x-goog-upload-status";async function ns(e,t,r){var n;let i=await na(e,t,r),s=await (null==i?void 0:i.json());if((null===(n=null==i?void 0:i.headers)||void 0===n?void 0:n[ni])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return s.file}async function no(e,t,r){var n;let i=await na(e,t,r),s=await (null==i?void 0:i.json());if((null===(n=null==i?void 0:i.headers)||void 0===n?void 0:n[ni])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let o=tn(s),a=new tk;return Object.assign(a,o),a}async function na(e,t,r){var n,i;let s=0,o=0,a=new ti(new Response),l="upload";for(s=e.size;o<s;){let u=Math.min(8388608,s-o),c=e.slice(o,o+u);o+u>=s&&(l+=", finalize");let d=0,p=1e3;for(;d<3&&(null===(n=null==(a=await r.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}))?void 0:a.headers)||void 0===n||!n[ni]);)d++,await nu(p),p*=2;if(o+=u,(null===(i=null==a?void 0:a.headers)||void 0===i?void 0:i[ni])!=="active")break;if(s<=o)throw Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function nl(e){return{size:e.size,type:e.type}}function nu(e){return new Promise(t=>setTimeout(t,e))}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nc{async stat(e){let t={size:0,type:void 0};if("string"!=typeof e)return await nl(e);{let r=await e5.stat(e);return t.size=r.size,t.type=this.inferMimeType(e),t}}async upload(e,t,r){return"string"==typeof e?await this.uploadFileFromPath(e,t,r):ns(e,t,r)}async uploadToFileSearchStore(e,t,r){return"string"==typeof e?await this.uploadFileToFileSearchStoreFromPath(e,t,r):no(e,t,r)}inferMimeType(e){return({aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz+xml",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"})[e.slice(e.lastIndexOf(".")+1).toLowerCase()]}async uploadFileFromPath(e,t,r){var n;let i=await this.uploadFileFromPathInternal(e,t,r),s=await (null==i?void 0:i.json());if((null===(n=null==i?void 0:i.headers)||void 0===n?void 0:n[ni])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return s.file}async uploadFileToFileSearchStoreFromPath(e,t,r){var n;let i=await this.uploadFileFromPathInternal(e,t,r),s=await (null==i?void 0:i.json());if((null===(n=null==i?void 0:i.headers)||void 0===n?void 0:n[ni])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let o=tn(s),a=new tk;return Object.assign(a,o),a}async uploadFileFromPathInternal(e,t,r){var n,i;let s;let o=0,a=0,l=new ti(new Response),u="upload",c=e8.basename(e);try{if(!(s=await e5.open(e,"r")))throw Error("Failed to open file");for(o=(await s.stat()).size;a<o;){let e=Math.min(8388608,o-a);a+e>=o&&(u+=", finalize");let d=new Uint8Array(e),{bytesRead:p}=await s.read(d,0,e,a);if(p!==e)throw Error(`Failed to read ${e} bytes from file at offset ${a}. bytes actually read: ${p}`);let h=new Blob([d]),f=0,m=1e3;for(;f<3&&(l=await r.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p),"X-Goog-Upload-File-Name":c}}}),null===(n=null==l?void 0:l.headers)||void 0===n||!n[ni]);)f++,await nu(m),m*=2;if(a+=p,(null===(i=null==l?void 0:l.headers)||void 0===i?void 0:i[ni])!=="active")break;if(o<=a)throw Error("All content has been uploaded, but the upload status is not finalized.")}return l}finally{s&&await s.close()}}}class nd{constructor(e){var t,r,s,o,a,l;if((e.project||e.location)&&e.apiKey)throw Error("Project/location and API key are mutually exclusive in the client initializer.");this.vertexai=null!==(r=null!==(t=e.vertexai)&&void 0!==t?t:function(e){var t;return void 0!==(t=np(e))&&"true"===t.toLowerCase()}("GOOGLE_GENAI_USE_VERTEXAI"))&&void 0!==r&&r;let u=function(){let e=np("GOOGLE_API_KEY"),t=np("GEMINI_API_KEY");return e&&t&&console.warn("Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY."),e||t||void 0}(),c=np("GOOGLE_CLOUD_PROJECT"),d=np("GOOGLE_CLOUD_LOCATION");this.apiKey=null!==(s=e.apiKey)&&void 0!==s?s:u,this.project=null!==(o=e.project)&&void 0!==o?o:c,this.location=null!==(a=e.location)&&void 0!==a?a:d,!e.vertexai||((null===(l=e.googleAuthOptions)||void 0===l?void 0:l.credentials)&&(console.debug("The user provided Google Cloud credentials will take precedence over the API key from the environment variable."),this.apiKey=void 0),(c||d)&&e.apiKey?(console.debug("The user provided Vertex AI API key will take precedence over the project/location from the environment variables."),this.project=void 0,this.location=void 0):(e.project||e.location)&&u?(console.debug("The user provided project/location will take precedence over the API key from the environment variables."),this.apiKey=void 0):(c||d)&&u&&(console.debug("The project/location from the environment variables will take precedence over the API key from the environment variables."),this.apiKey=void 0),this.location||this.apiKey||(this.location="global"));let p=function(e,t,r,s){var o,a;if(!(null==e?void 0:e.baseUrl)){let e={geminiUrl:n,vertexUrl:i};return t?null!==(o=e.vertexUrl)&&void 0!==o?o:r:null!==(a=e.geminiUrl)&&void 0!==a?a:s}return e.baseUrl}(e.httpOptions,e.vertexai,np("GOOGLE_VERTEX_BASE_URL"),np("GOOGLE_GEMINI_BASE_URL"));p&&(e.httpOptions?e.httpOptions.baseUrl=p:e.httpOptions={baseUrl:p}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;let h=new r3({apiKey:this.apiKey,googleAuthOptions:e.googleAuthOptions});this.apiClient=new rU({auth:h,project:this.project,location:this.location,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/"+process.version,uploader:new nc,downloader:new r6}),this.models=new rQ(this.apiClient),this.live=new r$(this.apiClient,h,new r9),this.batches=new rn(this.apiClient),this.chats=new rd(this.models,this.apiClient),this.caches=new rs(this.apiClient),this.files=new rf(this.apiClient),this.operations=new rZ(this.apiClient),this.authTokens=new r0(this.apiClient),this.tunings=new nn(this.apiClient),this.fileSearchStores=new r2(this.apiClient)}}function np(e){var t,r,n;return null!==(n=null===(r=null===(t=null==process?void 0:process.env)||void 0===t?void 0:t[e])||void 0===r?void 0:r.trim())&&void 0!==n?n:void 0}let nh="AIzaSyDZo1FdDD33vhNdIP0RlNKCo2nCFk9ua3I";if(!nh)throw Error("Missing GEMINI_API_KEY. Set it in .env.local");let nf=new nd({apiKey:nh}),nm="gemini-2.5-flash",ng=e=>0===e.length?"No specific study materials provided.":e.map(e=>`--- SOURCE: ${e.title} ---
${e.content}
`).join("\n").slice(0,1e5),ny=async(e,t=5)=>{let r=ng(e),n=`
    You are an expert curriculum designer. 
    Create a ${t}-day study plan based strictly on the provided learning materials.
    The plan should be logical, progressive, and cover key concepts found in the source text.
  `,i={type:c.ARRAY,items:{type:c.OBJECT,properties:{day:{type:c.INTEGER},topic:{type:c.STRING},focusArea:{type:c.STRING},activities:{type:c.ARRAY,items:{type:c.STRING}}},required:["day","topic","focusArea","activities"]}};try{let e=(await nf.models.generateContent({model:nm,contents:[{role:"user",parts:[{text:`CONTEXT MATERIALS:
${r}`}]},{role:"user",parts:[{text:n}]}],config:{responseMimeType:"application/json",responseSchema:i,systemInstruction:"You are a helpful study planner."}})).text||"[]";return JSON.parse(e)}catch(e){throw console.error("Error generating study plan:",e),Error("Failed to generate study plan.")}},nv=async(e,t)=>{let r=ng(e),n=t?`Focus specifically on the topic: "${t}".`:"Cover a mix of important topics from the material.",i=`
    Generate 5 multiple-choice questions based on the provided study materials.
    ${n}
    Ensure the questions test understanding, not just memorization.
    Provide 4 options per question.
  `,s={type:c.ARRAY,items:{type:c.OBJECT,properties:{id:{type:c.INTEGER},question:{type:c.STRING},options:{type:c.ARRAY,items:{type:c.STRING}},correctAnswerIndex:{type:c.INTEGER,description:"Index (0-3) of the correct answer"},explanation:{type:c.STRING,description:"Why this answer is correct"}},required:["id","question","options","correctAnswerIndex","explanation"]}};try{let e=(await nf.models.generateContent({model:nm,contents:[{role:"user",parts:[{text:`CONTEXT MATERIALS:
${r}`}]},{role:"user",parts:[{text:i}]}],config:{responseMimeType:"application/json",responseSchema:s}})).text||"[]";return JSON.parse(e)}catch(e){throw console.error("Error generating quiz:",e),Error("Failed to generate quiz.")}},n_=async(e,t,r,n)=>{let i=ng(t),o="";switch(r){case s.SIMPLE:o="Explain simply and clearly, avoiding jargon where possible. Explain it like I'm 12.";break;case s.DETAILED:o="Provide a comprehensive, academic explanation with technical details and nuance.";break;case s.ANALOGY:o="Use real-world analogies and metaphors to explain the concepts.";break;case s.SOCHRATIC:o="Don't give the answer directly. Ask guiding questions to help the user derive the answer. Be a tutor."}let a=`
    You are MindMate, an AI study buddy. 
    Use the provided CONTEXT MATERIALS to answer questions.
    If the answer isn't in the materials, use your general knowledge but mention that it wasn't in the notes.
    Adopt the following teaching style: ${o}
  `;try{let t=[{role:"user",parts:[{text:`CONTEXT MATERIALS (Use this as your primary knowledge base):
${i}`}]},...n,{role:"user",parts:[{text:e}]}];return(await nf.models.generateContent({model:"gemini-2.5-flash",contents:t,config:{systemInstruction:a}})).text||"I couldn't generate an explanation at this time."}catch(e){return console.error("Error explaining topic:",e),"Sorry, I encountered an error while processing your request."}},nb=({materials:e,existingPlan:t,onSetPlan:r})=>{let[n,i]=(0,ec.useState)(!1),[s,o]=(0,ec.useState)(null),a=async()=>{if(0===e.length){o("Please add study materials first.");return}i(!0),o(null);try{let t=await ny(e);r(t)}catch(e){o("Failed to generate plan. Please try again.")}finally{i(!1)}};return(0,eu.jsxs)("div",{className:"relative mx-auto max-w-5xl space-y-12 pb-20 pt-2 animate-fadeIn",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[eu.jsx("div",{className:"absolute -top-24 left-[5%] h-64 w-64 rounded-full bg-violet-600/25 blur-3xl"}),eu.jsx("div",{className:"absolute top-[40%] right-[-10%] h-72 w-72 rounded-full bg-indigo-500/25 blur-[110px]"}),eu.jsx("div",{className:"absolute bottom-[-20%] left-[30%] h-72 w-72 rounded-full bg-cyan-400/20 blur-[110px]"})]}),(0,eu.jsxs)("div",{className:"flex flex-col justify-between gap-8 border-b border-white/8 pb-8 md:flex-row md:items-center",children:[(0,eu.jsxs)("div",{className:"space-y-2",children:[(0,eu.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-violet-500/30 bg-violet-500/10 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-violet-200",children:[eu.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-violet-300 shadow-[0_0_10px_rgba(196,181,253,0.9)]"}),"Smart Roadmap"]}),eu.jsx("h2",{className:"text-4xl font-extrabold tracking-tight text-white",children:eu.jsx("span",{className:"bg-gradient-to-r from-violet-300 via-indigo-300 to-cyan-300 bg-clip-text text-transparent",children:"Roadmap"})}),eu.jsx("p",{className:"text-sm text-slate-400",children:"An AI-crafted, day-by-day path from where you are to where you want to be."})]}),eu.jsx("button",{onClick:a,disabled:n||0===e.length,className:`
            inline-flex items-center justify-center gap-3 rounded-full px-8 py-3.5 text-sm font-bold text-white
            transition-all duration-300 transform
            ${n?"bg-slate-900/80 cursor-wait border border-slate-700/60":"bg-gradient-to-r from-violet-600 via-indigo-600 to-cyan-500 shadow-[0_18px_50px_rgba(79,70,229,0.75)] hover:scale-105 hover:shadow-[0_24px_70px_rgba(56,189,248,0.8)]"}
            ${0===e.length?"opacity-50 cursor-not-allowed grayscale":""}
          `,children:n?(0,eu.jsxs)(eu.Fragment,{children:[eu.jsx(eX,{className:"h-5 w-5 animate-spin"}),eu.jsx("span",{children:"Constructing Plan..."})]}):(0,eu.jsxs)(eu.Fragment,{children:[eu.jsx(eO,{className:"h-5 w-5 fill-current"}),eu.jsx("span",{children:t.length>0?"Regenerate Path":"Generate Roadmap"})]})})]}),s&&(0,eu.jsxs)("div",{className:"flex items-center gap-3 rounded-2xl border border-red-500/30 bg-red-500/10 p-4 text-sm text-red-200 shadow-[0_16px_40px_rgba(127,29,29,0.5)]",children:[eu.jsx(eQ,{className:"h-5 w-5"}),eu.jsx("span",{children:s})]}),0===t.length&&!n&&(0,eu.jsxs)("div",{className:"flex flex-col items-center justify-center px-4 py-20 text-center",children:[(0,eu.jsxs)("div",{className:"group relative mb-8",children:[eu.jsx("div",{className:"absolute inset-0 rounded-full bg-violet-600/25 blur-[60px] opacity-30 group-hover:opacity-40 transition-opacity"}),eu.jsx("div",{className:"relative flex h-28 w-28 rotate-3 items-center justify-center rounded-[2rem] border border-white/10 bg-slate-950/90 shadow-[0_20px_60px_rgba(15,23,42,0.95)] group-hover:rotate-6 transition-transform duration-500",children:eu.jsx(eZ,{className:"h-12 w-12 text-violet-400"})})]}),eu.jsx("h3",{className:"mb-3 text-3xl font-bold tracking-tight text-white",children:"No Active Plan"}),eu.jsx("p",{className:"max-w-lg text-base leading-relaxed text-slate-400",children:"Upload your materials and let the AI break them into a focused, day-by-day roadmap that balances revision, concepts, and problem practice."})]}),n&&eu.jsx("div",{className:"space-y-10 pl-3 md:pl-0 animate-pulse",children:[1,2,3].map(e=>(0,eu.jsxs)("div",{className:"flex gap-7 md:gap-10",children:[(0,eu.jsxs)("div",{className:"relative flex flex-shrink-0 flex-col items-center",children:[eu.jsx("div",{className:"h-11 w-11 rounded-full border border-slate-700 bg-slate-900"}),eu.jsx("div",{className:"absolute top-11 bottom-0 w-0.5 bg-slate-800"})]}),eu.jsx("div",{className:"h-44 flex-1 rounded-[2rem] border border-white/8 bg-slate-950/70"})]},e))}),!n&&t.length>0&&eu.jsx("div",{className:"relative space-y-0",children:t.map((e,r)=>{let n=0===r,i=r===t.length-1;return(0,eu.jsxs)("div",{className:"group relative flex gap-6 md:gap-10",style:{animationDelay:`${120*r}ms`},children:[(0,eu.jsxs)("div",{className:"relative flex flex-shrink-0 flex-col items-center",children:[eu.jsx("div",{className:`
                      z-10 flex h-12 w-12 items-center justify-center rounded-full border-2 text-lg font-bold shadow-[0_0_18px_rgba(15,23,42,0.9)]
                      transition-all duration-300
                      ${n?"scale-110 bg-gradient-to-br from-violet-600 via-indigo-600 to-cyan-500 border-violet-300 text-white shadow-[0_0_40px_rgba(129,140,248,0.9)]":"bg-[#020617]/95 border-slate-800 text-slate-500 group-hover:border-violet-500 group-hover:text-violet-300"}
                    `,children:e.day}),!i&&eu.jsx("div",{className:"absolute top-12 bottom-0 w-0.5 bg-slate-800 transition-colors group-hover:bg-slate-700"})]}),eu.jsx("div",{className:"flex-1 pb-14",children:(0,eu.jsxs)("div",{className:`
                      relative overflow-hidden rounded-[2.1rem] border p-7 md:p-9 transition-all duration-300 group/card
                      ${n?"border-violet-500/40 bg-gradient-to-br from-slate-900 via-slate-950 to-slate-950 shadow-[0_24px_65px_rgba(79,70,229,0.7)]":"border-white/8 bg-slate-950/70 hover:border-white/15 hover:bg-slate-950/85 shadow-[0_18px_55px_rgba(15,23,42,0.95)]"}
                    `,children:[n&&eu.jsx("div",{className:"pointer-events-none absolute -right-16 -top-20 h-64 w-64 rounded-full bg-violet-500/20 blur-[100px]"}),(0,eu.jsxs)("div",{className:"relative mb-7 flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[(0,eu.jsxs)("div",{children:[(0,eu.jsxs)("div",{className:"mb-3 flex items-center gap-3",children:[eu.jsx("span",{className:`text-[11px] font-bold uppercase tracking-[0.18em] ${n?"text-violet-300":"text-slate-500"}`,children:n?"Current Focus":"Upcoming"}),n&&eu.jsx("span",{className:"h-2 w-2 animate-pulse rounded-full bg-violet-400 shadow-[0_0_12px_rgba(167,139,250,0.9)]"})]}),eu.jsx("h3",{className:"mb-2 text-2xl md:text-3xl font-bold tracking-tight text-white",children:e.topic}),(0,eu.jsxs)("div",{className:"flex items-center text-xs font-medium text-slate-400",children:[eu.jsx(e0,{className:"mr-2 h-4 w-4"}),"~2 Hours Est."]})]}),eu.jsx("span",{className:"self-start rounded-xl border border-white/15 bg-white/5 px-4 py-2 text-[11px] font-bold uppercase tracking-[0.18em] text-slate-200 backdrop-blur-md",children:e.focusArea})]}),(0,eu.jsxs)("div",{className:"relative z-10 space-y-4",children:[eu.jsx("div",{className:"mb-5 h-px w-full bg-gradient-to-r from-transparent via-white/10 to-transparent"}),eu.jsx("ul",{className:"grid gap-3.5",children:e.activities.map((e,t)=>(0,eu.jsxs)("li",{className:"flex items-start gap-4 rounded-2xl px-3 py-2.5 transition-colors duration-200 hover:bg-white/5",children:[eu.jsx("div",{className:"mt-[3px] flex-shrink-0",children:eu.jsx(eL,{className:`h-5 w-5 ${n?"text-violet-400":"text-slate-700 group-hover/card:text-slate-500"}`})}),eu.jsx("span",{className:"text-sm font-medium leading-relaxed text-slate-200",children:e})]},t))})]})]})})]},r)})})]})},nE=e_("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),nx=e_("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),nw=({materials:e})=>{let[t,r]=(0,ec.useState)([]),[n,i]=(0,ec.useState)(0),[s,o]=(0,ec.useState)(null),[a,l]=(0,ec.useState)(!1),[u,c]=(0,ec.useState)(0),[d,p]=(0,ec.useState)(!1),[h,f]=(0,ec.useState)(!1),m=async()=>{if(0!==e.length){p(!0);try{let t=await nv(e);r(t),i(0),c(0),f(!1),o(null),l(!1)}catch(e){console.error(e)}finally{p(!1)}}},g=e=>{null===s&&(o(e),l(!0),e===t[n].correctAnswerIndex&&c(e=>e+1))};if(d)return(0,eu.jsxs)("div",{className:"relative flex min-h-[60vh] flex-col items-center justify-center overflow-hidden px-6 animate-fadeIn",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[eu.jsx("div",{className:"absolute -top-24 left-[10%] h-64 w-64 rounded-full bg-violet-600/30 blur-3xl"}),eu.jsx("div",{className:"absolute bottom-[-20%] right-[5%] h-72 w-72 rounded-full bg-indigo-500/25 blur-[110px]"})]}),(0,eu.jsxs)("div",{className:"relative mb-10",children:[eu.jsx("div",{className:"absolute inset-0 rounded-full bg-violet-500/40 blur-[50px] opacity-60 animate-pulse"}),eu.jsx("div",{className:"relative flex h-24 w-24 items-center justify-center rounded-full border border-violet-500/40 bg-slate-950 shadow-[0_20px_60px_rgba(79,70,229,0.8)]",children:eu.jsx(eX,{className:"h-10 w-10 animate-spin text-violet-300"})})]}),eu.jsx("h3",{className:"mb-2 text-3xl md:text-4xl font-bold tracking-tight text-white",children:"Generating Quiz"}),eu.jsx("p",{className:"text-base md:text-lg text-slate-400",children:"Synthesizing questions from your library in real time..."})]});if(0===t.length){let t=0===e.length;return(0,eu.jsxs)("div",{className:"relative flex min-h-[60vh] flex-col items-center justify-center overflow-hidden px-6 text-center animate-fadeIn",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[eu.jsx("div",{className:"absolute -top-24 left-[15%] h-72 w-72 rounded-full bg-violet-600/25 blur-[100px]"}),eu.jsx("div",{className:"absolute bottom-[-20%] right-[10%] h-72 w-72 rounded-full bg-indigo-500/25 blur-[110px]"})]}),(0,eu.jsxs)("div",{className:"group relative mb-12 cursor-default",children:[eu.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-violet-500 via-indigo-500 to-cyan-500 blur-[100px] opacity-25 transition-opacity duration-700 group-hover:opacity-35"}),eu.jsx("div",{className:"relative rounded-[3rem] border border-white/10 bg-slate-950/80 p-14 shadow-[0_26px_80px_rgba(15,23,42,0.98)] backdrop-blur-2xl transition-transform duration-500 group-hover:scale-105",children:eu.jsx(ew,{className:"h-24 w-24 text-white drop-shadow-[0_0_35px_rgba(255,255,255,0.5)]"})})]}),(0,eu.jsxs)("div",{className:"mb-3 inline-flex items-center gap-2 rounded-full border border-violet-500/40 bg-violet-500/15 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-violet-200",children:[eu.jsx(eO,{className:"h-3.5 w-3.5 text-amber-300"}),"Active Recall Engine"]}),eu.jsx("h2",{className:"mb-4 text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-tight",children:eu.jsx("span",{className:"bg-gradient-to-r from-violet-200 via-white to-cyan-200 bg-clip-text text-transparent",children:"Active Recall"})}),eu.jsx("p",{className:"mb-10 max-w-xl text-base md:text-lg leading-relaxed text-slate-400 font-light",children:"Transform passive reading into sharp, targeted practice. Generate an instant quiz tailored to your exact notes and materials."}),(0,eu.jsxs)("button",{onClick:m,disabled:t,className:`
            group relative overflow-hidden rounded-full px-12 py-4 text-lg font-bold
            transition-all duration-300 shadow-[0_0_40px_rgba(255,255,255,0.25)]
            ${t?"cursor-not-allowed opacity-60 shadow-none":"hover:scale-105"}
            bg-white text-slate-950
          `,children:[(0,eu.jsxs)("span",{className:"relative z-10 flex items-center gap-3",children:[t?"Add Materials First":"Start Session",!t&&eu.jsx(nE,{className:"h-5 w-5 fill-current"})]}),eu.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-200 via-indigo-200 to-cyan-200 opacity-0 transition-opacity duration-300 group-hover:opacity-100"})]})]})}if(h){let e=Math.round(u/t.length*100);return(0,eu.jsxs)("div",{className:"relative mx-auto max-w-3xl pt-10 animate-fadeIn",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[eu.jsx("div",{className:"absolute -top-28 left-[10%] h-72 w-72 rounded-full bg-violet-600/25 blur-[110px]"}),eu.jsx("div",{className:"absolute bottom-[-25%] right-[5%] h-80 w-80 rounded-full bg-amber-400/25 blur-[110px]"})]}),(0,eu.jsxs)("div",{className:"relative overflow-hidden rounded-[3rem] border border-white/12 bg-slate-950/90 p-10 md:p-16 shadow-[0_30px_90px_rgba(15,23,42,0.98)] backdrop-blur-2xl",children:[eu.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-violet-500 via-white to-amber-400 opacity-70"}),eu.jsx("div",{className:"pointer-events-none absolute left-1/2 top-1/2 h-[600px] w-[600px] -translate-x-1/2 -translate-y-1/2 rounded-full bg-violet-500/15 blur-[130px]"}),(0,eu.jsxs)("div",{className:"relative z-10 text-center",children:[eu.jsx("div",{className:"mx-auto mb-10 flex h-28 w-28 rotate-3 items-center justify-center rounded-[2rem] bg-gradient-to-br from-amber-400 to-rose-500 shadow-[0_22px_60px_rgba(251,191,36,0.7)] transition-transform hover:rotate-6",children:eu.jsx(eq,{className:"h-14 w-14 text-white"})}),eu.jsx("h2",{className:"mb-2 text-4xl md:text-5xl font-bold tracking-tight text-white",children:"Session Complete"}),eu.jsx("p",{className:"mb-10 text-base md:text-lg text-slate-400",children:"Heres how your recall stacked up."}),(0,eu.jsxs)("div",{className:"mx-auto mb-12 grid max-w-lg grid-cols-2 gap-5 text-left",children:[(0,eu.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-slate-950/90 p-7 backdrop-blur",children:[eu.jsx("div",{className:"mb-1 text-xs font-bold uppercase tracking-[0.18em] text-slate-500",children:"Accuracy"}),(0,eu.jsxs)("div",{className:"text-5xl md:text-6xl font-black text-white",children:[e,"%"]})]}),(0,eu.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-slate-950/90 p-7 backdrop-blur",children:[eu.jsx("div",{className:"mb-1 text-xs font-bold uppercase tracking-[0.18em] text-slate-500",children:"Score"}),(0,eu.jsxs)("div",{className:"text-5xl md:text-6xl font-black text-violet-400",children:[u,"/",t.length]})]})]}),(0,eu.jsxs)("button",{onClick:m,className:"inline-flex items-center gap-3 rounded-full bg-white px-11 py-4 text-sm md:text-base font-bold text-slate-950 shadow-[0_20px_60px_rgba(148,163,184,0.9)] transition-all hover:bg-slate-100 hover:scale-105",children:[eu.jsx(eX,{className:"h-5 w-5"}),"Start New Quiz"]})]})]})]})}let y=t[n];return(0,eu.jsxs)("div",{className:"relative mx-auto max-w-4xl space-y-8 pt-4 animate-fadeIn",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[eu.jsx("div",{className:"absolute -top-24 left-[10%] h-72 w-72 rounded-full bg-violet-600/25 blur-[110px]"}),eu.jsx("div",{className:"absolute bottom-[-25%] right-[10%] h-80 w-80 rounded-full bg-indigo-500/25 blur-[120px]"})]}),(0,eu.jsxs)("div",{className:"flex items-center justify-between px-4",children:[(0,eu.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,eu.jsxs)("span",{className:"text-[11px] font-bold uppercase tracking-[0.2em] text-slate-500",children:["Question ",n+1," of ",t.length]}),(0,eu.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-violet-500/35 bg-violet-500/10 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-violet-200",children:[eu.jsx(ew,{className:"h-3.5 w-3.5"}),"Active Recall"]})]}),(0,eu.jsxs)("div",{className:"flex items-center gap-2 rounded-full border border-white/10 bg-slate-950/80 px-4 py-2 text-xs font-bold text-slate-100 shadow-[0_12px_35px_rgba(15,23,42,0.9)]",children:[eu.jsx(eO,{className:"h-4 w-4 text-yellow-400 fill-current"}),(0,eu.jsxs)("span",{children:["Score: ",u]})]})]}),eu.jsx("div",{className:"mx-4 max-w-[calc(100%-2rem)] overflow-hidden rounded-full border border-white/10 bg-slate-950/80",children:eu.jsx("div",{className:"h-2 rounded-full bg-gradient-to-r from-violet-500 via-indigo-500 to-cyan-400 shadow-[0_0_16px_rgba(129,140,248,0.8)] transition-all duration-500 ease-out",style:{width:`${(n+1)/t.length*100}%`}})}),(0,eu.jsxs)("div",{className:"relative min-h-[480px] overflow-hidden rounded-[3rem] border border-white/12 bg-slate-950/85 shadow-[0_26px_80px_rgba(15,23,42,0.98)] backdrop-blur-2xl",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[eu.jsx("div",{className:"absolute -top-32 right-[-10%] h-72 w-72 rounded-full bg-violet-500/20 blur-[120px]"}),eu.jsx("div",{className:"absolute bottom-[-30%] left-[5%] h-80 w-80 rounded-full bg-indigo-500/20 blur-[130px]"})]}),(0,eu.jsxs)("div",{className:"relative z-10 flex flex-1 flex-col p-8 md:p-12 lg:p-14",children:[eu.jsx("h3",{className:"mb-10 text-2xl md:text-3xl lg:text-4xl font-bold leading-tight text-white",children:y.question}),eu.jsx("div",{className:"mt-auto grid grid-cols-1 gap-4",children:y.options.map((e,t)=>{let r=s===t,n=t===y.correctAnswerIndex,i="border-white/8 bg-slate-950/70 text-slate-200 hover:bg-slate-900 hover:border-white/20 hover:-translate-y-0.5 hover:shadow-[0_18px_45px_rgba(15,23,42,0.9)]";return null!==s&&(i=n?"bg-emerald-500/15 border-emerald-400/70 text-emerald-100 shadow-[0_0_22px_rgba(16,185,129,0.45)]":r?"bg-red-500/15 border-red-400/70 text-red-100 shadow-[0_0_20px_rgba(248,113,113,0.4)]":"pointer-events-none border-transparent bg-slate-900/60 text-slate-500 opacity-30"),(0,eu.jsxs)("button",{onClick:()=>g(t),disabled:null!==s,className:`
                    group flex w-full items-center justify-between rounded-2xl border-2 px-5 py-5 text-left text-base md:text-lg lg:text-xl font-medium
                    transition-all duration-200
                    ${i}
                  `,children:[eu.jsx("span",{className:"pr-4",children:e}),null!==s&&n&&eu.jsx(nx,{className:"h-6 w-6 flex-shrink-0 text-emerald-400"}),null!==s&&r&&!n&&eu.jsx(eS,{className:"h-6 w-6 flex-shrink-0 text-red-400"})]},t)})})]}),a&&(0,eu.jsxs)("div",{className:"relative z-20 border-t border-white/12 bg-slate-950/90 px-8 py-7 md:px-12 md:py-9",children:[(0,eu.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[eu.jsx("span",{className:"h-2 w-2 animate-pulse rounded-full bg-violet-400 shadow-[0_0_10px_rgba(167,139,250,0.9)]"}),eu.jsx("span",{className:"text-[11px] font-bold uppercase tracking-[0.18em] text-violet-300",children:"Explanation"})]}),(0,eu.jsxs)("div",{className:"flex flex-col items-start justify-between gap-6 md:flex-row md:items-center",children:[eu.jsx("p",{className:"flex-1 text-sm md:text-base leading-relaxed text-slate-200",children:y.explanation}),(0,eu.jsxs)("button",{onClick:()=>{n<t.length-1?(i(e=>e+1),o(null),l(!1)):f(!0)},className:"inline-flex flex-shrink-0 items-center gap-3 rounded-full bg-white px-8 py-3 text-sm md:text-base font-bold text-slate-950 shadow-[0_18px_50px_rgba(148,163,184,0.9)] transition-all hover:scale-105 hover:bg-slate-100",children:[eu.jsx("span",{children:n===t.length-1?"Finish":"Next Question"}),eu.jsx(eU,{className:"h-5 w-5"})]})]})]})]})]})},nA=e_("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),nT=e_("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),nS=e_("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),nC=({materials:e,preferences:t,onUpdateStyle:r})=>{let[n,i]=(0,ec.useState)([{id:"intro",role:"model",content:"Hey, I'm your AI Tutor. Ill adapt to your notes and learning style.\n\nAsk me to explain a concept, summarize a topic, or quiz you on what youve learned.",timestamp:Date.now()}]),[o,a]=(0,ec.useState)(""),[l,u]=(0,ec.useState)(!1),c=(0,ec.useRef)(null),d=()=>{c.current?.scrollIntoView({behavior:"smooth"})};(0,ec.useEffect)(()=>{d()},[n,l]);let p=async r=>{if(r.preventDefault(),!o.trim()||l)return;let s={id:Date.now().toString(),role:"user",content:o,timestamp:Date.now()};i(e=>[...e,s]),a(""),u(!0);let c=n.map(e=>({role:e.role,parts:[{text:e.content}]}));try{let r=await n_(s.content,e,t.learningStyle,c),n={id:(Date.now()+1).toString(),role:"model",content:r,timestamp:Date.now()};i(e=>[...e,n])}catch(e){console.error(e)}finally{u(!1)}};return(0,eu.jsxs)("div",{className:"relative mx-auto flex h-[calc(100vh-6rem)] max-w-5xl flex-col overflow-hidden rounded-[2.5rem] border border-white/12 bg-slate-950/85 shadow-[0_28px_90px_rgba(15,23,42,0.98)] backdrop-blur-2xl md:h-[calc(100vh-4rem)] animate-fadeIn",children:[(0,eu.jsxs)("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[eu.jsx("div",{className:"absolute -top-32 left-[5%] h-72 w-72 rounded-full bg-violet-600/25 blur-[120px]"}),eu.jsx("div",{className:"absolute top-[45%] right-[-10%] h-80 w-80 rounded-full bg-indigo-500/25 blur-[130px]"}),eu.jsx("div",{className:"absolute bottom-[-25%] left-[30%] h-80 w-80 rounded-full bg-cyan-400/20 blur-[120px]"})]}),(0,eu.jsxs)("div",{className:"absolute inset-x-0 top-0 z-30 flex h-24 items-center justify-between border-b border-white/10 bg-slate-950/90 px-6 md:px-8 backdrop-blur-2xl",children:[(0,eu.jsxs)("div",{className:"flex items-center gap-4",children:[(0,eu.jsxs)("div",{className:"relative",children:[eu.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-gradient-to-br from-violet-500 via-indigo-500 to-cyan-400 shadow-[0_18px_50px_rgba(79,70,229,0.8)] ring-2 ring-white/15",children:eu.jsx(nA,{className:"h-7 w-7 text-white"})}),eu.jsx("div",{className:"absolute -bottom-1 -right-1 h-4 w-4 rounded-full border-4 border-slate-950 bg-emerald-400 shadow-[0_0_16px_rgba(52,211,153,0.95)]"})]}),(0,eu.jsxs)("div",{className:"flex flex-col gap-1",children:[eu.jsx("h3",{className:"text-base font-bold leading-none text-white md:text-lg",children:"AI Tutor"}),(0,eu.jsxs)("div",{className:"inline-flex items-center gap-2",children:[eu.jsx("span",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-400",children:"Context aware"}),eu.jsx("span",{className:"h-1 w-1 rounded-full bg-slate-500"}),eu.jsx("span",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-slate-400",children:"Personalized"})]})]})]}),eu.jsx("div",{className:"flex items-center gap-4",children:(0,eu.jsxs)("div",{className:"hidden items-center gap-2 rounded-xl border border-white/12 bg-black/40 px-3 py-2 text-xs text-slate-200 md:flex",children:[eu.jsx(ek,{className:"h-4 w-4 text-violet-300"}),eu.jsx("span",{className:"hidden text-[11px] font-semibold uppercase tracking-[0.18em] text-slate-400 lg:inline",children:"Learning style"}),eu.jsx("select",{value:t.learningStyle,onChange:e=>r(e.target.value),className:"ml-1 min-w-[120px] cursor-pointer border-none bg-transparent text-[11px] font-semibold uppercase tracking-[0.18em] text-slate-100 outline-none focus:ring-0",children:Object.values(s).map(e=>eu.jsx("option",{value:e,className:"bg-slate-950 text-slate-100",children:e},e))})]})})]}),(0,eu.jsxs)("div",{className:"custom-scrollbar flex-1 space-y-7 overflow-y-auto px-4 pb-6 pt-28 md:px-8 md:pt-32",children:[0===e.length&&(0,eu.jsxs)("div",{className:"mx-auto mb-4 max-w-md rounded-3xl border border-amber-400/25 bg-amber-500/10 p-5 text-center shadow-[0_18px_45px_rgba(180,83,9,0.4)]",children:[eu.jsx(eE,{className:"mx-auto mb-3 h-7 w-7 text-amber-300"}),eu.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-amber-200",children:"No notes detected"}),eu.jsx("p",{className:"mt-2 text-sm leading-relaxed text-amber-100/90",children:"I'll use my general knowledge for now. Upload your notes to make explanations laser-focused on your syllabus."})]}),(0,eu.jsxs)("div",{className:"mx-auto flex max-w-xl items-center gap-2 text-[11px] font-medium uppercase tracking-[0.18em] text-slate-500",children:[eu.jsx(nT,{className:"h-3.5 w-3.5"}),eu.jsx("span",{children:'Try: "Explain this like I\'m 15" or "Quiz me on X"'})]}),n.map(e=>{let t="user"===e.role;return(0,eu.jsxs)("div",{className:`flex items-end gap-4 ${t?"flex-row-reverse":""} animate-fadeIn`,children:[t?eu.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border border-white/12 bg-slate-900",children:eu.jsx(eC,{className:"h-5 w-5 text-slate-300"})}):eu.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-violet-500 via-indigo-500 to-cyan-400 shadow-[0_16px_40px_rgba(79,70,229,0.9)]",children:eu.jsx(nA,{className:"h-5 w-5 text-white"})}),(0,eu.jsxs)("div",{className:`
                  group relative max-w-[85%] rounded-[24px] px-6 py-4 text-[15px] leading-7 shadow-sm md:max-w-[75%]
                  ${t?"rounded-br-none bg-white text-slate-950 font-medium":"rounded-bl-none border border-white/12 bg-black/30 text-slate-100"}
                `,children:[eu.jsx("div",{className:"whitespace-pre-wrap",children:e.content}),eu.jsx("span",{className:`
                    absolute bottom-2 text-[10px] opacity-0 transition-opacity group-hover:opacity-40
                    ${t?"left-4 text-slate-800":"right-4 text-slate-400"}
                  `,children:"Just now"})]})]},e.id)}),l&&(0,eu.jsxs)("div",{className:"flex items-end gap-4 animate-fadeIn",children:[eu.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-violet-500 via-indigo-500 to-cyan-400 shadow-[0_14px_36px_rgba(79,70,229,0.8)]",children:eu.jsx(nA,{className:"h-5 w-5 text-white"})}),eu.jsx("div",{className:"rounded-[24px] rounded-bl-none border border-white/12 bg-black/30 px-5 py-4",children:(0,eu.jsxs)("div",{className:"flex space-x-2",children:[eu.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-500 animate-bounce",style:{animationDelay:"0ms"}}),eu.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-500 animate-bounce",style:{animationDelay:"150ms"}}),eu.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-500 animate-bounce",style:{animationDelay:"300ms"}})]})})]}),eu.jsx("div",{ref:c,className:"h-4"})]}),eu.jsx("div",{className:"relative z-30 border-t border-white/10 bg-slate-950/90 px-4 py-5 backdrop-blur-2xl md:px-8 md:py-6",children:(0,eu.jsxs)("form",{onSubmit:p,className:"mx-auto flex max-w-4xl items-center gap-3 md:gap-4",children:[(0,eu.jsxs)("div",{className:"group relative flex-1",children:[eu.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-2xl bg-gradient-to-r from-violet-600 via-indigo-500 to-cyan-400 opacity-0 blur-xl transition-opacity duration-500 group-focus-within:opacity-20 group-hover:opacity-15"}),eu.jsx("input",{type:"text",value:o,onChange:e=>a(e.target.value),placeholder:"Ask a question, request an explanation, or say quiz me on chapter 3...",className:"relative w-full rounded-2xl border border-white/15 bg-slate-950/80 px-4 py-3 text-sm text-white outline-none placeholder:text-slate-600 shadow-inner focus:border-violet-400/70 focus:bg-slate-950"})]}),eu.jsx("button",{type:"submit",disabled:!o.trim()||l,className:"inline-flex items-center justify-center rounded-2xl bg-white p-3 text-slate-950 shadow-[0_0_26px_rgba(255,255,255,0.3)] transition-all hover:scale-105 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:scale-100",children:eu.jsx(nS,{className:"h-5 w-5"})})]})})]})},nO=()=>{let[e,t]=(0,ec.useState)(o.DASHBOARD),[r,n]=(0,ec.useState)([]),[i,a]=(0,ec.useState)([]),[l,u]=(0,ec.useState)(s.SIMPLE),[c,d]=(0,ec.useState)(null),[p,h]=(0,ec.useState)(!0);(0,ec.useEffect)(()=>{let e=localStorage.getItem("mindmate_materials"),t=localStorage.getItem("mindmate_plan"),r=localStorage.getItem("mindmate_style");e&&n(JSON.parse(e)),t&&a(JSON.parse(t)),r&&u(r)},[]),(0,ec.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/me",{credentials:"include"});if(e.ok){let t=await e.json();d(t.user)}else d(null)}catch(e){console.error(e),d(null)}finally{h(!1)}})()},[]);let f=e=>{let t=[...r,e];n(t),localStorage.setItem("mindmate_materials",JSON.stringify(t))},m=e=>{let t=r.filter(t=>t.id!==e);n(t),localStorage.setItem("mindmate_materials",JSON.stringify(t))},g=e=>{a(e),localStorage.setItem("mindmate_plan",JSON.stringify(e))},y=e=>{u(e),localStorage.setItem("mindmate_style",e)};return p?eu.jsx("div",{className:"flex h-screen items-center justify-center bg-ambient text-slate-100",children:(0,eu.jsxs)("div",{className:"flex items-center gap-3 rounded-2xl border border-white/10 bg-white/5 px-5 py-3 shadow-lg",children:[eu.jsx("div",{className:"h-3 w-3 animate-ping rounded-full bg-violet-400"}),eu.jsx("span",{className:"text-sm font-semibold tracking-wide",children:"Loading your workspace..."})]})}):c?eu.jsx(eP,{activeTab:e,onTabChange:t,children:(()=>{switch(e){case o.DASHBOARD:return eu.jsx(eH,{materials:r,plan:i,onNavigate:t});case o.MATERIALS:return eu.jsx(eY,{materials:r,onAddMaterial:f,onRemoveMaterial:m});case o.PLAN:return eu.jsx(nb,{materials:r,existingPlan:i,onSetPlan:g});case o.QUIZ:return eu.jsx(nw,{materials:r});case o.TUTOR:return eu.jsx(nC,{materials:r,preferences:{learningStyle:l},onUpdateStyle:y});default:return eu.jsx("div",{children:"Not found"})}})()}):eu.jsx(eG,{onLogin:()=>{window.location.href="/api/auth/google"}})};function nN(){return eu.jsx(nO,{})}},714:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,s=l(e),o=s[0],a=s[1],u=new i((o+a)*3/4-a),c=0,d=a>0?o-4:o;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===a&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[c++]=255&t),1===a&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],o=0,a=n-i;o<a;o+=16383)s.push(function(e,t,n){for(var i,s=[],o=t;o<n;o+=3)s.push(r[(i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}(e,o,o+16383>a?a:o+16383));return 1===i?s.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&s.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},8254:function(e,t,r){var n;!function(i){"use strict";var s,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,l=Math.floor,u="[BigNumber Error] ",c=u+"Number primitive has more than 15 significant digits: ",d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function p(e){var t=0|e;return e>0||e===t?t:t-1}function h(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(r=14-(t=e[n++]+"").length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function f(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,l=e.e,u=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=l==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return l>u^r?1:-1;for(o=0,a=(l=i.length)<(u=s.length)?l:u;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return l==u?0:l>u^r?1:-1}function m(e,t,r,n){if(e<t||e>r||e!==l(e))throw Error(u+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function g(e){var t=e.c.length-1;return p(e.e/14)==t&&e.c[t]%2!=0}function y(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(n=e.length,++t>n){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}(s=function e(t){var r,n,i,s,_,b,E,x,w,A=L.prototype={constructor:L,toString:null,valueOf:null},T=new L(1),S=20,C=4,O=-7,N=21,I=-1e7,k=1e7,R=!1,P=1,j=0,M={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},U="0123456789abcdefghijklmnopqrstuvwxyz",D=!0;function L(e,t){var r,n,i,s,a,u,d,p,h=this;if(!(h instanceof L))return new L(e,t);if(null==t){if(e&&!0===e._isBigNumber){h.s=e.s,!e.c||e.e>k?h.c=h.e=null:e.e<I?h.c=[h.e=0]:(h.e=e.e,h.c=e.c.slice());return}if((u="number"==typeof e)&&0*e==0){if(h.s=1/e<0?(e=-e,-1):1,e===~~e){for(s=0,a=e;a>=10;a/=10,s++);s>k?h.c=h.e=null:(h.e=s,h.c=[e]);return}p=String(e)}else{if(!o.test(p=String(e)))return w(h,p,u);h.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(s=p.indexOf("."))>-1&&(p=p.replace(".","")),(a=p.search(/e/i))>0?(s<0&&(s=a),s+=+p.slice(a+1),p=p.substring(0,a)):s<0&&(s=p.length)}else{if(m(t,2,U.length,"Base"),10==t&&D)return H(h=new L(e),S+h.e+1,C);if(p=String(e),u="number"==typeof e){if(0*e!=0)return w(h,p,u,t);if(h.s=1/e<0?(p=p.slice(1),-1):1,L.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(c+e)}else h.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=U.slice(0,t),s=a=0,d=p.length;a<d;a++)if(0>r.indexOf(n=p.charAt(a))){if("."==n){if(a>s){s=d;continue}}else if(!i&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){i=!0,a=-1,s=0;continue}return w(h,String(e),u,t)}u=!1,(s=(p=x(p,t,10,h.s)).indexOf("."))>-1?p=p.replace(".",""):s=p.length}for(a=0;48===p.charCodeAt(a);a++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(a,++d)){if(d-=a,u&&L.DEBUG&&d>15&&(e>9007199254740991||e!==l(e)))throw Error(c+h.s*e);if((s=s-a-1)>k)h.c=h.e=null;else if(s<I)h.c=[h.e=0];else{if(h.e=s,h.c=[],a=(s+1)%14,s<0&&(a+=14),a<d){for(a&&h.c.push(+p.slice(0,a)),d-=14;a<d;)h.c.push(+p.slice(a,a+=14));a=14-(p=p.slice(a)).length}else a-=d;for(;a--;p+="0");h.c.push(+p)}}else h.c=[h.e=0]}function G(e,t,r,n){var i,s,o,a,l;if(null==r?r=C:m(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)l=h(e.c),l=1==n||2==n&&(o<=O||o>=N)?y(l,o):v(l,o,"0");else if(s=(e=H(new L(e),t,r)).e,a=(l=h(e.c)).length,1==n||2==n&&(t<=s||s<=O)){for(;a<t;l+="0",a++);l=y(l,s)}else if(t-=o+(2===n&&s>o),l=v(l,s,"0"),s+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=s-a)>0)for(s+1==a&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function F(e,t){for(var r,n,i=1,s=new L(e[0]);i<e.length;i++)(n=new L(e[i])).s&&(r=f(s,n))!==t&&(0!==r||s.s!==t)||(s=n);return s}function q(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+14*r-1)>k?e.c=e.e=null:r<I?e.c=[e.e=0]:(e.e=r,e.c=t),e}function H(e,t,r,n){var i,s,o,u,c,p,h,f=e.c;if(f){e:{for(i=1,u=f[0];u>=10;u/=10,i++);if((s=t-i)<0)s+=14,o=t,h=l((c=f[p=0])/d[i-o-1]%10);else if((p=a((s+1)/14))>=f.length){if(n){for(;f.length<=p;f.push(0));c=h=0,i=1,s%=14,o=s-14+1}else break e}else{for(i=1,c=u=f[p];u>=10;u/=10,i++);s%=14,h=(o=s-14+i)<0?0:l(c/d[i-o-1]%10)}if(n=n||t<0||null!=f[p+1]||(o<0?c:c%d[i-o-1]),n=r<4?(h||n)&&(0==r||r==(e.s<0?3:2)):h>5||5==h&&(4==r||n||6==r&&(s>0?o>0?c/d[i-o]:0:f[p-1])%10&1||r==(e.s<0?8:7)),t<1||!f[0])return f.length=0,n?(t-=e.e+1,f[0]=d[(14-t%14)%14],e.e=-t||0):f[0]=e.e=0,e;if(0==s?(f.length=p,u=1,p--):(f.length=p+1,u=d[14-s],f[p]=o>0?l(c/d[i-o]%d[o])*u:0),n)for(;;){if(0==p){for(s=1,o=f[0];o>=10;o/=10,s++);for(o=f[0]+=u,u=1;o>=10;o/=10,u++);s!=u&&(e.e++,1e14==f[0]&&(f[0]=1));break}if(f[p]+=u,1e14!=f[p])break;f[p--]=0,u=1}for(s=f.length;0===f[--s];f.pop());}e.e>k?e.c=e.e=null:e.e<I&&(e.c=[e.e=0])}return e}function B(e){var t,r=e.e;return null===r?e.toString():(t=h(e.c),t=r<=O||r>=N?y(t,r):v(t,r,"0"),e.s<0?"-"+t:t)}return L.clone=e,L.ROUND_UP=0,L.ROUND_DOWN=1,L.ROUND_CEIL=2,L.ROUND_FLOOR=3,L.ROUND_HALF_UP=4,L.ROUND_HALF_DOWN=5,L.ROUND_HALF_EVEN=6,L.ROUND_HALF_CEIL=7,L.ROUND_HALF_FLOOR=8,L.EUCLID=9,L.config=L.set=function(e){var t,r;if(null!=e){if("object"==typeof e){if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(m(r=e[t],0,1e9,t),S=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(m(r=e[t],0,8,t),C=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(m(r[0],-1e9,0,t),m(r[1],0,1e9,t),O=r[0],N=r[1]):(m(r,-1e9,1e9,t),O=-(N=r<0?-r:r))),e.hasOwnProperty(t="RANGE")){if((r=e[t])&&r.pop)m(r[0],-1e9,-1,t),m(r[1],1,1e9,t),I=r[0],k=r[1];else if(m(r,-1e9,1e9,t),r)I=-(k=r<0?-r:r);else throw Error(u+t+" cannot be zero: "+r)}if(e.hasOwnProperty(t="CRYPTO")){if(!!(r=e[t])===r){if(r){if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))R=r;else throw R=!r,Error(u+"crypto unavailable")}else R=r}else throw Error(u+t+" not true or false: "+r)}if(e.hasOwnProperty(t="MODULO_MODE")&&(m(r=e[t],0,9,t),P=r),e.hasOwnProperty(t="POW_PRECISION")&&(m(r=e[t],0,1e9,t),j=r),e.hasOwnProperty(t="FORMAT")){if("object"==typeof(r=e[t]))M=r;else throw Error(u+t+" not an object: "+r)}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(u+t+" invalid: "+r);D="0123456789"==r.slice(0,10),U=r}}else throw Error(u+"Object expected: "+e)}return{DECIMAL_PLACES:S,ROUNDING_MODE:C,EXPONENTIAL_AT:[O,N],RANGE:[I,k],CRYPTO:R,MODULO_MODE:P,POW_PRECISION:j,FORMAT:M,ALPHABET:U}},L.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!L.DEBUG)return!0;var t,r,n=e.c,i=e.e,s=e.s;e:if("[object Array]"==({}).toString.call(n)){if((1===s||-1===s)&&i>=-1e9&&i<=1e9&&i===l(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%14)<1&&(t+=14),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=1e14||r!==l(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(u+"Invalid BigNumber: "+e)},L.maximum=L.max=function(){return F(arguments,-1)},L.minimum=L.min=function(){return F(arguments,1)},L.random=(r=9007199254740992*Math.random()&2097151?function(){return l(9007199254740992*Math.random())}:function(){return(1073741824*Math.random()|0)*8388608+(8388608*Math.random()|0)},function(e){var t,n,i,s,o,c=0,p=[],h=new L(T);if(null==e?e=S:m(e,0,1e9),s=a(e/14),R){if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(s*=2));c<s;)(o=131072*t[c]+(t[c+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[c]=n[0],t[c+1]=n[1]):(p.push(o%1e14),c+=2);c=s/2}else if(crypto.randomBytes){for(t=crypto.randomBytes(s*=7);c<s;)(o=(31&t[c])*281474976710656+1099511627776*t[c+1]+4294967296*t[c+2]+16777216*t[c+3]+(t[c+4]<<16)+(t[c+5]<<8)+t[c+6])>=9e15?crypto.randomBytes(7).copy(t,c):(p.push(o%1e14),c+=7);c=s/7}else throw R=!1,Error(u+"crypto unavailable")}if(!R)for(;c<s;)(o=r())<9e15&&(p[c++]=o%1e14);for(s=p[--c],e%=14,s&&e&&(o=d[14-e],p[c]=l(s/o)*o);0===p[c];p.pop(),c--);if(c<0)p=[i=0];else{for(i=-1;0===p[0];p.splice(0,1),i-=14);for(c=1,o=p[0];o>=10;o/=10,c++);c<14&&(i-=14-c)}return h.e=i,h.c=p,h}),L.sum=function(){for(var e=1,t=arguments,r=new L(t[0]);e<t.length;)r=r.plus(t[e++]);return r},x=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],a=0,l=e.length;a<l;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(r,n,i,s,o){var a,l,u,c,d,p,f,m,g=r.indexOf("."),y=S,_=C;for(g>=0&&(c=j,j=0,r=r.replace(".",""),p=(m=new L(n)).pow(r.length-g),j=c,m.c=t(v(h(p.c),p.e,"0"),10,i,e),m.e=m.c.length),u=c=(f=t(r,n,i,o?(a=U,e):(a=e,U))).length;0==f[--c];f.pop());if(!f[0])return a.charAt(0);if(g<0?--u:(p.c=f,p.e=u,p.s=s,f=(p=E(p,m,y,_,i)).c,d=p.r,u=p.e),g=f[l=u+y+1],c=i/2,d=d||l<0||null!=f[l+1],d=_<4?(null!=g||d)&&(0==_||_==(p.s<0?3:2)):g>c||g==c&&(4==_||d||6==_&&1&f[l-1]||_==(p.s<0?8:7)),l<1||!f[0])r=d?v(a.charAt(1),-y,a.charAt(0)):a.charAt(0);else{if(f.length=l,d)for(--i;++f[--l]>i;)f[l]=0,l||(++u,f=[1].concat(f));for(c=f.length;!f[--c];);for(g=0,r="";g<=c;r+=a.charAt(f[g++]));r=v(r,u,a.charAt(0))}return r}}(),E=function(){function e(e,t,r){var n,i,s,o,a=0,l=e.length,u=t%1e7,c=t/1e7|0;for(e=e.slice();l--;)n=c*(s=e[l]%1e7)+(o=e[l]/1e7|0)*u,a=((i=u*s+n%1e7*1e7+a)/r|0)+(n/1e7|0)+c*o,e[l]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,s,o,a){var u,c,d,h,f,m,g,y,v,_,b,E,x,w,A,T,S,C=n.s==i.s?1:-1,O=n.c,N=i.c;if(!O||!O[0]||!N||!N[0])return new L(n.s&&i.s&&(O?!N||O[0]!=N[0]:N)?O&&0==O[0]||!N?0*C:C/0:NaN);for(v=(y=new L(C)).c=[],C=s+(c=n.e-i.e)+1,a||(a=1e14,c=p(n.e/14)-p(i.e/14),C=C/14|0),d=0;N[d]==(O[d]||0);d++);if(N[d]>(O[d]||0)&&c--,C<0)v.push(1),h=!0;else{for(w=O.length,T=N.length,d=0,C+=2,(f=l(a/(N[0]+1)))>1&&(N=e(N,f,a),O=e(O,f,a),T=N.length,w=O.length),x=T,b=(_=O.slice(0,T)).length;b<T;_[b++]=0);S=[0].concat(S=N.slice()),A=N[0],N[1]>=a/2&&A++;do{if(f=0,(u=t(N,_,T,b))<0){if(E=_[0],T!=b&&(E=E*a+(_[1]||0)),(f=l(E/A))>1)for(f>=a&&(f=a-1),g=(m=e(N,f,a)).length,b=_.length;1==t(m,_,g,b);)f--,r(m,T<g?S:N,g,a),g=m.length,u=1;else 0==f&&(u=f=1),g=(m=N.slice()).length;if(g<b&&(m=[0].concat(m)),r(_,m,b,a),b=_.length,-1==u)for(;1>t(N,_,T,b);)f++,r(_,T<b?S:N,b,a),b=_.length}else 0===u&&(f++,_=[0]);v[d++]=f,_[0]?_[b++]=O[x]||0:(_=[O[x]],b=1)}while((x++<w||null!=_[0])&&C--);h=null!=_[0],v[0]||v.splice(0,1)}if(1e14==a){for(d=1,C=v[0];C>=10;C/=10,d++);H(y,s+(y.e=d+14*c-1)+1,o,h)}else y.e=c,y.r=+h;return y}}(),n=/^(-?)0([xbo])(?=\w[\w.]*$)/i,i=/^([^.]+)\.$/,s=/^\.([^.]+)$/,_=/^-?(Infinity|NaN)$/,b=/^\s*\+(?=[\w.])|^\s+|\s+$/g,w=function(e,t,r,o){var a,l=r?t:t.replace(b,"");if(_.test(l))e.s=isNaN(l)?null:l<0?-1:1;else{if(!r&&(l=l.replace(n,function(e,t,r){return a="x"==(r=r.toLowerCase())?16:"b"==r?2:8,o&&o!=a?e:t}),o&&(a=o,l=l.replace(i,"$1").replace(s,"0.$1")),t!=l))return new L(l,a);if(L.DEBUG)throw Error(u+"Not a"+(o?" base "+o:"")+" number: "+t);e.s=null}e.c=e.e=null},A.absoluteValue=A.abs=function(){var e=new L(this);return e.s<0&&(e.s=1),e},A.comparedTo=function(e,t){return f(this,new L(e,t))},A.decimalPlaces=A.dp=function(e,t){var r,n,i;if(null!=e)return m(e,0,1e9),null==t?t=C:m(t,0,8),H(new L(this),e+this.e+1,t);if(!(r=this.c))return null;if(n=((i=r.length-1)-p(this.e/14))*14,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},A.dividedBy=A.div=function(e,t){return E(this,new L(e,t),S,C)},A.dividedToIntegerBy=A.idiv=function(e,t){return E(this,new L(e,t),0,1)},A.exponentiatedBy=A.pow=function(e,t){var r,n,i,s,o,c,d,p,h,f=this;if((e=new L(e)).c&&!e.isInteger())throw Error(u+"Exponent not an integer: "+B(e));if(null!=t&&(t=new L(t)),c=e.e>14,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!e.c||!e.c[0])return h=new L(Math.pow(+B(f),c?e.s*(2-g(e)):+B(e))),t?h.mod(t):h;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new L(NaN);(n=!d&&f.isInteger()&&t.isInteger())&&(f=f.mod(t))}else{if(e.e>9&&(f.e>0||f.e<-1||(0==f.e?f.c[0]>1||c&&f.c[1]>=24e7:f.c[0]<8e13||c&&f.c[0]<=9999975e7)))return s=f.s<0&&g(e)?-0:0,f.e>-1&&(s=1/s),new L(d?1/s:s);j&&(s=a(j/14+2))}for(c?(r=new L(.5),d&&(e.s=1),p=g(e)):p=(i=Math.abs(+B(e)))%2,h=new L(T);;){if(p){if(!(h=h.times(f)).c)break;s?h.c.length>s&&(h.c.length=s):n&&(h=h.mod(t))}if(i){if(0===(i=l(i/2)))break;p=i%2}else if(H(e=e.times(r),e.e+1,1),e.e>14)p=g(e);else{if(0==(i=+B(e)))break;p=i%2}f=f.times(f),s?f.c&&f.c.length>s&&(f.c.length=s):n&&(f=f.mod(t))}return n?h:(d&&(h=T.div(h)),t?h.mod(t):s?H(h,j,C,o):h)},A.integerValue=function(e){var t=new L(this);return null==e?e=C:m(e,0,8),H(t,t.e+1,e)},A.isEqualTo=A.eq=function(e,t){return 0===f(this,new L(e,t))},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(e,t){return f(this,new L(e,t))>0},A.isGreaterThanOrEqualTo=A.gte=function(e,t){return 1===(t=f(this,new L(e,t)))||0===t},A.isInteger=function(){return!!this.c&&p(this.e/14)>this.c.length-2},A.isLessThan=A.lt=function(e,t){return 0>f(this,new L(e,t))},A.isLessThanOrEqualTo=A.lte=function(e,t){return -1===(t=f(this,new L(e,t)))||0===t},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&0==this.c[0]},A.minus=function(e,t){var r,n,i,s,o=this.s;if(t=(e=new L(e,t)).s,!o||!t)return new L(NaN);if(o!=t)return e.s=-t,this.plus(e);var a=this.e/14,l=e.e/14,u=this.c,c=e.c;if(!a||!l){if(!u||!c)return u?(e.s=-t,e):new L(c?this:NaN);if(!u[0]||!c[0])return c[0]?(e.s=-t,e):new L(u[0]?this:3==C?-0:0)}if(a=p(a),l=p(l),u=u.slice(),o=a-l){for((s=o<0)?(o=-o,i=u):(l=a,i=c),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(n=(s=(o=u.length)<(t=c.length))?o:t,o=t=0;t<n;t++)if(u[t]!=c[t]){s=u[t]<c[t];break}if(s&&(i=u,u=c,c=i,e.s=-e.s),(t=(n=c.length)-(r=u.length))>0)for(;t--;u[r++]=0);for(t=1e14-1;n>o;){if(u[--n]<c[n]){for(r=n;r&&!u[--r];u[r]=t);--u[r],u[n]+=1e14}u[n]-=c[n]}for(;0==u[0];u.splice(0,1),--l);return u[0]?q(e,u,l):(e.s=3==C?-1:1,e.c=[e.e=0],e)},A.modulo=A.mod=function(e,t){var r,n;return(e=new L(e,t),this.c&&e.s&&(!e.c||e.c[0]))?e.c&&(!this.c||this.c[0])?(9==P?(n=e.s,e.s=1,r=E(this,e,0,3),e.s=n,r.s*=n):r=E(this,e,0,P),(e=this.minus(r.times(e))).c[0]||1!=P||(e.s=this.s),e):new L(this):new L(NaN)},A.multipliedBy=A.times=function(e,t){var r,n,i,s,o,a,l,u,c,d,h,f,m,g=this.c,y=(e=new L(e,t)).c;if(!g||!y||!g[0]||!y[0])return this.s&&e.s&&(!g||g[0]||y)&&(!y||y[0]||g)?(e.s*=this.s,g&&y?(e.c=[0],e.e=0):e.c=e.e=null):e.c=e.e=e.s=null,e;for(n=p(this.e/14)+p(e.e/14),e.s*=this.s,(l=g.length)<(d=y.length)&&(m=g,g=y,y=m,i=l,l=d,d=i),i=l+d,m=[];i--;m.push(0));for(i=d;--i>=0;){for(r=0,h=y[i]%1e7,f=y[i]/1e7|0,s=i+(o=l);s>i;)a=f*(u=g[--o]%1e7)+(c=g[o]/1e7|0)*h,r=((u=h*u+a%1e7*1e7+m[s]+r)/1e14|0)+(a/1e7|0)+f*c,m[s--]=u%1e14;m[s]=r}return r?++n:m.splice(0,1),q(e,m,n)},A.negated=function(){var e=new L(this);return e.s=-e.s||null,e},A.plus=function(e,t){var r,n=this.s;if(t=(e=new L(e,t)).s,!n||!t)return new L(NaN);if(n!=t)return e.s=-t,this.minus(e);var i=this.e/14,s=e.e/14,o=this.c,a=e.c;if(!i||!s){if(!o||!a)return new L(n/0);if(!o[0]||!a[0])return a[0]?e:new L(o[0]?this:0*n)}if(i=p(i),s=p(s),o=o.slice(),n=i-s){for(n>0?(s=i,r=a):(n=-n,r=o),r.reverse();n--;r.push(0));r.reverse()}for((n=o.length)-(t=a.length)<0&&(r=a,a=o,o=r,t=n),n=0;t;)n=(o[--t]=o[t]+a[t]+n)/1e14|0,o[t]=1e14===o[t]?0:o[t]%1e14;return n&&(o=[n].concat(o),++s),q(e,o,s)},A.precision=A.sd=function(e,t){var r,n,i;if(null!=e&&!!e!==e)return m(e,1,1e9),null==t?t=C:m(t,0,8),H(new L(this),e,t);if(!(r=this.c))return null;if(n=14*(i=r.length-1)+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&this.e+1>n&&(n=this.e+1),n},A.shiftedBy=function(e){return m(e,-9007199254740991,9007199254740991),this.times("1e"+e)},A.squareRoot=A.sqrt=function(){var e,t,r,n,i,s=this.c,o=this.s,a=this.e,l=S+4,u=new L("0.5");if(1!==o||!s||!s[0])return new L(!o||o<0&&(!s||s[0])?NaN:s?this:1/0);if(0==(o=Math.sqrt(+B(this)))||o==1/0?(((t=h(s)).length+a)%2==0&&(t+="0"),o=Math.sqrt(+t),a=p((a+1)/2)-(a<0||a%2),r=new L(t=o==1/0?"5e"+a:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+a)):r=new L(o+""),r.c[0]){for((o=(a=r.e)+l)<3&&(o=0);;)if(i=r,r=u.times(i.plus(E(this,i,l,1))),h(i.c).slice(0,o)===(t=h(r.c)).slice(0,o)){if(r.e<a&&--o,"9999"!=(t=t.slice(o-3,o+1))&&(n||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(H(r,r.e+S+2,1),e=!r.times(r).eq(this));break}if(!n&&(H(i,i.e+S+2,0),i.times(i).eq(this))){r=i;break}l+=4,o+=4,n=1}}return H(r,r.e+S+1,C,e)},A.toExponential=function(e,t){return null!=e&&(m(e,0,1e9),e++),G(this,e,t,1)},A.toFixed=function(e,t){return null!=e&&(m(e,0,1e9),e=e+this.e+1),G(this,e,t)},A.toFormat=function(e,t,r){var n;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=M;else if("object"!=typeof r)throw Error(u+"Argument not an object: "+r);if(n=this.toFixed(e,t),this.c){var i,s=n.split("."),o=+r.groupSize,a=+r.secondaryGroupSize,l=r.groupSeparator||"",c=s[0],d=s[1],p=this.s<0,h=p?c.slice(1):c,f=h.length;if(a&&(i=o,o=a,a=i,f-=i),o>0&&f>0){for(i=f%o||o,c=h.substr(0,i);i<f;i+=o)c+=l+h.substr(i,o);a>0&&(c+=l+h.slice(i)),p&&(c="-"+c)}n=d?c+(r.decimalSeparator||"")+((a=+r.fractionGroupSize)?d.replace(RegExp("\\d{"+a+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):d):c}return(r.prefix||"")+n+(r.suffix||"")},A.toFraction=function(e){var t,r,n,i,s,o,a,l,c,p,f,m,g=this.c;if(null!=e&&(!(a=new L(e)).isInteger()&&(a.c||1!==a.s)||a.lt(T)))throw Error(u+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+B(a));if(!g)return new L(this);for(t=new L(T),c=r=new L(T),n=l=new L(T),m=h(g),s=t.e=m.length-this.e-1,t.c[0]=d[(o=s%14)<0?14+o:o],e=!e||a.comparedTo(t)>0?s>0?t:c:a,o=k,k=1/0,a=new L(m),l.c[0]=0;p=E(a,t,0,1),1!=(i=r.plus(p.times(n))).comparedTo(e);)r=n,n=i,c=l.plus(p.times(i=c)),l=i,t=a.minus(p.times(i=t)),a=i;return i=E(e.minus(r),n,0,1),l=l.plus(i.times(c)),r=r.plus(i.times(n)),l.s=c.s=this.s,s*=2,f=1>E(c,n,s,C).minus(this).abs().comparedTo(E(l,r,s,C).minus(this).abs())?[c,n]:[l,r],k=o,f},A.toNumber=function(){return+B(this)},A.toPrecision=function(e,t){return null!=e&&m(e,1,1e9),G(this,e,t,2)},A.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=O||i>=N?y(h(r.c),i):v(h(r.c),i,"0"):10===e&&D?t=v(h((r=H(new L(r),S+i+1,C)).c),r.e,"0"):(m(e,2,U.length,"Base"),t=x(v(h(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},A.valueOf=A.toJSON=function(){return B(this)},A._isBigNumber=!0,null!=t&&L.set(t),L}()).default=s.BigNumber=s,void 0!==(n=(function(){return s}).call(t,r,t,e))&&(e.exports=n)}(0)},9916:(e,t,r)=>{"use strict";var n=r(4300).Buffer,i=r(4300).SlowBuffer;function s(e,t){if(!n.isBuffer(e)||!n.isBuffer(t)||e.length!==t.length)return!1;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}e.exports=s,s.install=function(){n.prototype.equal=i.prototype.equal=function(e){return s(this,e)}};var o=n.prototype.equal,a=i.prototype.equal;s.restore=function(){n.prototype.equal=o,i.prototype.equal=a}},3164:(e,t,r)=>{"use strict";var n=r(892).Buffer,i=r(1887);function s(e){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function o(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=128&&--n,n}e.exports={derToJose:function(e,t){e=s(e);var r=i(t),o=r+1,a=e.length,l=0;if(48!==e[l++])throw Error('Could not find expected "seq"');var u=e[l++];if(129===u&&(u=e[l++]),a-l<u)throw Error('"seq" specified length of "'+u+'", only "'+(a-l)+'" remaining');if(2!==e[l++])throw Error('Could not find expected "int" for "r"');var c=e[l++];if(a-l-2<c)throw Error('"r" specified length of "'+c+'", only "'+(a-l-2)+'" available');if(o<c)throw Error('"r" specified length of "'+c+'", max of "'+o+'" is acceptable');var d=l;if(l+=c,2!==e[l++])throw Error('Could not find expected "int" for "s"');var p=e[l++];if(a-l!==p)throw Error('"s" specified length of "'+p+'", expected "'+(a-l)+'"');if(o<p)throw Error('"s" specified length of "'+p+'", max of "'+o+'" is acceptable');var h=l;if((l+=p)!==a)throw Error('Expected to consume entire buffer, but "'+(a-l)+'" bytes remain');var f=r-c,m=r-p,g=n.allocUnsafe(f+c+m+p);for(l=0;l<f;++l)g[l]=0;e.copy(g,l,d+Math.max(-f,0),d+c),l=r;for(var y=l;l<y+m;++l)g[l]=0;return e.copy(g,l,h+Math.max(-m,0),h+p),g=(g=g.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=s(e);var r=i(t),a=e.length;if(a!==2*r)throw TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+a+'"');var l=o(e,0,r),u=o(e,r,e.length),c=r-l,d=r-u,p=2+c+1+1+d,h=p<128,f=n.allocUnsafe((h?2:3)+p),m=0;return f[m++]=48,h?f[m++]=p:(f[m++]=129,f[m++]=255&p),f[m++]=2,f[m++]=c,l<0?(f[m++]=0,m+=e.copy(f,m,0,r)):m+=e.copy(f,m,l,r),f[m++]=2,f[m++]=d,u<0?(f[m++]=0,e.copy(f,m,r)):e.copy(f,m,r+u),f}}},1887:e=>{"use strict";function t(e){return(e/8|0)+(e%8==0?0:1)}var r={ES256:t(256),ES384:t(384),ES512:t(521)};e.exports=function(e){var t=r[e];if(t)return t;throw Error('Unknown algorithm "'+e+'"')}},1771:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===r.call(e)},o=function(e){if(!e||"[object Object]"!==r.call(e))return!1;var n,i=t.call(e,"constructor"),s=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!i&&!s)return!1;for(n in e);return void 0===n||t.call(e,n)},a=function(e,t){n&&"__proto__"===t.name?n(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},l=function(e,r){if("__proto__"===r){if(!t.call(e,r))return;if(i)return i(e,r).value}return e[r]};e.exports=function e(){var t,r,n,i,u,c,d=arguments[0],p=1,h=arguments.length,f=!1;for("boolean"==typeof d&&(f=d,d=arguments[1]||{},p=2),(null==d||"object"!=typeof d&&"function"!=typeof d)&&(d={});p<h;++p)if(t=arguments[p],null!=t)for(r in t)n=l(d,r),d!==(i=l(t,r))&&(f&&i&&(o(i)||(u=s(i)))?(u?(u=!1,c=n&&s(n)?n:[]):c=n&&o(n)?n:{},a(d,{name:r,newValue:e(f,c,i)})):void 0!==i&&a(d,{name:r,newValue:i}));return d}},1779:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GaxiosError=t.GAXIOS_ERROR_SYMBOL=void 0,t.defaultErrorRedactor=function e(t){let r="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function n(e){e&&e.forEach((t,n)=>{(/^authentication$/i.test(n)||/^authorization$/i.test(n)||/secret/i.test(n))&&e.set(n,r)})}function i(e,t){if("object"==typeof e&&null!==e&&"string"==typeof e[t]){let n=e[t];(/grant_type=/i.test(n)||/assertion=/i.test(n)||/secret/i.test(n))&&(e[t]=r)}}function s(e){e&&"object"==typeof e&&(e instanceof FormData||e instanceof URLSearchParams||"forEach"in e&&"set"in e?e.forEach((t,n)=>{(["grant_type","assertion"].includes(n)||/secret/.test(n))&&e.set(n,r)}):("grant_type"in e&&(e.grant_type=r),"assertion"in e&&(e.assertion=r),"client_secret"in e&&(e.client_secret=r)))}return t.config&&(n(t.config.headers),i(t.config,"data"),s(t.config.data),i(t.config,"body"),s(t.config.body),t.config.url.searchParams.has("token")&&t.config.url.searchParams.set("token",r),t.config.url.searchParams.has("client_secret")&&t.config.url.searchParams.set("client_secret",r)),t.response&&(e({config:t.response.config}),n(t.response.headers),t.response.bodyUsed&&(i(t.response,"data"),s(t.response.data))),t};let i=n(r(1771)),s=n(r(5506)).default.pkg;t.GAXIOS_ERROR_SYMBOL=Symbol.for(`${s.name}-gaxios-error`);class o extends Error{config;response;code;status;error;[t.GAXIOS_ERROR_SYMBOL]=s.version;static[Symbol.hasInstance](e){return!!e&&"object"==typeof e&&t.GAXIOS_ERROR_SYMBOL in e&&e[t.GAXIOS_ERROR_SYMBOL]===s.version||Function.prototype[Symbol.hasInstance].call(o,e)}constructor(e,t,r,n){if(super(e,{cause:n}),this.config=t,this.response=r,this.error=n instanceof Error?n:void 0,this.config=(0,i.default)(!0,{},t),this.response&&(this.response.config=(0,i.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(e,t){switch(e){case"stream":default:return t;case"json":return JSON.parse(JSON.stringify(t));case"arraybuffer":return JSON.parse(Buffer.from(t).toString("utf8"));case"blob":return JSON.parse(t.text())}}(this.config.responseType,this.response?.bodyUsed?this.response?.data:void 0)}catch{}this.status=this.response.status}n instanceof DOMException?this.code=n.name:n&&"object"==typeof n&&"code"in n&&("string"==typeof n.code||"number"==typeof n.code)&&(this.code=n.code)}static extractAPIErrorFromResponse(e,t="The request failed"){let r=t;if("string"==typeof e.data&&(r=e.data),e.data&&"object"==typeof e.data&&"error"in e.data&&e.data.error&&!e.ok){if("string"==typeof e.data.error)return{message:e.data.error,code:e.status,status:e.statusText};if("object"==typeof e.data.error){r="message"in e.data.error&&"string"==typeof e.data.error.message?e.data.error.message:r;let t="status"in e.data.error&&"string"==typeof e.data.error.status?e.data.error.status:e.statusText,n="code"in e.data.error&&"number"==typeof e.data.error.code?e.data.error.code:e.status;if("errors"in e.data.error&&Array.isArray(e.data.error.errors)){let i=[];for(let t of e.data.error.errors)"object"==typeof t&&"message"in t&&"string"==typeof t.message&&i.push(t.message);return Object.assign({message:i.join("\n")||r,code:n,status:t},e.data.error)}return Object.assign({message:r,code:n,status:t},e.data.error)}}return{message:r,code:e.status,status:e.statusText}}}t.GaxiosError=o},7622:function(e,t,r){"use strict";var n,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Gaxios=void 0;let s=i(r(1771)),o=r(5687),a=r(1779),l=r(1544),u=r(2781),c=r(4377),d=async()=>globalThis.crypto?.randomUUID()||(await Promise.resolve().then(r.t.bind(r,6113,23))).randomUUID();class p{agentCache=new Map;defaults;interceptors;constructor(e){this.defaults=e||{},this.interceptors={request:new c.GaxiosInterceptorManager,response:new c.GaxiosInterceptorManager}}fetch(...e){let t;let r=e[0],i=e[1],s=new Headers;return("string"==typeof r?t=new URL(r):r instanceof URL?t=r:r&&r.url&&(t=new URL(r.url)),r&&"object"==typeof r&&"headers"in r&&n.mergeHeaders(s,r.headers),i&&n.mergeHeaders(s,new Headers(i.headers)),"object"!=typeof r||r instanceof URL)?this.request({...i,headers:s,url:t}):this.request({...i,...r,headers:s,url:t})}async request(e={}){let t=await this.#e(e);return t=await this.#t(t),this.#r(this._request(t))}async _defaultAdapter(e){let t=e.fetchImplementation||this.defaults.fetchImplementation||await n.#n(),r={...e};delete r.data;let i=await t(e.url,r),s=await this.getResponseData(e,i);return Object.getOwnPropertyDescriptor(i,"data")?.configurable||Object.defineProperties(i,{data:{configurable:!0,writable:!0,enumerable:!0,value:s}}),Object.assign(i,{config:e,data:s})}async _request(e){try{let t;if(t=e.adapter?await e.adapter(e,this._defaultAdapter.bind(this)):await this._defaultAdapter(e),!e.validateStatus(t.status)){if("stream"===e.responseType){let e=[];for await(let r of t.data)e.push(r);t.data=e.toString()}let r=a.GaxiosError.extractAPIErrorFromResponse(t,`Request failed with status code ${t.status}`);throw new a.GaxiosError(r?.message,e,t,r)}return t}catch(i){let t;t=i instanceof a.GaxiosError?i:i instanceof Error?new a.GaxiosError(i.message,e,void 0,i):new a.GaxiosError("Unexpected Gaxios Error",e,void 0,i);let{shouldRetry:r,config:n}=await (0,l.getRetryConfig)(t);if(r&&n)return t.config.retryConfig.currentRetryAttempt=n.retryConfig.currentRetryAttempt,e.retryConfig=t.config?.retryConfig,this.#i(e),this._request(e);throw e.errorRedactor&&e.errorRedactor(t),t}}async getResponseData(e,t){if(204===t.status)return"";if(e.maxContentLength&&t.headers.has("content-length")&&e.maxContentLength<Number.parseInt(t.headers?.get("content-length")||""))throw new a.GaxiosError("Response's `Content-Length` is over the limit.",e,Object.assign(t,{config:e}));switch(e.responseType){case"stream":return t.body;case"json":{let e=await t.text();try{return JSON.parse(e)}catch{return e}}case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"text":return t.text();default:return this.getResponseDataFromContentType(t)}}#s(e,t=[]){let r=new URL(e),n=[...t];for(let e of(process.env.NO_PROXY??process.env.no_proxy)?.split(",")||[])n.push(e.trim());for(let e of n)if(e instanceof RegExp){if(e.test(r.toString()))return!1}else if(e instanceof URL){if(e.origin===r.origin)return!1}else if(e.startsWith("*.")||e.startsWith(".")){let t=e.replace(/^\*\./,".");if(r.hostname.endsWith(t))return!1}else if(e===r.origin||e===r.hostname||e===r.href)return!1;return!0}async #t(e){let t=Promise.resolve(e);for(let e of this.interceptors.request.values())e&&(t=t.then(e.resolved,e.rejected));return t}async #r(e){let t=Promise.resolve(e);for(let e of this.interceptors.response.values())e&&(t=t.then(e.resolved,e.rejected));return t}async #e(e){let t=new Headers(this.defaults.headers);n.mergeHeaders(t,e.headers);let r=(0,s.default)(!0,{},this.defaults,e);if(!r.url)throw Error("URL is required.");if(r.baseURL&&(r.url=new URL(r.url,r.baseURL)),r.url=new URL(r.url),r.params){if(r.paramsSerializer){let e=r.paramsSerializer(r.params);e.startsWith("?")&&(e=e.slice(1));let t=r.url.toString().includes("?")?"&":"?";r.url=r.url+t+e}else{let e=r.url instanceof URL?r.url:new URL(r.url);for(let[t,n]of new URLSearchParams(r.params))e.searchParams.append(t,n);r.url=e}}"number"==typeof e.maxContentLength&&(r.size=e.maxContentLength),"number"==typeof e.maxRedirects&&(r.follow=e.maxRedirects);let i="string"==typeof r.data||r.data instanceof ArrayBuffer||r.data instanceof Blob||globalThis.File&&r.data instanceof File||r.data instanceof FormData||r.data instanceof u.Readable||r.data instanceof ReadableStream||r.data instanceof String||r.data instanceof URLSearchParams||ArrayBuffer.isView(r.data)||["Blob","File","FormData"].includes(r.data?.constructor?.name||"");if(r.multipart?.length){let e=await d();t.set("content-type",`multipart/related; boundary=${e}`),r.body=u.Readable.from(this.getMultipartRequest(r.multipart,e))}else i?r.body=r.data:"object"==typeof r.data?"application/x-www-form-urlencoded"===t.get("Content-Type")?r.body=r.paramsSerializer?r.paramsSerializer(r.data):new URLSearchParams(r.data):(t.has("content-type")||t.set("content-type","application/json"),r.body=JSON.stringify(r.data)):r.data&&(r.body=r.data);r.validateStatus=r.validateStatus||this.validateStatus,r.responseType=r.responseType||"unknown",t.has("accept")||"json"!==r.responseType||t.set("accept","application/json");let l=r.proxy||process?.env?.HTTPS_PROXY||process?.env?.https_proxy||process?.env?.HTTP_PROXY||process?.env?.http_proxy;if(r.agent);else if(l&&this.#s(r.url,r.noProxy)){let e=await n.#o();this.agentCache.has(l)?r.agent=this.agentCache.get(l):(r.agent=new e(l,{cert:r.cert,key:r.key}),this.agentCache.set(l,r.agent))}else r.cert&&r.key&&(this.agentCache.has(r.key)?r.agent=this.agentCache.get(r.key):(r.agent=new o.Agent({cert:r.cert,key:r.key}),this.agentCache.set(r.key,r.agent)));return"function"!=typeof r.errorRedactor&&!1!==r.errorRedactor&&(r.errorRedactor=a.defaultErrorRedactor),!r.body||"duplex"in r||(r.duplex="half"),this.#i(r),Object.assign(r,{headers:t,url:r.url instanceof URL?r.url:new URL(r.url)})}#i(e){if(e.timeout){let t=AbortSignal.timeout(e.timeout);e.signal&&!e.signal.aborted?e.signal=AbortSignal.any([e.signal,t]):e.signal=t}}validateStatus(e){return e>=200&&e<300}async getResponseDataFromContentType(e){let t=e.headers.get("Content-Type");if(null===t)return e.text();if((t=t.toLowerCase()).includes("application/json")){let t=await e.text();try{t=JSON.parse(t)}catch{}return t}return t.match(/^text\//)?e.text():e.blob()}async *getMultipartRequest(e,t){let r=`--${t}--`;for(let r of e){let e=r.headers.get("Content-Type")||"application/octet-stream",n=`--${t}\r
Content-Type: ${e}\r
\r
`;yield n,"string"==typeof r.content?yield r.content:yield*r.content,yield"\r\n"}yield r}static #a;static #l;static async #o(){return this.#a||=(await r.e(322).then(r.t.bind(r,8322,23))).HttpsProxyAgent,this.#a}static async #n(){let e="undefined"!=typeof window&&!!window;return this.#l||=e?window.fetch:(await r.e(472).then(r.bind(r,4472))).default,this.#l}static mergeHeaders(e,...t){for(let r of(e=e instanceof Headers?e:new Headers(e),t))(r instanceof Headers?r:new Headers(r)).forEach((t,r)=>{"set-cookie"===r?e.append(r,t):e.set(r,t)});return e}}t.Gaxios=p,n=p},206:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.instance=t.Gaxios=t.GaxiosError=void 0,t.request=a;let s=r(7622);Object.defineProperty(t,"Gaxios",{enumerable:!0,get:function(){return s.Gaxios}});var o=r(1779);async function a(e){return t.instance.request(e)}Object.defineProperty(t,"GaxiosError",{enumerable:!0,get:function(){return o.GaxiosError}}),i(r(4377),t),t.instance=new s.Gaxios},4377:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GaxiosInterceptorManager=void 0;class r extends Set{}t.GaxiosInterceptorManager=r},1544:(e,t)=>{"use strict";async function r(e){var t;let r=i(e);if(!e||!e.config||!r&&!e.config.retry)return{shouldRetry:!1};(r=r||{}).currentRetryAttempt=r.currentRetryAttempt||0,r.retry=void 0===r.retry||null===r.retry?3:r.retry,r.httpMethodsToRetry=r.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],r.noResponseRetries=void 0===r.noResponseRetries||null===r.noResponseRetries?2:r.noResponseRetries,r.retryDelayMultiplier=r.retryDelayMultiplier?r.retryDelayMultiplier:2,r.timeOfFirstRequest=r.timeOfFirstRequest?r.timeOfFirstRequest:Date.now(),r.totalTimeout=r.totalTimeout?r.totalTimeout:Number.MAX_SAFE_INTEGER,r.maxRetryDelay=r.maxRetryDelay?r.maxRetryDelay:Number.MAX_SAFE_INTEGER,r.statusCodesToRetry=r.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],e.config.retryConfig=r;let s=r.shouldRetry||n;if(!await s(e))return{shouldRetry:!1,config:e.config};let o=Math.min(((t=r).currentRetryAttempt?0:t.retryDelay??100)+(Math.pow(t.retryDelayMultiplier,t.currentRetryAttempt)-1)/2*1e3,t.totalTimeout-(Date.now()-t.timeOfFirstRequest),t.maxRetryDelay);e.config.retryConfig.currentRetryAttempt+=1;let a=r.retryBackoff?r.retryBackoff(e,o):new Promise(e=>{setTimeout(e,o)});return r.onRetryAttempt&&await r.onRetryAttempt(e),await a,{shouldRetry:!0,config:e.config}}function n(e){let t=i(e);if(e.config.signal?.aborted&&"TimeoutError"!==e.code||"AbortError"===e.code||!t||0===t.retry||!e.response&&(t.currentRetryAttempt||0)>=t.noResponseRetries||!t.httpMethodsToRetry||!t.httpMethodsToRetry.includes(e.config.method?.toUpperCase()||"GET"))return!1;if(e.response&&e.response.status){let r=!1;for(let[n,i]of t.statusCodesToRetry){let t=e.response.status;if(t>=n&&t<=i){r=!0;break}}if(!r)return!1}return t.currentRetryAttempt=t.currentRetryAttempt||0,!(t.currentRetryAttempt>=t.retry)}function i(e){if(e&&e.config&&e.config.retryConfig)return e.config.retryConfig}Object.defineProperty(t,"__esModule",{value:!0}),t.getRetryConfig=r},6621:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthClient=t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=t.DEFAULT_UNIVERSE=void 0;let n=r(2361),i=r(206),s=r(6538),o=r(5348),a=r(4574);t.DEFAULT_UNIVERSE="googleapis.com",t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class l extends n.EventEmitter{apiKey;projectId;quotaProjectId;transporter;credentials={};eagerRefreshThresholdMillis=t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS;forceRefreshOnFailure=!1;universeDomain=t.DEFAULT_UNIVERSE;static RequestMethodNameSymbol=Symbol("request method name");static RequestLogIdSymbol=Symbol("request log id");constructor(e={}){super();let r=(0,s.originalOrCamelOptions)(e);this.apiKey=e.apiKey,this.projectId=r.get("project_id")??null,this.quotaProjectId=r.get("quota_project_id"),this.credentials=r.get("credentials")??{},this.universeDomain=r.get("universe_domain")??t.DEFAULT_UNIVERSE,this.transporter=e.transporter??new i.Gaxios(e.transporterOptions),!1!==r.get("useAuthRequestParameters")&&(this.transporter.interceptors.request.add(l.DEFAULT_REQUEST_INTERCEPTOR),this.transporter.interceptors.response.add(l.DEFAULT_RESPONSE_INTERCEPTOR)),e.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=e.forceRefreshOnFailure??!1}fetch(...e){let t;let r=e[0],n=e[1],s=new Headers;return("string"==typeof r?t=new URL(r):r instanceof URL?t=r:r&&r.url&&(t=new URL(r.url)),r&&"object"==typeof r&&"headers"in r&&i.Gaxios.mergeHeaders(s,r.headers),n&&i.Gaxios.mergeHeaders(s,new Headers(n.headers)),"object"!=typeof r||r instanceof URL)?this.request({...n,headers:s,url:t}):this.request({...n,...r,headers:s,url:t})}setCredentials(e){this.credentials=e}addSharedMetadataHeaders(e){return!e.has("x-goog-user-project")&&this.quotaProjectId&&e.set("x-goog-user-project",this.quotaProjectId),e}addUserProjectAndAuthHeaders(e,t){let r=t.get("x-goog-user-project"),n=t.get("authorization");return r&&e.set("x-goog-user-project",r),n&&e.set("authorization",n),e}static log=(0,o.log)("auth");static DEFAULT_REQUEST_INTERCEPTOR={resolved:async e=>{if(!e.headers.has("x-goog-api-client")){let t=process.version.replace(/^v/,"");e.headers.set("x-goog-api-client",`gl-node/${t}`)}let t=e.headers.get("User-Agent");t?t.includes(`${a.PRODUCT_NAME}/`)||e.headers.set("User-Agent",`${t} ${a.USER_AGENT}`):e.headers.set("User-Agent",a.USER_AGENT);try{let t=e[l.RequestMethodNameSymbol],r=`${Math.floor(1e3*Math.random())}`;e[l.RequestLogIdSymbol]=r;let n={url:e.url,headers:e.headers};t?l.log.info("%s [%s] request %j",t,r,n):l.log.info("[%s] request %j",r,n)}catch(e){}return e}};static DEFAULT_RESPONSE_INTERCEPTOR={resolved:async e=>{try{let t=e.config,r=t[l.RequestMethodNameSymbol],n=t[l.RequestLogIdSymbol];r?l.log.info("%s [%s] response %j",r,n,e.data):l.log.info("[%s] response %j",n,e.data)}catch(e){}return e},rejected:async e=>{try{let t=e.config,r=t[l.RequestMethodNameSymbol],n=t[l.RequestLogIdSymbol];r?l.log.info("%s [%s] error %j",r,n,e.response?.data):l.log.error("[%s] error %j",n,e.response?.data)}catch(e){}throw e}};static setMethodName(e,t){try{e[l.RequestMethodNameSymbol]=t}catch(e){}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}t.AuthClient=l},3321:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsClient=void 0;let n=r(3676),i=r(3318),s=r(9038),o=r(6538),a=r(206);class l extends i.BaseExternalAccountClient{environmentId;awsSecurityCredentialsSupplier;regionalCredVerificationUrl;awsRequestSigner;region;static #u="https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15";static AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";static AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254";constructor(e){super(e);let t=(0,o.originalOrCamelOptions)(e),r=t.get("credential_source"),n=t.get("aws_security_credentials_supplier");if(!r&&!n)throw Error("A credential source or AWS security credentials supplier must be specified.");if(r&&n)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(n)this.awsSecurityCredentialsSupplier=n,this.regionalCredVerificationUrl=l.#u,this.credentialSourceType="programmatic";else{let e=(0,o.originalOrCamelOptions)(r);this.environmentId=e.get("environment_id");let t=e.get("region_url"),n=e.get("url"),i=e.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new s.DefaultAwsSecurityCredentialsSupplier({regionUrl:t,securityCredentialsUrl:n,imdsV2SessionTokenUrl:i}),this.regionalCredVerificationUrl=e.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){let e=this.environmentId?.match(/^(aws)(\d+)$/);if(e&&this.regionalCredVerificationUrl){if(1!==parseInt(e[2],10))throw Error(`aws version "${e[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new n.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let e=await this.awsRequestSigner.getRequestOptions({...l.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),t=[];return a.Gaxios.mergeHeaders({"x-goog-cloud-target-resource":this.audience},e.headers).forEach((e,r)=>t.push({key:r,value:e})),encodeURIComponent(JSON.stringify({url:e.url,method:e.method,headers:t}))}}t.AwsClient=l},3676:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsRequestSigner=void 0;let n=r(206),i=r(537),s="AWS4-HMAC-SHA256";class o{getCredentials;region;crypto;constructor(e,t){this.getCredentials=e,this.region=t,this.crypto=(0,i.createCrypto)()}async getRequestOptions(e){if(!e.url)throw RangeError('"url" is required in "amzOptions"');let t="object"==typeof e.data?JSON.stringify(e.data):e.data,r=e.url,i=e.method||"GET",s=e.body||t,o=e.headers,a=await this.getCredentials(),l=new URL(r);if("string"!=typeof s&&void 0!==s)throw TypeError(`'requestPayload' is expected to be a string if provided. Got: ${s}`);let c=await u({crypto:this.crypto,host:l.host,canonicalUri:l.pathname,canonicalQuerystring:l.search.slice(1),method:i,region:this.region,securityCredentials:a,requestPayload:s,additionalAmzHeaders:o}),d=n.Gaxios.mergeHeaders(c.amzDate?{"x-amz-date":c.amzDate}:{},{authorization:c.authorizationHeader,host:l.host},o||{});a.token&&n.Gaxios.mergeHeaders(d,{"x-amz-security-token":a.token});let p={url:r,method:i,headers:d};return void 0!==s&&(p.body=s),p}}async function a(e,t,r){return await e.signWithHmacSha256(t,r)}async function l(e,t,r,n,i){let s=await a(e,`AWS4${t}`,r),o=await a(e,s,n),l=await a(e,o,i);return await a(e,l,"aws4_request")}async function u(e){let t=n.Gaxios.mergeHeaders(e.additionalAmzHeaders),r=e.requestPayload||"",o=e.host.split(".")[0],u=new Date,c=u.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),d=u.toISOString().replace(/[-]/g,"").replace(/T.*/,"");e.securityCredentials.token&&t.set("x-amz-security-token",e.securityCredentials.token);let p=n.Gaxios.mergeHeaders({host:e.host},t.has("date")?{}:{"x-amz-date":c},t),h="",f=[...p.keys()].sort();f.forEach(e=>{h+=`${e}:${p.get(e)}
`});let m=f.join(";"),g=await e.crypto.sha256DigestHex(r),y=`${e.method.toUpperCase()}
${e.canonicalUri}
${e.canonicalQuerystring}
${h}
${m}
${g}`,v=`${d}/${e.region}/${o}/aws4_request`,_=`${s}
${c}
${v}
`+await e.crypto.sha256DigestHex(y),b=await l(e.crypto,e.securityCredentials.secretAccessKey,d,e.region,o),E=await a(e.crypto,b,_),x=`${s} Credential=${e.securityCredentials.accessKeyId}/${v}, SignedHeaders=${m}, Signature=${(0,i.fromArrayBufferToHex)(E)}`;return{amzDate:t.has("date")?void 0:c,authorizationHeader:x,canonicalQuerystring:e.canonicalQuerystring}}t.AwsRequestSigner=o},3318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseExternalAccountClient=t.CLOUD_RESOURCE_MANAGER=t.EXTERNAL_ACCOUNT_TYPE=t.EXPIRATION_TIME_OFFSET=void 0;let n=r(206),i=r(2781),s=r(6621),o=r(984),a=r(6538),l=r(4574),u="https://www.googleapis.com/auth/cloud-platform";t.EXPIRATION_TIME_OFFSET=3e5,t.EXTERNAL_ACCOUNT_TYPE="external_account",t.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";class c extends s.AuthClient{scopes;projectNumber;audience;subjectTokenType;stsCredential;clientAuth;credentialSourceType;cachedAccessToken;serviceAccountImpersonationUrl;serviceAccountImpersonationLifetime;workforcePoolUserProject;configLifetimeRequested;tokenUrl;cloudResourceManagerURL;supplierContext;#c=null;constructor(e){super(e);let r=(0,a.originalOrCamelOptions)(e),n=r.get("type");if(n&&n!==t.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${t.EXTERNAL_ACCOUNT_TYPE}" type but received "${e.type}"`);let i=r.get("client_id"),s=r.get("client_secret");this.tokenUrl=r.get("token_url")??"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain);let l=r.get("subject_token_type"),c=r.get("workforce_pool_user_project"),d=r.get("service_account_impersonation_url"),p=r.get("service_account_impersonation"),h=(0,a.originalOrCamelOptions)(p).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(r.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),i&&(this.clientAuth={confidentialClientType:"basic",clientId:i,clientSecret:s}),this.stsCredential=new o.StsCredentials({tokenExchangeEndpoint:this.tokenUrl,clientAuthentication:this.clientAuth}),this.scopes=r.get("scopes")||[u],this.cachedAccessToken=null,this.audience=r.get("audience"),this.subjectTokenType=l,this.workforcePoolUserProject=c;let f=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(f))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=d,this.serviceAccountImpersonationLifetime=h,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let e=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return e?.groups?.email||null}return null}setCredentials(e){super.setCredentials(e),this.cachedAccessToken=e}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t=new Headers({authorization:`Bearer ${e.token}`});return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async getProjectId(){let e=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(e){let t=await this.getRequestHeaders(),r={...c.RETRY_CONFIG,headers:t,url:`${this.cloudResourceManagerURL.toString()}${e}`};s.AuthClient.setMethodName(r,"getProjectId");let n=await this.transporter.request(r);return this.projectId=n.data.projectId,this.projectId}return null}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=n.Gaxios.mergeHeaders(e.headers),this.addUserProjectAndAuthHeaders(e.headers,t),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,s=r.config.data instanceof i.Readable;if(!t&&(401===n||403===n)&&!s&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw n}return r}async refreshAccessTokenAsync(){this.#c=this.#c||this.#d();try{return await this.#c}finally{this.#c=null}}async #d(){let e=await this.retrieveSubjectToken(),t={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:e,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[u]:this.getScopesArray()},r=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,n=new Headers({"x-goog-api-client":this.getMetricsHeaderValue()}),i=await this.stsCredential.exchangeToken(t,n,r);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(i.access_token):i.expires_in?this.cachedAccessToken={access_token:i.access_token,expiry_date:new Date().getTime()+1e3*i.expires_in,res:i.res}:this.cachedAccessToken={access_token:i.access_token,res:i.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}getProjectNumber(e){let t=e.match(/\/projects\/([^/]+)/);return t?t[1]:null}async getImpersonatedAccessToken(e){let t={...c.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${e}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"}};s.AuthClient.setMethodName(t,"getImpersonatedAccessToken");let r=await this.transporter.request(t),n=r.data;return{access_token:n.accessToken,expiry_date:new Date(n.expireTime).getTime(),res:r}}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[u]}getMetricsHeaderValue(){let e=process.version.replace(/^v/,""),t=void 0!==this.serviceAccountImpersonationUrl,r=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${e} auth/${l.pkg.version} google-byoid-sdk source/${r} sa-impersonation/${t} config-lifetime/${this.configLifetimeRequested}`}getTokenUrl(){return this.tokenUrl}}t.BaseExternalAccountClient=c},8332:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CertificateSubjectTokenSupplier=t.InvalidConfigurationError=t.CertificateSourceUnavailableError=t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE=void 0;let n=r(6538),i=r(7147),s=r(6113),o=r(5687);t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE="GOOGLE_API_CERTIFICATE_CONFIG";class a extends Error{constructor(e){super(e),this.name="CertificateSourceUnavailableError"}}t.CertificateSourceUnavailableError=a;class l extends Error{constructor(e){super(e),this.name="InvalidConfigurationError"}}t.InvalidConfigurationError=l;class u{certificateConfigPath;trustChainPath;cert;key;constructor(e){if(!e.useDefaultCertificateConfig&&!e.certificateConfigLocation)throw new l("Either `useDefaultCertificateConfig` must be true or a `certificateConfigLocation` must be provided.");if(e.useDefaultCertificateConfig&&e.certificateConfigLocation)throw new l("Both `useDefaultCertificateConfig` and `certificateConfigLocation` cannot be provided.");this.trustChainPath=e.trustChainPath,this.certificateConfigPath=e.certificateConfigLocation??""}async createMtlsHttpsAgent(){if(!this.key||!this.cert)throw new l("Cannot create mTLS Agent with missing certificate or key");return new o.Agent({key:this.key,cert:this.cert})}async getSubjectToken(){this.certificateConfigPath=await this.#p();let{certPath:e,keyPath:t}=await this.#h();return{cert:this.cert,key:this.key}=await this.#f(e,t),await this.#m(this.cert)}async #p(){let e=this.certificateConfigPath;if(e){if(await (0,n.isValidFile)(e))return e;throw new a(`Provided certificate config path is invalid: ${e}`)}let r=process.env[t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE];if(r){if(await (0,n.isValidFile)(r))return r;throw new a(`Path from environment variable "${t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" is invalid: ${r}`)}let i=(0,n.getWellKnownCertificateConfigFileLocation)();if(await (0,n.isValidFile)(i))return i;throw new a(`Could not find certificate configuration file. Searched override path, the "${t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" env var, and the gcloud path (${i}).`)}async #h(){let e;let t=this.certificateConfigPath;try{e=await i.promises.readFile(t,"utf8")}catch(e){throw new a(`Failed to read certificate config file at: ${t}`)}try{let r=JSON.parse(e),n=r?.cert_configs?.workload?.cert_path,i=r?.cert_configs?.workload?.key_path;if(!n||!i)throw new l(`Certificate config file (${t}) is missing required "cert_path" or "key_path" in the workload config.`);return{certPath:n,keyPath:i}}catch(e){if(e instanceof l)throw e;throw new l(`Failed to parse certificate config from ${t}: ${e.message}`)}}async #f(e,t){let r,n;try{r=await i.promises.readFile(e),new s.X509Certificate(r)}catch(r){let t=r instanceof Error?r.message:String(r);throw new a(`Failed to read certificate file at ${e}: ${t}`)}try{n=await i.promises.readFile(t),(0,s.createPrivateKey)(n)}catch(r){let e=r instanceof Error?r.message:String(r);throw new a(`Failed to read private key file at ${t}: ${e}`)}return{cert:r,key:n}}async #m(e){let t=new s.X509Certificate(e);if(!this.trustChainPath)return JSON.stringify([t.raw.toString("base64")]);try{let e;let r=((await i.promises.readFile(this.trustChainPath,"utf8")).match(/-----BEGIN CERTIFICATE-----[^-]+-----END CERTIFICATE-----/g)??[]).map((e,t)=>{try{return new s.X509Certificate(e)}catch(r){let e=r instanceof Error?r.message:String(r);throw new l(`Failed to parse certificate at index ${t} in trust chain file ${this.trustChainPath}: ${e}`)}}),n=r.findIndex(e=>t.raw.equals(e.raw));if(-1===n)e=[t,...r];else if(0===n)e=r;else throw new l(`Leaf certificate exists in the trust chain but is not the first entry (found at index ${n}).`);return JSON.stringify(e.map(e=>e.raw.toString("base64")))}catch(t){if(t instanceof l)throw t;let e=t instanceof Error?t.message:String(t);throw new a(`Failed to process certificate chain from ${this.trustChainPath}: ${e}`)}}}t.CertificateSubjectTokenSupplier=u},902:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Compute=void 0;let n=r(206),i=r(759),s=r(3490);class o extends s.OAuth2Client{serviceAccountEmail;scopes;constructor(e={}){super(e),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=e.serviceAccountEmail||"default",this.scopes=Array.isArray(e.scopes)?e.scopes:e.scopes?[e.scopes]:[]}async refreshTokenNoCache(){let e;let t=`service-accounts/${this.serviceAccountEmail}/token`;try{let r={property:t};this.scopes.length>0&&(r.params={scopes:this.scopes.join(",")}),e=await i.instance(r)}catch(e){throw e instanceof n.GaxiosError&&(e.message=`Could not refresh access token: ${e.message}`,this.wrapError(e)),e}let r=e;return e&&e.expires_in&&(r.expiry_date=new Date().getTime()+1e3*e.expires_in,delete r.expires_in),this.emit("tokens",r),{tokens:r,res:null}}async fetchIdToken(e){let t;let r=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${e}`;try{t=await i.instance({property:r})}catch(e){throw e instanceof Error&&(e.message=`Could not fetch ID token: ${e.message}`),e}return t}wrapError(e){let t=e.response;t&&t.status&&(e.status=t.status,403===t.status?e.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+e.message:404===t.status&&(e.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+e.message))}}t.Compute=o},9038:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultAwsSecurityCredentialsSupplier=void 0;let n=r(6621);class i{regionUrl;securityCredentialsUrl;imdsV2SessionTokenUrl;additionalGaxiosOptions;constructor(e){this.regionUrl=e.regionUrl,this.securityCredentialsUrl=e.securityCredentialsUrl,this.imdsV2SessionTokenUrl=e.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=e.additionalGaxiosOptions}async getAwsRegion(e){if(this.#g)return this.#g;let t=new Headers;if(!this.#g&&this.imdsV2SessionTokenUrl&&t.set("x-aws-ec2-metadata-token",await this.#y(e.transporter)),!this.regionUrl)throw RangeError('Unable to determine AWS region due to missing "options.credential_source.region_url"');let r={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",headers:t};n.AuthClient.setMethodName(r,"getAwsRegion");let i=await e.transporter.request(r);return i.data.substr(0,i.data.length-1)}async getAwsSecurityCredentials(e){if(this.#v)return this.#v;let t=new Headers;this.imdsV2SessionTokenUrl&&t.set("x-aws-ec2-metadata-token",await this.#y(e.transporter));let r=await this.#_(t,e.transporter),n=await this.#b(r,t,e.transporter);return{accessKeyId:n.AccessKeyId,secretAccessKey:n.SecretAccessKey,token:n.Token}}async #y(e){let t={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return n.AuthClient.setMethodName(t,"#getImdsV2SessionToken"),(await e.request(t)).data}async #_(e,t){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let r={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",headers:e};return n.AuthClient.setMethodName(r,"#getAwsRoleName"),(await t.request(r)).data}async #b(e,t,r){let i={...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${e}`,headers:t};return n.AuthClient.setMethodName(i,"#retrieveAwsSecurityCredentials"),(await r.request(i)).data}get #g(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null}get #v(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}}t.DefaultAwsSecurityCredentialsSupplier=i},3651:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownscopedClient=t.EXPIRATION_TIME_OFFSET=t.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let n=r(206),i=r(2781),s=r(6621),o=r(984);t.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,t.EXPIRATION_TIME_OFFSET=3e5;class a extends s.AuthClient{authClient;credentialAccessBoundary;cachedDownscopedAccessToken;stsCredential;constructor(e,r={accessBoundary:{accessBoundaryRules:[]}}){if(super(e instanceof s.AuthClient?{}:e),e instanceof s.AuthClient?(this.authClient=e,this.credentialAccessBoundary=r):(this.authClient=e.authClient,this.credentialAccessBoundary=e.credentialAccessBoundary),0===this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length>t.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${t.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(let e of this.credentialAccessBoundary.accessBoundary.accessBoundaryRules)if(0===e.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new o.StsCredentials({tokenExchangeEndpoint:`https://sts.${this.universeDomain}/v1/token`}),this.cachedDownscopedAccessToken=null}setCredentials(e){if(!e.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(e),this.cachedDownscopedAccessToken=e}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t=new Headers({authorization:`Bearer ${e.token}`});return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=n.Gaxios.mergeHeaders(e.headers),this.addUserProjectAndAuthHeaders(e.headers,t),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,s=r.config.data instanceof i.Readable;if(!t&&(401===n||403===n)&&!s&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw n}return r}async refreshAccessTokenAsync(){let e=(await this.authClient.getAccessToken()).token,t=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:e,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),r=this.authClient.credentials?.expiry_date||null,n=t.expires_in?new Date().getTime()+1e3*t.expires_in:r;return this.cachedDownscopedAccessToken={access_token:t.access_token,expiry_date:n,res:t.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}}t.DownscopedClient=a},1215:(e,t,r)=>{"use strict";var n;let i;Object.defineProperty(t,"__esModule",{value:!0}),t.GCPEnv=void 0,t.clear=function(){i=void 0},t.getEnv=o;let s=r(759);async function o(){return i||(i=a())}async function a(){return n.NONE,process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?n.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?n.CLOUD_FUNCTIONS:await u()?await l()?n.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?n.CLOUD_RUN:process.env.CLOUD_RUN_JOB?n.CLOUD_RUN_JOBS:n.COMPUTE_ENGINE:n.NONE}async function l(){try{return await s.instance("attributes/cluster-name"),!0}catch(e){return!1}}async function u(){return s.isAvailable()}!function(e){e.APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.CLOUD_RUN="CLOUD_RUN",e.CLOUD_RUN_JOBS="CLOUD_RUN_JOBS",e.NONE="NONE"}(n||(t.GCPEnv=n={}))},9402:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidSubjectTokenError=t.InvalidMessageFieldError=t.InvalidCodeFieldError=t.InvalidTokenTypeFieldError=t.InvalidExpirationTimeFieldError=t.InvalidSuccessFieldError=t.InvalidVersionFieldError=t.ExecutableResponseError=t.ExecutableResponse=void 0;let r="urn:ietf:params:oauth:token-type:saml2",n="urn:ietf:params:oauth:token-type:id_token",i="urn:ietf:params:oauth:token-type:jwt";class s{version;success;expirationTime;tokenType;errorCode;errorMessage;subjectToken;constructor(e){if(!e.version)throw new a("Executable response must contain a 'version' field.");if(void 0===e.success)throw new l("Executable response must contain a 'success' field.");if(this.version=e.version,this.success=e.success,this.success){if(this.expirationTime=e.expiration_time,this.tokenType=e.token_type,this.tokenType!==r&&this.tokenType!==n&&this.tokenType!==i)throw new c(`Executable response must contain a 'token_type' field when successful and it must be one of ${n}, ${i}, or ${r}.`);if(this.tokenType===r){if(!e.saml_response)throw new h(`Executable response must contain a 'saml_response' field when token_type=${r}.`);this.subjectToken=e.saml_response}else{if(!e.id_token)throw new h(`Executable response must contain a 'id_token' field when token_type=${n} or ${i}.`);this.subjectToken=e.id_token}}else{if(!e.code)throw new d("Executable response must contain a 'code' field when unsuccessful.");if(!e.message)throw new p("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=e.code,this.errorMessage=e.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}}t.ExecutableResponse=s;class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}t.ExecutableResponseError=o;class a extends o{}t.InvalidVersionFieldError=a;class l extends o{}t.InvalidSuccessFieldError=l;class u extends o{}t.InvalidExpirationTimeFieldError=u;class c extends o{}t.InvalidTokenTypeFieldError=c;class d extends o{}t.InvalidCodeFieldError=d;class p extends o{}t.InvalidMessageFieldError=p;class h extends o{}t.InvalidSubjectTokenError=h},3006:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalAccountAuthorizedUserClient=t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let n=r(6621),i=r(1673),s=r(206),o=r(2781),a=r(3318);t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class l extends i.OAuthClientAuthHandler{#E;constructor(e){super(e),this.#E=e.tokenRefreshEndpoint}async refreshToken(e,t){let r={...l.RETRY_CONFIG,url:this.#E,method:"POST",headers:t,data:new URLSearchParams({grant_type:"refresh_token",refresh_token:e})};n.AuthClient.setMethodName(r,"refreshToken"),this.applyClientAuthenticationOptions(r);try{let e=await this.transporter.request(r),t=e.data;return t.res=e,t}catch(e){if(e instanceof s.GaxiosError&&e.response)throw(0,i.getErrorFromOAuthErrorResponse)(e.response.data,e);throw e}}}class u extends n.AuthClient{cachedAccessToken;externalAccountAuthorizedUserHandler;refreshToken;constructor(e){super(e),e.universe_domain&&(this.universeDomain=e.universe_domain),this.refreshToken=e.refresh_token;let t={confidentialClientType:"basic",clientId:e.client_id,clientSecret:e.client_secret};this.externalAccountAuthorizedUserHandler=new l({tokenRefreshEndpoint:e.token_url??"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),transporter:this.transporter,clientAuthentication:t}),this.cachedAccessToken=null,this.quotaProjectId=e.quota_project_id,"number"!=typeof e?.eagerRefreshThresholdMillis?this.eagerRefreshThresholdMillis=a.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!e?.forceRefreshOnFailure}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t=new Headers({authorization:`Bearer ${e.token}`});return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=s.Gaxios.mergeHeaders(e.headers),this.addUserProjectAndAuthHeaders(e.headers,t),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,i=r.config.data instanceof o.Readable;if(!t&&(401===n||403===n)&&!i&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw n}return r}async refreshAccessTokenAsync(){let e=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res},void 0!==e.refresh_token&&(this.refreshToken=e.refresh_token),this.cachedAccessToken}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}}t.ExternalAccountAuthorizedUserClient=u},9273:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalAccountClient=void 0;let n=r(3318),i=r(9201),s=r(3321),o=r(4462);class a{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(e){return e&&e.type===n.EXTERNAL_ACCOUNT_TYPE?e.credential_source?.environment_id?new s.AwsClient(e):e.credential_source?.executable?new o.PluggableAuthClient(e):new i.IdentityPoolClient(e):null}}t.ExternalAccountClient=a},2986:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSubjectTokenSupplier=void 0;let n=r(3837),i=r(7147),s=(0,n.promisify)(i.readFile??(()=>{})),o=(0,n.promisify)(i.realpath??(()=>{})),a=(0,n.promisify)(i.lstat??(()=>{}));class l{filePath;formatType;subjectTokenFieldName;constructor(e){this.filePath=e.filePath,this.formatType=e.formatType,this.subjectTokenFieldName=e.subjectTokenFieldName}async getSubjectToken(){let e,t=this.filePath;try{if(t=await o(t),!(await a(t)).isFile())throw Error()}catch(e){throw e instanceof Error&&(e.message=`The file at ${t} does not exist, or it is not a file. ${e.message}`),e}let r=await s(t,{encoding:"utf8"});if("text"===this.formatType?e=r:"json"===this.formatType&&this.subjectTokenFieldName&&(e=JSON.parse(r)[this.subjectTokenFieldName]),!e)throw Error("Unable to parse the subject_token from the credential_source file");return e}}t.FileSubjectTokenSupplier=l},6614:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAuth=t.GoogleAuthExceptionMessages=void 0;let n=r(2081),i=r(7147),s=r(206),o=r(759),a=r(2037),l=r(1017),u=r(537),c=r(902),d=r(502),p=r(1215),h=r(1316),f=r(7065),m=r(2119),g=r(9273),y=r(3318),v=r(6621),_=r(3006),b=r(6538);t.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"};class E{checkIsGCE=void 0;useJWTAccessWithScope;defaultServicePath;get isGCE(){return this.checkIsGCE}_findProjectIdPromise;_cachedProjectId;jsonContent=null;apiKey;cachedCredential=null;#x=null;defaultScopes;keyFilename;scopes;clientOptions={};constructor(e={}){if(this._cachedProjectId=e.projectId||null,this.cachedCredential=e.authClient||null,this.keyFilename=e.keyFilename||e.keyFile,this.scopes=e.scopes,this.clientOptions=e.clientOptions||{},this.jsonContent=e.credentials||null,this.apiKey=e.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(t.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);e.universeDomain&&(this.clientOptions.universeDomain=e.universeDomain)}setGapicJWTValues(e){e.defaultServicePath=this.defaultServicePath,e.useJWTAccessWithScope=this.useJWTAccessWithScope,e.defaultScopes=this.defaultScopes}getProjectId(e){if(!e)return this.getProjectIdAsync();this.getProjectIdAsync().then(t=>e(null,t),e)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(e){if(e instanceof Error&&e.message===t.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw e}}async findAndCacheProjectId(){let e=null;if(e||=await this.getProductionProjectId(),e||=await this.getFileProjectId(),e||=await this.getDefaultServiceProjectId(),e||=await this.getGCEProjectId(),e||=await this.getExternalAccountClientProjectId())return this._cachedProjectId=e,e;throw Error(t.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){let e;try{e=await o.universe("universe-domain"),e||=v.DEFAULT_UNIVERSE}catch(t){if(t&&t?.response?.status===404)e=v.DEFAULT_UNIVERSE;else throw t}return e}async getUniverseDomain(){let e=(0,b.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{e??=(await this.getClient()).universeDomain}catch{e??=v.DEFAULT_UNIVERSE}return e}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(e={},t){let r;if("function"==typeof e?t=e:r=e,!t)return this.getApplicationDefaultAsync(r);this.getApplicationDefaultAsync(r).then(e=>t(null,e.credential,e.projectId),t)}async getApplicationDefaultAsync(e={}){let r;if(this.cachedCredential)return await this.#w(this.cachedCredential,null);if((r=await this._tryGetApplicationCredentialsFromEnvironmentVariable(e))||(r=await this._tryGetApplicationCredentialsFromWellKnownFile(e)))return r instanceof h.JWT?r.scopes=this.scopes:r instanceof y.BaseExternalAccountClient&&(r.scopes=this.getAnyScopes()),await this.#w(r);if(await this._checkIsGCE())return e.scopes=this.getAnyScopes(),await this.#w(new c.Compute(e));throw Error(t.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async #w(e,t=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let r=await this.getProjectIdOptional();return t&&(e.quotaProjectId=t),this.cachedCredential=e,{credential:e,projectId:r}}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=o.getGCPResidency()||await o.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(e){let t=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!t||0===t.length)return null;try{return this._getApplicationCredentialsFromFilePath(t,e)}catch(e){throw e instanceof Error&&(e.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${e.message}`),e}}async _tryGetApplicationCredentialsFromWellKnownFile(e){let t=null;if(this._isWindows())t=process.env.APPDATA;else{let e=process.env.HOME;e&&(t=l.join(e,".config"))}return(t&&(t=l.join(t,"gcloud","application_default_credentials.json"),i.existsSync(t)||(t=null)),t)?await this._getApplicationCredentialsFromFilePath(t,e):null}async _getApplicationCredentialsFromFilePath(e,t={}){if(!e||0===e.length)throw Error("The file path is invalid.");try{if(e=i.realpathSync(e),!i.lstatSync(e).isFile())throw Error()}catch(t){throw t instanceof Error&&(t.message=`The file at ${e} does not exist, or it is not a file. ${t.message}`),t}let r=i.createReadStream(e);return this.fromStream(r,t)}fromImpersonatedJSON(e){if(!e)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(e.type!==m.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${m.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!e.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!e.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let t=this.fromJSON(e.source_credentials);if(e.service_account_impersonation_url?.length>256)throw RangeError(`Target principal is too long: ${e.service_account_impersonation_url}`);let r=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(e.service_account_impersonation_url)?.groups?.target;if(!r)throw RangeError(`Cannot extract target principal from ${e.service_account_impersonation_url}`);let n=(this.scopes||e.scopes||this.defaultScopes)??[];return new m.Impersonated({...e,sourceClient:t,targetPrincipal:r,targetScopes:Array.isArray(n)?n:[n]})}fromJSON(e,t={}){let r;let n=(0,b.originalOrCamelOptions)(t).get("universe_domain");return e.type===f.USER_REFRESH_ACCOUNT_TYPE?(r=new f.UserRefreshClient(t)).fromJSON(e):e.type===m.IMPERSONATED_ACCOUNT_TYPE?r=this.fromImpersonatedJSON(e):e.type===y.EXTERNAL_ACCOUNT_TYPE?(r=g.ExternalAccountClient.fromJSON({...e,...t})).scopes=this.getAnyScopes():e.type===_.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?r=new _.ExternalAccountAuthorizedUserClient({...e,...t}):(t.scopes=this.scopes,r=new h.JWT(t),this.setGapicJWTValues(r),r.fromJSON(e)),n&&(r.universeDomain=n),r}_cacheClientFromJSON(e,t){let r=this.fromJSON(e,t);return this.jsonContent=e,this.cachedCredential=r,r}fromStream(e,t={},r){let n={};if("function"==typeof t?r=t:n=t,!r)return this.fromStreamAsync(e,n);this.fromStreamAsync(e,n).then(e=>r(null,e),r)}fromStreamAsync(e,t){return new Promise((r,n)=>{if(!e)throw Error("Must pass in a stream containing the Google auth settings.");let i=[];e.setEncoding("utf8").on("error",n).on("data",e=>i.push(e)).on("end",()=>{try{try{let e=JSON.parse(i.join("")),n=this._cacheClientFromJSON(e,t);return r(n)}catch(t){if(!this.keyFilename)throw t;let e=new h.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=e,this.setGapicJWTValues(e),r(e)}}catch(e){return n(e)}})})}fromAPIKey(e,t={}){return new h.JWT({...t,apiKey:e})}_isWindows(){let e=a.platform();return!!e&&e.length>=3&&"win"===e.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(e=>{(0,n.exec)("gcloud config config-helper --format json",(t,r)=>{if(!t&&r)try{let t=JSON.parse(r).configuration.properties.core.project;e(t);return}catch(e){}e(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let e=await this.getClient();if(e&&e.projectId)return e.projectId}let e=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return e?e.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==y.EXTERNAL_ACCOUNT_TYPE)return null;let e=await this.getClient();return await e.getProjectId()}async getGCEProjectId(){try{return await o.project("project-id")}catch(e){return null}}getCredentials(e){if(!e)return this.getCredentialsAsync();this.getCredentialsAsync().then(t=>e(null,t),e)}async getCredentialsAsync(){let e=await this.getClient();if(e instanceof m.Impersonated)return{client_email:e.getTargetPrincipal()};if(e instanceof y.BaseExternalAccountClient){let t=e.getServiceAccountEmail();if(t)return{client_email:t,universe_domain:e.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[e,t]=await Promise.all([o.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:e,universe_domain:t}}throw Error(t.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;this.#x=this.#x||this.#A();try{return await this.#x}finally{this.#x=null}}async #A(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let e=l.resolve(this.keyFilename),t=i.createReadStream(e);return await this.fromStreamAsync(t,this.clientOptions)}if(this.apiKey){let e=await this.fromAPIKey(this.apiKey,this.clientOptions);e.scopes=this.scopes;let{credential:t}=await this.#w(e);return t}{let{credential:e}=await this.getApplicationDefaultAsync(this.clientOptions);return e}}async getIdTokenClient(e){let t=await this.getClient();if(!("fetchIdToken"in t))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new d.IdTokenClient({targetAudience:e,idTokenProvider:t})}async getAccessToken(){let e=await this.getClient();return(await e.getAccessToken()).token}async getRequestHeaders(e){return(await this.getClient()).getRequestHeaders(e)}async authorizeRequest(e={}){let t=e.url,r=await this.getClient(),n=await r.getRequestHeaders(t);return e.headers=s.Gaxios.mergeHeaders(e.headers,n),e}async fetch(...e){return(await this.getClient()).fetch(...e)}async request(e){return(await this.getClient()).request(e)}getEnv(){return(0,p.getEnv)()}async sign(e,t){let r=await this.getClient(),n=await this.getUniverseDomain();if(t=t||`https://iamcredentials.${n}/v1/projects/-/serviceAccounts/`,r instanceof m.Impersonated)return(await r.sign(e)).signedBlob;let i=(0,u.createCrypto)();if(r instanceof h.JWT&&r.key)return await i.sign(r.key,e);let s=await this.getCredentials();if(!s.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(i,s.client_email,e,t)}async signBlob(e,t,r,n){let i=new URL(n+`${t}:signBlob`);return(await this.request({method:"POST",url:i.href,data:{payload:e.encodeBase64StringUtf8(r)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}t.GoogleAuth=E},9120:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IAMAuth=void 0;class r{selector;token;constructor(e,t){this.selector=e,this.token=t,this.selector=e,this.token=t}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}t.IAMAuth=r},9201:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityPoolClient=void 0;let n=r(3318),i=r(6538),s=r(2986),o=r(132),a=r(8332),l=r(984),u=r(206);class c extends n.BaseExternalAccountClient{subjectTokenSupplier;constructor(e){super(e);let t=(0,i.originalOrCamelOptions)(e),r=t.get("credential_source"),n=t.get("subject_token_supplier");if(!r&&!n)throw Error("A credential source or subject token supplier must be specified.");if(r&&n)throw Error("Only one of credential source or subject token supplier can be specified.");if(n)this.subjectTokenSupplier=n,this.credentialSourceType="programmatic";else{let e=(0,i.originalOrCamelOptions)(r),t=(0,i.originalOrCamelOptions)(e.get("format")),n=t.get("type")||"text",l=t.get("subject_token_field_name");if("json"!==n&&"text"!==n)throw Error(`Invalid credential_source format "${n}"`);if("json"===n&&!l)throw Error("Missing subject_token_field_name for JSON credential_source format");let u=e.get("file"),d=e.get("url"),p=e.get("certificate"),h=e.get("headers");if(u&&d||d&&p||u&&p)throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.');if(u)this.credentialSourceType="file",this.subjectTokenSupplier=new s.FileSubjectTokenSupplier({filePath:u,formatType:n,subjectTokenFieldName:l});else if(d)this.credentialSourceType="url",this.subjectTokenSupplier=new o.UrlSubjectTokenSupplier({url:d,formatType:n,subjectTokenFieldName:l,headers:h,additionalGaxiosOptions:c.RETRY_CONFIG});else if(p){this.credentialSourceType="certificate";let e=new a.CertificateSubjectTokenSupplier({useDefaultCertificateConfig:p.use_default_certificate_config,certificateConfigLocation:p.certificate_config_location,trustChainPath:p.trust_chain_path});this.subjectTokenSupplier=e}else throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.')}}async retrieveSubjectToken(){let e=await this.subjectTokenSupplier.getSubjectToken(this.supplierContext);if(this.subjectTokenSupplier instanceof a.CertificateSubjectTokenSupplier){let e=await this.subjectTokenSupplier.createMtlsHttpsAgent();this.stsCredential=new l.StsCredentials({tokenExchangeEndpoint:this.getTokenUrl(),clientAuthentication:this.clientAuth,transporter:new u.Gaxios({agent:e})}),this.transporter=new u.Gaxios({...this.transporter.defaults||{},agent:e})}return e}}t.IdentityPoolClient=c},502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdTokenClient=void 0;let n=r(3490);class i extends n.OAuth2Client{targetAudience;idTokenProvider;constructor(e){super(e),this.targetAudience=e.targetAudience,this.idTokenProvider=e.idTokenProvider}async getRequestMetadataAsync(){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let e=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:e,expiry_date:this.getIdTokenExpiryDate(e)}}return{headers:new Headers({authorization:"Bearer "+this.credentials.id_token})}}getIdTokenExpiryDate(e){let t=e.split(".")[1];if(t)return 1e3*JSON.parse(Buffer.from(t,"base64").toString("ascii")).exp}}t.IdTokenClient=i},2119:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Impersonated=t.IMPERSONATED_ACCOUNT_TYPE=void 0;let n=r(3490),i=r(206),s=r(6538);t.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class o extends n.OAuth2Client{sourceClient;targetPrincipal;targetScopes;delegates;lifetime;endpoint;constructor(e={}){if(super(e),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=e.sourceClient??new n.OAuth2Client,this.targetPrincipal=e.targetPrincipal??"",this.delegates=e.delegates??[],this.targetScopes=e.targetScopes??[],this.lifetime=e.lifetime??3600,(0,s.originalOrCamelOptions)(e).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=e.endpoint??`https://iamcredentials.${this.universeDomain}`}async sign(e){await this.sourceClient.getAccessToken();let t=`projects/-/serviceAccounts/${this.targetPrincipal}`,r=`${this.endpoint}/v1/${t}:signBlob`,n={delegates:this.delegates,payload:Buffer.from(e).toString("base64")};return(await this.sourceClient.request({...o.RETRY_CONFIG,url:r,data:n,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){try{await this.sourceClient.getAccessToken();let e="projects/-/serviceAccounts/"+this.targetPrincipal,t=`${this.endpoint}/v1/${e}:generateAccessToken`,r={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},n=await this.sourceClient.request({...o.RETRY_CONFIG,url:t,data:r,method:"POST"}),i=n.data;return this.credentials.access_token=i.accessToken,this.credentials.expiry_date=Date.parse(i.expireTime),{tokens:this.credentials,res:n}}catch(r){if(!(r instanceof Error))throw r;let e=0,t="";if(r instanceof i.GaxiosError&&(e=r?.response?.data?.error?.status,t=r?.response?.data?.error?.message),e&&t)throw r.message=`${e}: unable to impersonate: ${t}`,r;throw r.message=`unable to impersonate: ${r}`,r}}async fetchIdToken(e,t){await this.sourceClient.getAccessToken();let r=`projects/-/serviceAccounts/${this.targetPrincipal}`,n=`${this.endpoint}/v1/${r}:generateIdToken`,i={delegates:this.delegates,audience:e,includeEmail:t?.includeEmail??!0,useEmailAzp:t?.includeEmail??!0};return(await this.sourceClient.request({...o.RETRY_CONFIG,url:n,data:i,method:"POST"})).data.token}}t.Impersonated=o},7951:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWTAccess=void 0;let n=r(8287),i=r(6538),s={alg:"RS256",typ:"JWT"};class o{email;key;keyId;projectId;eagerRefreshThresholdMillis;cache=new i.LRUCache({capacity:500,maxAge:36e5});constructor(e,t,r,n){this.email=e,this.key=t,this.keyId=r,this.eagerRefreshThresholdMillis=n??3e5}getCachedKey(e,t){let r=e;if(t&&Array.isArray(t)&&t.length?r=e?`${e}_${t.join("_")}`:`${t.join("_")}`:"string"==typeof t&&(r=e?`${e}_${t}`:t),!r)throw Error("Scopes or url must be provided");return r}getRequestHeaders(e,t,r){let i;let a=this.getCachedKey(e,r),l=this.cache.get(a),u=Date.now();if(l&&l.expiration-u>this.eagerRefreshThresholdMillis)return new Headers(l.headers);let c=Math.floor(Date.now()/1e3),d=o.getExpirationTime(c);if(Array.isArray(r)&&(r=r.join(" ")),i=r?{iss:this.email,sub:this.email,scope:r,exp:d,iat:c}:{iss:this.email,sub:this.email,aud:e,exp:d,iat:c},t){for(let e in i)if(t[e])throw Error(`The '${e}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let p=this.keyId?{...s,kid:this.keyId}:s,h=Object.assign(i,t),f=n.sign({header:p,payload:h,secret:this.key}),m=new Headers({authorization:`Bearer ${f}`});return this.cache.set(a,{expiration:1e3*d,headers:m}),m}static getExpirationTime(e){return e+3600}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{e||r(Error("Must pass in a stream containing the service account auth settings."));let n="";e.setEncoding("utf8").on("data",e=>n+=e).on("error",r).on("end",()=>{try{let e=JSON.parse(n);this.fromJSON(e),t()}catch(e){r(e)}})})}}t.JWTAccess=o},1316:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWT=void 0;let n=r(1838),i=r(7951),s=r(3490),o=r(6621);class a extends s.OAuth2Client{email;keyFile;key;keyId;defaultScopes;scopes;scope;subject;gtoken;additionalClaims;useJWTAccessWithScope;defaultServicePath;access;constructor(e={}){super(e),this.email=e.email,this.keyFile=e.keyFile,this.key=e.key,this.keyId=e.keyId,this.scopes=e.scopes,this.subject=e.subject,this.additionalClaims=e.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(e){let t=new a(this);return t.scopes=e,t}async getRequestMetadataAsync(e){e=this.defaultServicePath?`https://${this.defaultServicePath}/`:e;let t=!this.hasUserScopes()&&e||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==o.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==o.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${o.DEFAULT_UNIVERSE}`);if(!this.apiKey&&t){if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:e}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders(new Headers({authorization:`Bearer ${e.id_token}`}))}}{let t;this.access||(this.access=new i.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?t=this.scopes:e||(t=this.defaultScopes);let r=this.useJWTAccessWithScope||this.universeDomain!==o.DEFAULT_UNIVERSE,n=await this.access.getRequestHeaders(e??void 0,this.additionalClaims,r?t:void 0);return{headers:this.addSharedMetadataHeaders(n)}}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(e):{headers:new Headers}}async fetchIdToken(e){let t=new n.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:e},transporter:this.transporter});if(await t.getToken({forceRefresh:!0}),!t.idToken)throw Error("Unknown error: Failed to fetch ID token");return t.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&this.scopes.length>0||!!this.defaultScopes&&this.defaultScopes.length>0}authorize(e){if(!e)return this.authorizeAsync();this.authorizeAsync().then(t=>e(null,t),e)}async authorizeAsync(){let e=await this.refreshToken();if(!e)throw Error("No result returned");return this.credentials=e.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,e.tokens}async refreshTokenNoCache(){let e=this.createGToken(),t={access_token:(await e.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:e.expiresAt,id_token:e.idToken};return this.emit("tokens",t),{res:null,tokens:t}}createGToken(){return this.gtoken||(this.gtoken=new n.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id,this.quotaProjectId=e.quota_project_id,this.universeDomain=e.universe_domain||this.universeDomain}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{if(!e)throw Error("Must pass in a stream containing the service account auth settings.");let n="";e.setEncoding("utf8").on("error",r).on("data",e=>n+=e).on("end",()=>{try{let e=JSON.parse(n);this.fromJSON(e),t()}catch(e){r(e)}})})}fromAPIKey(e){if("string"!=typeof e)throw Error("Must provide an API Key string.");this.apiKey=e}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let e=this.createGToken(),t=await e.getCredentials(this.keyFile);return{private_key:t.privateKey,client_email:t.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}t.JWT=a},434:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginTicket=void 0;class r{envelope;payload;constructor(e,t){this.envelope=e,this.payload=t}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let e=this.getPayload();return e&&e.sub?e.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}t.LoginTicket=r},3490:(e,t,r)=>{"use strict";var n,i,s;Object.defineProperty(t,"__esModule",{value:!0}),t.OAuth2Client=t.ClientAuthentication=t.CertificateFormat=t.CodeChallengeMethod=void 0;let o=r(206),a=r(3477),l=r(2781),u=r(3164),c=r(6538),d=r(537),p=r(6621),h=r(434);(function(e){e.Plain="plain",e.S256="S256"})(n||(t.CodeChallengeMethod=n={})),function(e){e.PEM="PEM",e.JWK="JWK"}(i||(t.CertificateFormat=i={})),function(e){e.ClientSecretPost="ClientSecretPost",e.ClientSecretBasic="ClientSecretBasic",e.None="None"}(s||(t.ClientAuthentication=s={}));class f extends p.AuthClient{redirectUri;certificateCache={};certificateExpiry=null;certificateCacheFormat=i.PEM;refreshTokenPromises=new Map;endpoints;issuers;clientAuthentication;_clientId;_clientSecret;refreshHandler;constructor(e={},t,r){super("object"==typeof e?e:{}),"object"!=typeof e&&(e={clientId:e,clientSecret:t,redirectUri:r}),this._clientId=e.clientId||e.client_id,this._clientSecret=e.clientSecret||e.client_secret,this.redirectUri=e.redirectUri||e.redirect_uris?.[0],this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...e.endpoints},this.clientAuthentication=e.clientAuthentication||s.ClientSecretPost,this.issuers=e.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}static GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo";static CLOCK_SKEW_SECS_=300;static DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400;generateAuthUrl(e={}){if(e.code_challenge_method&&!e.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return e.response_type=e.response_type||"code",e.client_id=e.client_id||this._clientId,e.redirect_uri=e.redirect_uri||this.redirectUri,Array.isArray(e.scope)&&(e.scope=e.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+a.stringify(e)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let e=(0,d.createCrypto)(),t=e.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),r=(await e.sha256DigestBase64(t)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:t,codeChallenge:r}}getToken(e,t){let r="string"==typeof e?{code:e}:e;if(!t)return this.getTokenAsync(r);this.getTokenAsync(r).then(e=>t(null,e.tokens,e.res),e=>t(e,null,e.response))}async getTokenAsync(e){let t=this.endpoints.oauth2TokenUrl.toString(),r=new Headers,n={client_id:e.client_id||this._clientId,code_verifier:e.codeVerifier,code:e.code,grant_type:"authorization_code",redirect_uri:e.redirect_uri||this.redirectUri};if(this.clientAuthentication===s.ClientSecretBasic){let e=Buffer.from(`${this._clientId}:${this._clientSecret}`);r.set("authorization",`Basic ${e.toString("base64")}`)}this.clientAuthentication===s.ClientSecretPost&&(n.client_secret=this._clientSecret);let i={...f.RETRY_CONFIG,method:"POST",url:t,data:new URLSearchParams((0,c.removeUndefinedValuesInObject)(n)),headers:r};p.AuthClient.setMethodName(i,"getTokenAsync");let o=await this.transporter.request(i),a=o.data;return o.data&&o.data.expires_in&&(a.expiry_date=new Date().getTime()+1e3*o.data.expires_in,delete a.expires_in),this.emit("tokens",a),{tokens:a,res:o}}async refreshToken(e){if(!e)return this.refreshTokenNoCache(e);if(this.refreshTokenPromises.has(e))return this.refreshTokenPromises.get(e);let t=this.refreshTokenNoCache(e).then(t=>(this.refreshTokenPromises.delete(e),t),t=>{throw this.refreshTokenPromises.delete(e),t});return this.refreshTokenPromises.set(e,t),t}async refreshTokenNoCache(e){let t;if(!e)throw Error("No refresh token is set.");let r=this.endpoints.oauth2TokenUrl.toString(),n={refresh_token:e,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{let e={...f.RETRY_CONFIG,method:"POST",url:r,data:new URLSearchParams((0,c.removeUndefinedValuesInObject)(n))};p.AuthClient.setMethodName(e,"refreshTokenNoCache"),t=await this.transporter.request(e)}catch(e){throw e instanceof o.GaxiosError&&"invalid_grant"===e.message&&e.response?.data&&/ReAuth/i.test(e.response.data.error_description)&&(e.message=JSON.stringify(e.response.data)),e}let i=t.data;return t.data&&t.data.expires_in&&(i.expiry_date=new Date().getTime()+1e3*t.data.expires_in,delete i.expires_in),this.emit("tokens",i),{tokens:i,res:t}}refreshAccessToken(e){if(!e)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(t=>e(null,t.credentials,t.res),e)}async refreshAccessTokenAsync(){let e=await this.refreshToken(this.credentials.refresh_token),t=e.tokens;return t.refresh_token=this.credentials.refresh_token,this.credentials=t,{credentials:this.credentials,res:e.res}}getAccessToken(e){if(!e)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(t=>e(null,t.token,t.res),e)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token){if(this.refreshHandler){let e=await this.processAndValidateRefreshHandler();if(e?.access_token)return this.setCredentials(e),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.")}let e=await this.refreshAccessTokenAsync();if(!e.credentials||e.credentials&&!e.credentials.access_token)throw Error("Could not refresh access token.");return{token:e.credentials.access_token,res:e.res}}}async getRequestHeaders(e){return(await this.getRequestMetadataAsync(e)).headers}async getRequestMetadataAsync(e){let t=this.credentials;if(!t.access_token&&!t.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(t.access_token&&!this.isTokenExpiring()){t.token_type=t.token_type||"Bearer";let e=new Headers({authorization:t.token_type+" "+t.access_token});return{headers:this.addSharedMetadataHeaders(e)}}if(this.refreshHandler){let e=await this.processAndValidateRefreshHandler();if(e?.access_token){this.setCredentials(e);let t=new Headers({authorization:"Bearer "+this.credentials.access_token});return{headers:this.addSharedMetadataHeaders(t)}}}if(this.apiKey)return{headers:new Headers({"X-Goog-Api-Key":this.apiKey})};let r=null,n=null;try{n=(r=await this.refreshToken(t.refresh_token)).tokens}catch(e){throw e.response&&(403===e.response.status||404===e.response.status)&&(e.message=`Could not refresh access token: ${e.message}`),e}let i=this.credentials;i.token_type=i.token_type||"Bearer",n.refresh_token=i.refresh_token,this.credentials=n;let s=new Headers({authorization:i.token_type+" "+n.access_token});return{headers:this.addSharedMetadataHeaders(s),res:r.res}}static getRevokeTokenUrl(e){return new f().getRevokeTokenURL(e).toString()}getRevokeTokenURL(e){let t=new URL(this.endpoints.oauth2RevokeUrl);return t.searchParams.append("token",e),t}revokeToken(e,t){let r={...f.RETRY_CONFIG,url:this.getRevokeTokenURL(e).toString(),method:"POST"};if(p.AuthClient.setMethodName(r,"revokeToken"),!t)return this.transporter.request(r);this.transporter.request(r).then(e=>t(null,e),t)}revokeCredentials(e){if(!e)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(t=>e(null,t),e)}async revokeCredentialsAsync(){let e=this.credentials.access_token;if(this.credentials={},e)return this.revokeToken(e);throw Error("No access token to revoke.")}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){try{let t=await this.getRequestMetadataAsync();return e.headers=o.Gaxios.mergeHeaders(e.headers),this.addUserProjectAndAuthHeaders(e.headers,t.headers),this.apiKey&&e.headers.set("X-Goog-Api-Key",this.apiKey),await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,i=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),s=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,o=r.config.data instanceof l.Readable,a=401===n||403===n;if(!t&&a&&!o&&i)return await this.refreshAccessTokenAsync(),this.requestAsync(e,!0);if(!t&&a&&!o&&s){let t=await this.processAndValidateRefreshHandler();return t?.access_token&&this.setCredentials(t),this.requestAsync(e,!0)}}throw n}}verifyIdToken(e,t){if(t&&"function"!=typeof t)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!t)return this.verifyIdTokenAsync(e);this.verifyIdTokenAsync(e).then(e=>t(null,e),t)}async verifyIdTokenAsync(e){if(!e.idToken)throw Error("The verifyIdToken method requires an ID Token");let t=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(e.idToken,t.certs,e.audience,this.issuers,e.maxExpiry)}async getTokenInfo(e){let{data:t}=await this.transporter.request({...f.RETRY_CONFIG,method:"POST",headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8",authorization:`Bearer ${e}`},url:this.endpoints.tokenInfoUrl.toString()}),r=Object.assign({expiry_date:new Date().getTime()+1e3*t.expires_in,scopes:t.scope.split(" ")},t);return delete r.expires_in,delete r.scope,r}getFederatedSignonCerts(e){if(!e)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(t=>e(null,t.certs,t.res),e)}async getFederatedSignonCertsAsync(){let e,t;let r=new Date().getTime(),n=(0,d.hasBrowserCrypto)()?i.JWK:i.PEM;if(this.certificateExpiry&&r<this.certificateExpiry.getTime()&&this.certificateCacheFormat===n)return{certs:this.certificateCache,format:n};switch(n){case i.PEM:t=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case i.JWK:t=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${n}`)}try{let r={...f.RETRY_CONFIG,url:t};p.AuthClient.setMethodName(r,"getFederatedSignonCertsAsync"),e=await this.transporter.request(r)}catch(e){throw e instanceof Error&&(e.message=`Failed to retrieve verification certificates: ${e.message}`),e}let s=e?.headers.get("cache-control"),o=-1;if(s){let e=/max-age=(?<maxAge>[0-9]+)/.exec(s)?.groups?.maxAge;e&&(o=1e3*Number(e))}let a={};switch(n){case i.PEM:a=e.data;break;case i.JWK:for(let t of e.data.keys)a[t.kid]=t;break;default:throw Error(`Unsupported certificate format ${n}`)}let l=new Date;return this.certificateExpiry=-1===o?null:new Date(l.getTime()+o),this.certificateCache=a,this.certificateCacheFormat=n,{certs:a,format:n,res:e}}getIapPublicKeys(e){if(!e)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(t=>e(null,t.pubkeys,t.res),e)}async getIapPublicKeysAsync(){let e;let t=this.endpoints.oauth2IapPublicKeyUrl.toString();try{let r={...f.RETRY_CONFIG,url:t};p.AuthClient.setMethodName(r,"getIapPublicKeysAsync"),e=await this.transporter.request(r)}catch(e){throw e instanceof Error&&(e.message=`Failed to retrieve verification certificates: ${e.message}`),e}return{pubkeys:e.data,res:e}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(e,t,r,n,i){let s,o;let a=(0,d.createCrypto)();i||(i=f.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let l=e.split(".");if(3!==l.length)throw Error("Wrong number of segments in token: "+e);let c=l[0]+"."+l[1],p=l[2];try{s=JSON.parse(a.decodeBase64StringUtf8(l[0]))}catch(e){throw e instanceof Error&&(e.message=`Can't parse token envelope: ${l[0]}': ${e.message}`),e}if(!s)throw Error("Can't parse token envelope: "+l[0]);try{o=JSON.parse(a.decodeBase64StringUtf8(l[1]))}catch(e){throw e instanceof Error&&(e.message=`Can't parse token payload '${l[0]}`),e}if(!o)throw Error("Can't parse token payload: "+l[1]);if(!Object.prototype.hasOwnProperty.call(t,s.kid))throw Error("No pem found for envelope: "+JSON.stringify(s));let m=t[s.kid];if("ES256"===s.alg&&(p=u.joseToDer(p,"ES256").toString("base64")),!await a.verify(m,c,p))throw Error("Invalid token signature: "+e);if(!o.iat)throw Error("No issue time in token: "+JSON.stringify(o));if(!o.exp)throw Error("No expiration time in token: "+JSON.stringify(o));let g=Number(o.iat);if(isNaN(g))throw Error("iat field using invalid format");let y=Number(o.exp);if(isNaN(y))throw Error("exp field using invalid format");let v=new Date().getTime()/1e3;if(y>=v+i)throw Error("Expiration time too far in future: "+JSON.stringify(o));let _=g-f.CLOCK_SKEW_SECS_,b=y+f.CLOCK_SKEW_SECS_;if(v<_)throw Error("Token used too early, "+v+" < "+_+": "+JSON.stringify(o));if(v>b)throw Error("Token used too late, "+v+" > "+b+": "+JSON.stringify(o));if(n&&0>n.indexOf(o.iss))throw Error("Invalid issuer, expected one of ["+n+"], but got "+o.iss);if(null!=r){let e=o.aud;if(!(r.constructor===Array?r.indexOf(e)>-1:e===r))throw Error("Wrong recipient, payload audience != requiredAudience")}return new h.LoginTicket(s,o)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let e=await this.refreshHandler();if(!e.access_token)throw Error("No access token is returned by the refreshHandler callback.");return e}}isTokenExpiring(){let e=this.credentials.expiry_date;return!!e&&e<=new Date().getTime()+this.eagerRefreshThresholdMillis}}t.OAuth2Client=f},1673:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OAuthClientAuthHandler=void 0,t.getErrorFromOAuthErrorResponse=function(e,t){let r=e.error,n=e.error_description,i=e.error_uri,s=`Error code ${r}`;void 0!==n&&(s+=`: ${n}`),void 0!==i&&(s+=` - ${i}`);let o=Error(s);if(t){let e=Object.keys(t);t.stack&&e.push("stack"),e.forEach(e=>{"message"!==e&&Object.defineProperty(o,e,{value:t[e],writable:!1,enumerable:!0})})}return o};let n=r(206),i=r(537),s=["PUT","POST","PATCH"];class o{#T=(0,i.createCrypto)();#S;transporter;constructor(e){e&&"clientId"in e?(this.#S=e,this.transporter=new n.Gaxios):(this.#S=e?.clientAuthentication,this.transporter=e?.transporter||new n.Gaxios)}applyClientAuthenticationOptions(e,t){e.headers=n.Gaxios.mergeHeaders(e.headers),this.injectAuthenticatedHeaders(e,t),t||this.injectAuthenticatedRequestBody(e)}injectAuthenticatedHeaders(e,t){if(t)e.headers=n.Gaxios.mergeHeaders(e.headers,{authorization:`Bearer ${t}`});else if(this.#S?.confidentialClientType==="basic"){e.headers=n.Gaxios.mergeHeaders(e.headers);let t=this.#S.clientId,r=this.#S.clientSecret||"",i=this.#T.encodeBase64StringUtf8(`${t}:${r}`);n.Gaxios.mergeHeaders(e.headers,{authorization:`Basic ${i}`})}}injectAuthenticatedRequestBody(e){if(this.#S?.confidentialClientType==="request-body"){let t=(e.method||"GET").toUpperCase();if(!s.includes(t))throw Error(`${t} HTTP method does not support ${this.#S.confidentialClientType} client authentication`);let r=new Headers(e.headers).get("content-type");if(r?.startsWith("application/x-www-form-urlencoded")||e.data instanceof URLSearchParams){let t=new URLSearchParams(e.data??"");t.append("client_id",this.#S.clientId),t.append("client_secret",this.#S.clientSecret||""),e.data=t}else if(r?.startsWith("application/json"))e.data=e.data||{},Object.assign(e.data,{client_id:this.#S.clientId,client_secret:this.#S.clientSecret||""});else throw Error(`${r} content-types are not supported with ${this.#S.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}t.OAuthClientAuthHandler=o},6733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PassThroughClient=void 0;let n=r(6621);class i extends n.AuthClient{async request(e){return this.transporter.request(e)}async getAccessToken(){return{}}async getRequestHeaders(){return new Headers}}t.PassThroughClient=i},4462:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluggableAuthClient=t.ExecutableError=void 0;let n=r(3318),i=r(9402),s=r(6895);var o=r(6895);Object.defineProperty(t,"ExecutableError",{enumerable:!0,get:function(){return o.ExecutableError}});class a extends n.BaseExternalAccountClient{command;timeoutMillis;outputFile;handler;constructor(e){if(super(e),!e.credential_source.executable||(this.command=e.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===e.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=e.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=e.credential_source.executable.output_file,this.handler=new s.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let e;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(e=await this.handler.retrieveCachedResponse()),!e){let t=new Map;t.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),t.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),t.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&t.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let r=this.getServiceAccountEmail();r&&t.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",r),e=await this.handler.retrieveResponseFromExecutable(t)}if(e.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!e.success)throw new s.ExecutableError(e.errorMessage,e.errorCode);if(this.outputFile&&!e.expirationTime)throw new i.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(e.isExpired())throw Error("Executable response is expired.");return e.subjectToken}}t.PluggableAuthClient=a},6895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluggableAuthHandler=t.ExecutableError=void 0;let n=r(9402),i=r(2081),s=r(7147);class o extends Error{code;constructor(e,t){super(`The executable failed with exit code: ${t} and error message: ${e}.`),this.code=t,Object.setPrototypeOf(this,new.target.prototype)}}t.ExecutableError=o;class a{commandComponents;timeoutMillis;outputFile;constructor(e){if(!e.command)throw Error("No command provided.");if(this.commandComponents=a.parseCommand(e.command),this.timeoutMillis=e.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=e.outputFile}retrieveResponseFromExecutable(e){return new Promise((t,r)=>{let s=i.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(e)}}),a="";s.stdout.on("data",e=>{a+=e}),s.stderr.on("data",e=>{a+=e});let l=setTimeout(()=>(s.removeAllListeners(),s.kill(),r(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);s.on("close",e=>{if(clearTimeout(l),0!==e)return r(new o(a,e.toString()));try{let e=JSON.parse(a),r=new n.ExecutableResponse(e);return t(r)}catch(e){if(e instanceof n.ExecutableResponseError)return r(e);return r(new n.ExecutableResponseError(`The executable returned an invalid response: ${a}`))}})})}async retrieveCachedResponse(){let e;if(!this.outputFile||0===this.outputFile.length)return;try{e=await s.promises.realpath(this.outputFile)}catch{return}if(!(await s.promises.lstat(e)).isFile())return;let t=await s.promises.readFile(e,{encoding:"utf8"});if(""!==t)try{let e=JSON.parse(t);if(new n.ExecutableResponse(e).isValid())return new n.ExecutableResponse(e);return}catch(e){if(e instanceof n.ExecutableResponseError)throw e;throw new n.ExecutableResponseError(`The output file contained an invalid response: ${t}`)}}static parseCommand(e){let t=e.match(/(?:[^\s"]+|"[^"]*")+/g);if(!t)throw Error(`Provided command: "${e}" could not be parsed.`);for(let e=0;e<t.length;e++)'"'===t[e][0]&&'"'===t[e].slice(-1)&&(t[e]=t[e].slice(1,-1));return t}}t.PluggableAuthHandler=a},7065:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserRefreshClient=t.USER_REFRESH_ACCOUNT_TYPE=void 0;let n=r(3490),i=r(6621);t.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class s extends n.OAuth2Client{_refreshToken;constructor(e,t,r,n,i){let s=e&&"object"==typeof e?e:{clientId:e,clientSecret:t,refreshToken:r,eagerRefreshThresholdMillis:n,forceRefreshOnFailure:i};super(s),this._refreshToken=s.refreshToken,this.credentials.refresh_token=s.refreshToken}async refreshTokenNoCache(){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(e){let t={...s.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,method:"POST",data:new URLSearchParams({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:e})};return i.AuthClient.setMethodName(t,"fetchIdToken"),(await this.transporter.request(t)).data.id_token}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==e.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!e.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!e.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!e.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=e.client_id,this._clientSecret=e.client_secret,this._refreshToken=e.refresh_token,this.credentials.refresh_token=e.refresh_token,this.quotaProjectId=e.quota_project_id,this.universeDomain=e.universe_domain||this.universeDomain}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}async fromStreamAsync(e){return new Promise((t,r)=>{if(!e)return r(Error("Must pass in a stream containing the user refresh token."));let n="";e.setEncoding("utf8").on("error",r).on("data",e=>n+=e).on("end",()=>{try{let e=JSON.parse(n);return this.fromJSON(e),t()}catch(e){return r(e)}})})}static fromJSON(e){let t=new s;return t.fromJSON(e),t}}t.UserRefreshClient=s},984:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StsCredentials=void 0;let n=r(206),i=r(6621),s=r(1673),o=r(6538);class a extends s.OAuthClientAuthHandler{#C;constructor(e={tokenExchangeEndpoint:""},t){("object"!=typeof e||e instanceof URL)&&(e={tokenExchangeEndpoint:e,clientAuthentication:t}),super(e),this.#C=e.tokenExchangeEndpoint}async exchangeToken(e,t,r){let l={grant_type:e.grantType,resource:e.resource,audience:e.audience,scope:e.scope?.join(" "),requested_token_type:e.requestedTokenType,subject_token:e.subjectToken,subject_token_type:e.subjectTokenType,actor_token:e.actingParty?.actorToken,actor_token_type:e.actingParty?.actorTokenType,options:r&&JSON.stringify(r)},u={...a.RETRY_CONFIG,url:this.#C.toString(),method:"POST",headers:t,data:new URLSearchParams((0,o.removeUndefinedValuesInObject)(l))};i.AuthClient.setMethodName(u,"exchangeToken"),this.applyClientAuthenticationOptions(u);try{let e=await this.transporter.request(u),t=e.data;return t.res=e,t}catch(e){if(e instanceof n.GaxiosError&&e.response)throw(0,s.getErrorFromOAuthErrorResponse)(e.response.data,e);throw e}}}t.StsCredentials=a},132:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrlSubjectTokenSupplier=void 0;let n=r(6621);class i{url;headers;formatType;subjectTokenFieldName;additionalGaxiosOptions;constructor(e){this.url=e.url,this.formatType=e.formatType,this.subjectTokenFieldName=e.subjectTokenFieldName,this.headers=e.headers,this.additionalGaxiosOptions=e.additionalGaxiosOptions}async getSubjectToken(e){let t;let r={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers};if(n.AuthClient.setMethodName(r,"getSubjectToken"),"text"===this.formatType?t=(await e.transporter.request(r)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(t=(await e.transporter.request(r)).data[this.subjectTokenFieldName]),!t)throw Error("Unable to parse the subject_token from the credential_source URL");return t}}t.UrlSubjectTokenSupplier=i},3244:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserCrypto=void 0;let n=r(714),i=r(7277);class s{constructor(){if("undefined"==typeof window||void 0===window.crypto||void 0===window.crypto.subtle)throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(e){let t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return n.fromByteArray(new Uint8Array(r))}randomBytesBase64(e){let t=new Uint8Array(e);return window.crypto.getRandomValues(t),n.fromByteArray(t)}static padBase64(e){for(;e.length%4!=0;)e+="=";return e}async verify(e,t,r){let i={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},o=new TextEncoder().encode(t),a=n.toByteArray(s.padBase64(r)),l=await window.crypto.subtle.importKey("jwk",e,i,!0,["verify"]);return await window.crypto.subtle.verify(i,l,a,o)}async sign(e,t){let r={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},i=new TextEncoder().encode(t),s=await window.crypto.subtle.importKey("jwk",e,r,!0,["sign"]),o=await window.crypto.subtle.sign(r,s,i);return n.fromByteArray(new Uint8Array(o))}decodeBase64StringUtf8(e){let t=n.toByteArray(s.padBase64(e));return new TextDecoder().decode(t)}encodeBase64StringUtf8(e){let t=new TextEncoder().encode(e);return n.fromByteArray(t)}async sha256DigestHex(e){let t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return(0,i.fromArrayBufferToHex)(r)}async signWithHmacSha256(e,t){let r="string"==typeof e?e:String.fromCharCode(...new Uint16Array(e)),n=new TextEncoder,i=await window.crypto.subtle.importKey("raw",n.encode(r),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",i,n.encode(t))}}t.BrowserCrypto=s},537:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createCrypto=function(){return a()?new s.BrowserCrypto:new o.NodeCrypto},t.hasBrowserCrypto=a;let s=r(3244),o=r(5455);function a(){return"undefined"!=typeof window&&void 0!==window.crypto&&void 0!==window.crypto.subtle}i(r(7277),t)},5455:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCrypto=void 0;let n=r(6113);class i{async sha256DigestBase64(e){return n.createHash("sha256").update(e).digest("base64")}randomBytesBase64(e){return n.randomBytes(e).toString("base64")}async verify(e,t,r){let i=n.createVerify("RSA-SHA256");return i.update(t),i.end(),i.verify(e,r,"base64")}async sign(e,t){let r=n.createSign("RSA-SHA256");return r.update(t),r.end(),r.sign(e,"base64")}decodeBase64StringUtf8(e){return Buffer.from(e,"base64").toString("utf-8")}encodeBase64StringUtf8(e){return Buffer.from(e,"utf-8").toString("base64")}async sha256DigestHex(e){return n.createHash("sha256").update(e).digest("hex")}async signWithHmacSha256(e,t){var r;let i="string"==typeof e?e:Buffer.from(e);return(r=n.createHmac("sha256",i).update(t).digest()).buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}}t.NodeCrypto=i},7277:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromArrayBufferToHex=function(e){return Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")}},4401:(e,t,r)=>{"use strict";t.eE=void 0;let n=r(6614);Object.defineProperty(t,"eE",{enumerable:!0,get:function(){return n.GoogleAuth}}),r(759),r(206),r(6621),r(902),r(1215),r(9120),r(502),r(7951),r(1316),r(2119),r(3490),r(434),r(7065),r(3321),r(3676),r(9201),r(9273),r(3318),r(3651),r(4462),r(3006),r(6733),new n.GoogleAuth},6538:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=void 0,t.snakeToCamel=a,t.originalOrCamelOptions=function(e){return{get:function(t){let r=e||{};return r[t]??r[a(t)]}}},t.removeUndefinedValuesInObject=function(e){return Object.entries(e).forEach(([t,r])=>{(void 0===r||"undefined"===r)&&delete e[t]}),e},t.isValidFile=u,t.getWellKnownCertificateConfigFileLocation=function(){let e=process.env.CLOUDSDK_CONFIG||(i.platform().startsWith("win")?s.join(process.env.APPDATA||"",o):s.join(process.env.HOME||"",".config",o));return s.join(e,"certificate_config.json")};let n=r(7147),i=r(2037),s=r(1017),o="gcloud";function a(e){return e.replace(/([_][^_])/g,e=>e.slice(1).toUpperCase())}class l{capacity;#O=new Map;maxAge;constructor(e){this.capacity=e.capacity,this.maxAge=e.maxAge}#N(e,t){this.#O.delete(e),this.#O.set(e,{value:t,lastAccessed:Date.now()})}set(e,t){this.#N(e,t),this.#I()}get(e){let t=this.#O.get(e);if(t)return this.#N(e,t.value),this.#I(),t.value}#I(){let e=this.maxAge?Date.now()-this.maxAge:0,t=this.#O.entries().next();for(;!t.done&&(this.#O.size>this.capacity||t.value[1].lastAccessed<e);)this.#O.delete(t.value[0]),t=this.#O.entries().next()}}async function u(e){try{return(await n.promises.lstat(e)).isFile()}catch(e){return!1}}t.LRUCache=l},762:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Colours=void 0;class r{static isEnabled(e){return e&&e.isTTY&&("function"!=typeof e.getColorDepth||e.getColorDepth()>2)}static refresh(){r.enabled=r.isEnabled(null==process?void 0:process.stderr),this.enabled?(r.reset="\x1b[0m",r.bright="\x1b[1m",r.dim="\x1b[2m",r.red="\x1b[31m",r.green="\x1b[32m",r.yellow="\x1b[33m",r.blue="\x1b[34m",r.magenta="\x1b[35m",r.cyan="\x1b[36m",r.white="\x1b[37m",r.grey="\x1b[90m"):(r.reset="",r.bright="",r.dim="",r.red="",r.green="",r.yellow="",r.blue="",r.magenta="",r.cyan="",r.white="",r.grey="")}}t.Colours=r,r.enabled=!1,r.reset="",r.bright="",r.dim="",r.red="",r.green="",r.yellow="",r.blue="",r.magenta="",r.cyan="",r.white="",r.grey="",r.refresh()},5348:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(7042),t)},7042:function(e,t,r){"use strict";let n;var i,s,o,a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||(i=function(e){return(i=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=i(e),n=0;n<r.length;n++)"default"!==r[n]&&a(t,e,r[n]);return l(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.env=t.DebugLogBackendBase=t.placeholder=t.AdhocDebugLogger=t.LogSeverity=void 0,t.getNodeBackend=y,t.getDebugBackend=function(e){return new v(e)},t.getStructuredBackend=function(e){return new _(e)},t.setBackend=function(e){n=e,b.clear()},t.log=E;let c=r(2361),d=u(r(7282)),p=u(r(3837)),h=r(762);(s=o||(t.LogSeverity=o={})).DEFAULT="DEFAULT",s.DEBUG="DEBUG",s.INFO="INFO",s.WARNING="WARNING",s.ERROR="ERROR";class f extends c.EventEmitter{constructor(e,t){super(),this.namespace=e,this.upstream=t,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(e,t)=>this.on(e,t)}),this.func.debug=(...e)=>this.invokeSeverity(o.DEBUG,...e),this.func.info=(...e)=>this.invokeSeverity(o.INFO,...e),this.func.warn=(...e)=>this.invokeSeverity(o.WARNING,...e),this.func.error=(...e)=>this.invokeSeverity(o.ERROR,...e),this.func.sublog=e=>E(e,this.func)}invoke(e,...t){if(this.upstream)try{this.upstream(e,...t)}catch(e){}try{this.emit("log",e,t)}catch(e){}}invokeSeverity(e,...t){this.invoke({severity:e},...t)}}t.AdhocDebugLogger=f,t.placeholder=new f("",()=>{}).func;class m{constructor(){var e;this.cached=new Map,this.filters=[],this.filtersSet=!1;let r=null!==(e=d.env[t.env.nodeEnables])&&void 0!==e?e:"*";"all"===r&&(r="*"),this.filters=r.split(",")}log(e,t,...r){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let n=this.cached.get(e);n||(n=this.makeLogger(e),this.cached.set(e,n)),n(t,...r)}catch(e){console.error(e)}}}t.DebugLogBackendBase=m;class g extends m{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(e){return this.enabledRegexp.test(e)}makeLogger(e){return this.enabledRegexp.test(e)?(t,...r)=>{var n;let i;let s=`${h.Colours.green}${e}${h.Colours.reset}`,a=`${h.Colours.yellow}${d.pid}${h.Colours.reset}`;switch(t.severity){case o.ERROR:i=`${h.Colours.red}${t.severity}${h.Colours.reset}`;break;case o.INFO:i=`${h.Colours.magenta}${t.severity}${h.Colours.reset}`;break;case o.WARNING:i=`${h.Colours.yellow}${t.severity}${h.Colours.reset}`;break;default:i=null!==(n=t.severity)&&void 0!==n?n:o.DEFAULT}let l=p.formatWithOptions({colors:h.Colours.enabled},...r),u=Object.assign({},t);delete u.severity;let c=Object.getOwnPropertyNames(u).length?JSON.stringify(u):"",f=c?`${h.Colours.grey}${c}${h.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",a,s,i,l,c?` ${f}`:"")}:()=>{}}setFilters(){let e=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${e}$`,"i")}}function y(){return new g}class v extends m{constructor(e){super(),this.debugPkg=e}makeLogger(e){let t=this.debugPkg(e);return(e,...r)=>{t(r[0],...r.slice(1))}}setFilters(){var e;let t=null!==(e=d.env.NODE_DEBUG)&&void 0!==e?e:"";d.env.NODE_DEBUG=`${t}${t?",":""}${this.filters.join(",")}`}}class _ extends m{constructor(e){super(),this.upstream=null!=e?e:void 0}makeLogger(e){var t;let r=null===(t=this.upstream)||void 0===t?void 0:t.makeLogger(e);return(e,...t)=>{var n;let i=JSON.stringify(Object.assign({severity:null!==(n=e.severity)&&void 0!==n?n:o.INFO,message:p.format(...t)},e));r?r(e,i):console.log("%s",i)}}setFilters(){var e;null===(e=this.upstream)||void 0===e||e.setFilters()}}t.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let b=new Map;function E(e,r){let i;if(!n&&!d.env[t.env.nodeEnables]||!e)return t.placeholder;r&&(e=`${r.instance.namespace}:${e}`);let s=b.get(e);if(s)return s.func;if(null===n)return t.placeholder;void 0===n&&(n=y());let o=new f(e,(t,...r)=>{if(i!==n){if(null===n)return;void 0===n&&(n=y()),i=n}null==n||n.log(e,t,...r)});return b.set(e,o),o.func}},9361:(e,t,r)=>{var n=r(2102).stringify,i=r(6712);e.exports=function(e){return{parse:i(e),stringify:n}},e.exports.parse=i(),e.exports.stringify=n},6712:(e,t,r)=>{var n=null;let i=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,s=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;e.exports=function(e){"use strict";var t={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=e){if(!0===e.strict&&(t.strict=!0),!0===e.storeAsString&&(t.storeAsString=!0),t.alwaysParseAsBig=!0===e.alwaysParseAsBig&&e.alwaysParseAsBig,t.useNativeBigInt=!0===e.useNativeBigInt&&e.useNativeBigInt,void 0!==e.constructorAction){if("error"===e.constructorAction||"ignore"===e.constructorAction||"preserve"===e.constructorAction)t.constructorAction=e.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${e.constructorAction}`)}if(void 0!==e.protoAction){if("error"===e.protoAction||"ignore"===e.protoAction||"preserve"===e.protoAction)t.protoAction=e.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${e.protoAction}`)}}var o,a,l,u,c={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},d=function(e){throw{name:"SyntaxError",message:e,at:o,text:l}},p=function(e){return e&&e!==a&&d("Expected '"+e+"' instead of '"+a+"'"),a=l.charAt(o),o+=1,a},h=function(){var e,i="";for("-"===a&&(i="-",p("-"));a>="0"&&a<="9";)i+=a,p();if("."===a)for(i+=".";p()&&a>="0"&&a<="9";)i+=a;if("e"===a||"E"===a)for(i+=a,p(),("-"===a||"+"===a)&&(i+=a,p());a>="0"&&a<="9";)i+=a,p();if(isFinite(e=+i))return(null==n&&(n=r(8254)),i.length>15)?t.storeAsString?i:t.useNativeBigInt?BigInt(i):new n(i):t.alwaysParseAsBig?t.useNativeBigInt?BigInt(e):new n(e):e;d("Bad number")},f=function(){var e,t,r,n="";if('"'===a)for(var i=o;p();){if('"'===a)return o-1>i&&(n+=l.substring(i,o-1)),p(),n;if("\\"===a){if(o-1>i&&(n+=l.substring(i,o-1)),p(),"u"===a){for(t=0,r=0;t<4&&isFinite(e=parseInt(p(),16));t+=1)r=16*r+e;n+=String.fromCharCode(r)}else if("string"==typeof c[a])n+=c[a];else break;i=o}}d("Bad string")},m=function(){for(;a&&a<=" ";)p()},g=function(){switch(a){case"t":return p("t"),p("r"),p("u"),p("e"),!0;case"f":return p("f"),p("a"),p("l"),p("s"),p("e"),!1;case"n":return p("n"),p("u"),p("l"),p("l"),null}d("Unexpected '"+a+"'")},y=function(){var e=[];if("["===a){if(p("["),m(),"]"===a)return p("]"),e;for(;a;){if(e.push(u()),m(),"]"===a)return p("]"),e;p(","),m()}}d("Bad array")},v=function(){var e,r=Object.create(null);if("{"===a){if(p("{"),m(),"}"===a)return p("}"),r;for(;a;){if(e=f(),m(),p(":"),!0===t.strict&&Object.hasOwnProperty.call(r,e)&&d('Duplicate key "'+e+'"'),!0===i.test(e)?"error"===t.protoAction?d("Object contains forbidden prototype property"):"ignore"===t.protoAction?u():r[e]=u():!0===s.test(e)?"error"===t.constructorAction?d("Object contains forbidden constructor property"):"ignore"===t.constructorAction?u():r[e]=u():r[e]=u(),m(),"}"===a)return p("}"),r;p(","),m()}}d("Bad object")};return u=function(){switch(m(),a){case"{":return v();case"[":return y();case'"':return f();case"-":return h();default:return a>="0"&&a<="9"?h():g()}},function(e,t){var r;return l=e+"",o=0,a=" ",r=u(),m(),a&&d("Syntax error"),"function"==typeof t?function e(r,n){var i,s=r[n];return s&&"object"==typeof s&&Object.keys(s).forEach(function(t){void 0!==(i=e(s,t))?s[t]=i:delete s[t]}),t.call(r,n,s)}({"":r},""):r}}},2102:(e,t,r)=>{var n=r(8254),i=e.exports;!function(){"use strict";var e,t,r,s=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(e){return s.lastIndex=0,s.test(e)?'"'+e.replace(s,function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}"function"!=typeof i.stringify&&(i.stringify=function(i,s,o){var l;if(e="",t="","number"==typeof o)for(l=0;l<o;l+=1)t+=" ";else"string"==typeof o&&(t=o);if(r=s,s&&"function"!=typeof s&&("object"!=typeof s||"number"!=typeof s.length))throw Error("JSON.stringify");return function i(s,o){var l,u,c,d,p,h=e,f=o[s],m=null!=f&&(f instanceof n||n.isBigNumber(f));switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(s)),"function"==typeof r&&(f=r.call(o,s,f)),typeof f){case"string":if(m)return f;return a(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":case"bigint":return String(f);case"object":if(!f)return"null";if(e+=t,p=[],"[object Array]"===Object.prototype.toString.apply(f)){for(l=0,d=f.length;l<d;l+=1)p[l]=i(l,f)||"null";return c=0===p.length?"[]":e?"[\n"+e+p.join(",\n"+e)+"\n"+h+"]":"["+p.join(",")+"]",e=h,c}if(r&&"object"==typeof r)for(l=0,d=r.length;l<d;l+=1)"string"==typeof r[l]&&(c=i(u=r[l],f))&&p.push(a(u)+(e?": ":":")+c);else Object.keys(f).forEach(function(t){var r=i(t,f);r&&p.push(a(t)+(e?": ":":")+r)});return c=0===p.length?"{}":e?"{\n"+e+p.join(",\n"+e)+"\n"+h+"}":"{"+p.join(",")+"}",e=h,c}}("",{"":i})})}()},5350:(e,t,r)=>{var n,i=r(892).Buffer,s=r(6113),o=r(3164),a=r(3837),l="secret must be a string or buffer",u="key must be a string or a buffer",c="function"==typeof s.createPublicKey;function d(e){if(!i.isBuffer(e)&&"string"!=typeof e&&(!c||"object"!=typeof e||"string"!=typeof e.type||"string"!=typeof e.asymmetricKeyType||"function"!=typeof e.export))throw m(u)}function p(e){if(!i.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw m("key must be a string, a buffer or an object")}function h(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function m(e){var t=[].slice.call(arguments,1);return TypeError(a.format.bind(a,e).apply(null,t))}function g(e){var t;return t=e,i.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function y(e){return function(t,r){(function(e){if(!i.isBuffer(e)&&"string"!=typeof e&&(!c||"object"!=typeof e||"secret"!==e.type||"function"!=typeof e.export))throw m(l)})(r),t=g(t);var n=s.createHmac("sha"+e,r);return h((n.update(t),n.digest("base64")))}}c&&(u+=" or a KeyObject",l+="or a KeyObject");var v="timingSafeEqual"in s?function(e,t){return e.byteLength===t.byteLength&&s.timingSafeEqual(e,t)}:function(e,t){return n||(n=r(9916)),n(e,t)};function _(e){return function(t,r,n){var s=y(e)(t,n);return v(i.from(r),i.from(s))}}function b(e){return function(t,r){p(r),t=g(t);var n=s.createSign("RSA-SHA"+e);return h((n.update(t),n.sign(r,"base64")))}}function E(e){return function(t,r,n){d(n),t=g(t),r=f(r);var i=s.createVerify("RSA-SHA"+e);return i.update(t),i.verify(n,r,"base64")}}function x(e){return function(t,r){p(r),t=g(t);var n=s.createSign("RSA-SHA"+e);return h((n.update(t),n.sign({key:r,padding:s.constants.RSA_PKCS1_PSS_PADDING,saltLength:s.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function w(e){return function(t,r,n){d(n),t=g(t),r=f(r);var i=s.createVerify("RSA-SHA"+e);return i.update(t),i.verify({key:n,padding:s.constants.RSA_PKCS1_PSS_PADDING,saltLength:s.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function A(e){var t=b(e);return function(){var r=t.apply(null,arguments);return o.derToJose(r,"ES"+e)}}function T(e){var t=E(e);return function(r,n,i){return t(r,n=o.joseToDer(n,"ES"+e).toString("base64"),i)}}function S(){return function(){return""}}function C(){return function(e,t){return""===t}}e.exports=function(e){var t=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!t)throw m('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var r=(t[1]||t[3]).toLowerCase(),n=t[2];return{sign:({hs:y,rs:b,ps:x,es:A,none:S})[r](n),verify:({hs:_,rs:E,ps:w,es:T,none:C})[r](n)}}},8287:(e,t,r)=>{var n=r(9505),i=r(5850);t.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],t.sign=n.sign,t.verify=i.verify,t.decode=i.decode,t.isValid=i.isValid,t.createSign=function(e){return new n(e)},t.createVerify=function(e){return new i(e)}},4630:(e,t,r)=>{var n=r(892).Buffer,i=r(2781);function s(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=n.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=n.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick((function(){this.emit("end",e),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof e+")")}r(3837).inherits(s,i),s.prototype.write=function(e){this.buffer=n.concat([this.buffer,n.from(e)]),this.emit("data",e)},s.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=s},9505:(e,t,r)=>{var n=r(892).Buffer,i=r(4630),s=r(5350),o=r(2781),a=r(904),l=r(3837);function u(e,t){return n.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function c(e){var t,r,n,i=e.header,o=e.payload,c=e.secret||e.privateKey,d=e.encoding,p=s(i.alg),h=(t=(t=d)||"utf8",r=u(a(i),"binary"),n=u(a(o),t),l.format("%s.%s",r,n)),f=p.sign(h,c);return l.format("%s.%s",h,f)}function d(e){var t=e.secret;if(t=null==(t=null==t?e.privateKey:t)?e.key:t,!0===/^hs/i.test(e.header.alg)&&null==t)throw TypeError("secret must be a string or buffer or a KeyObject");var r=new i(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new i(e.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}l.inherits(d,o),d.prototype.sign=function(){try{var e=c({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},d.sign=c,e.exports=d},904:(e,t,r)=>{var n=r(4300).Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||n.isBuffer(e)?e.toString():JSON.stringify(e)}},5850:(e,t,r)=>{var n=r(892).Buffer,i=r(4630),s=r(5350),o=r(2781),a=r(904),l=r(3837),u=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function c(e){var t=e.split(".",1)[0];return function(e){if("[object Object]"===Object.prototype.toString.call(e))return e;try{return JSON.parse(e)}catch(e){return}}(n.from(t,"base64").toString("binary"))}function d(e){return e.split(".")[2]}function p(e){return u.test(e)&&!!c(e)}function h(e,t,r){if(!t){var n=Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=d(e=a(e)),o=e.split(".",2).join(".");return s(t).verify(o,i,r)}function f(e,t){if(t=t||{},!p(e=a(e)))return null;var r,i,s=c(e);if(!s)return null;var o=(r=r||"utf8",i=e.split(".")[1],n.from(i,"base64").toString(r));return("JWT"===s.typ||t.json)&&(o=JSON.parse(o,t.encoding)),{header:s,payload:o,signature:d(e)}}function m(e){var t=(e=e||{}).secret;if(t=null==(t=null==t?e.publicKey:t)?e.key:t,!0===/^hs/i.test(e.algorithm)&&null==t)throw TypeError("secret must be a string or buffer or a KeyObject");var r=new i(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new i(e.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}l.inherits(m,o),m.prototype.verify=function(){try{var e=h(this.signature.buffer,this.algorithm,this.key.buffer),t=f(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},m.decode=f,m.isValid=p,m.verify=h,e.exports=m},892:(e,t,r)=>{/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var n=r(4300),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n.SlowBuffer(e)}},7878:(e,t,r)=>{"use strict";let{EMPTY_BUFFER:n}=r(9353),i=Buffer[Symbol.species];function s(e,t,r,n,i){for(let s=0;s<i;s++)r[n+s]=e[s]^t[3&s]}function o(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}if(e.exports={concat:function(e,t){if(0===e.length)return n;if(1===e.length)return e[0];let r=Buffer.allocUnsafe(t),s=0;for(let t=0;t<e.length;t++){let n=e[t];r.set(n,s),s+=n.length}return s<t?new i(r.buffer,r.byteOffset,s):r},mask:s,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){let r;return(e.readOnly=!0,Buffer.isBuffer(t))?t:(t instanceof ArrayBuffer?r=new i(t):ArrayBuffer.isView(t)?r=new i(t.buffer,t.byteOffset,t.byteLength):(r=Buffer.from(t),e.readOnly=!1),r)},unmask:o},!process.env.WS_NO_BUFFER_UTIL)try{let t=r(8359);e.exports.mask=function(e,r,n,i,o){o<48?s(e,r,n,i,o):t.mask(e,r,n,i,o)},e.exports.unmask=function(e,r){e.length<32?o(e,r):t.unmask(e,r)}}catch(e){}},9353:e=>{"use strict";let t=["nodebuffer","arraybuffer","fragments"],r="undefined"!=typeof Blob;r&&t.push("blob"),e.exports={BINARY_TYPES:t,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:r,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},1368:(e,t,r)=>{"use strict";let{kForOnEventAttribute:n,kListener:i}=r(9353),s=Symbol("kCode"),o=Symbol("kData"),a=Symbol("kError"),l=Symbol("kMessage"),u=Symbol("kReason"),c=Symbol("kTarget"),d=Symbol("kType"),p=Symbol("kWasClean");class h{constructor(e){this[c]=null,this[d]=e}get target(){return this[c]}get type(){return this[d]}}Object.defineProperty(h.prototype,"target",{enumerable:!0}),Object.defineProperty(h.prototype,"type",{enumerable:!0});class f extends h{constructor(e,t={}){super(e),this[s]=void 0===t.code?0:t.code,this[u]=void 0===t.reason?"":t.reason,this[p]=void 0!==t.wasClean&&t.wasClean}get code(){return this[s]}get reason(){return this[u]}get wasClean(){return this[p]}}Object.defineProperty(f.prototype,"code",{enumerable:!0}),Object.defineProperty(f.prototype,"reason",{enumerable:!0}),Object.defineProperty(f.prototype,"wasClean",{enumerable:!0});class m extends h{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[l]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[l]}}Object.defineProperty(m.prototype,"error",{enumerable:!0}),Object.defineProperty(m.prototype,"message",{enumerable:!0});class g extends h{constructor(e,t={}){super(e),this[o]=void 0===t.data?null:t.data}get data(){return this[o]}}function y(e,t,r){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}Object.defineProperty(g.prototype,"data",{enumerable:!0}),e.exports={CloseEvent:f,ErrorEvent:m,Event:h,EventTarget:{addEventListener(e,t,r={}){let s;for(let s of this.listeners(e))if(!r[n]&&s[i]===t&&!s[n])return;if("message"===e)s=function(e,r){let n=new g("message",{data:r?e:e.toString()});n[c]=this,y(t,this,n)};else if("close"===e)s=function(e,r){let n=new f("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});n[c]=this,y(t,this,n)};else if("error"===e)s=function(e){let r=new m("error",{error:e,message:e.message});r[c]=this,y(t,this,r)};else{if("open"!==e)return;s=function(){let e=new h("open");e[c]=this,y(t,this,e)}}s[n]=!!r[n],s[i]=t,r.once?this.once(e,s):this.on(e,s)},removeEventListener(e,t){for(let r of this.listeners(e))if(r[i]===t&&!r[n]){this.removeListener(e,r);break}}},MessageEvent:g}},9964:(e,t,r)=>{"use strict";let{tokenChars:n}=r(4568);function i(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}e.exports={format:function(e){return Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>[t].concat(Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){let t,r;let s=Object.create(null),o=Object.create(null),a=!1,l=!1,u=!1,c=-1,d=-1,p=-1,h=0;for(;h<e.length;h++)if(d=e.charCodeAt(h),void 0===t){if(-1===p&&1===n[d])-1===c&&(c=h);else if(0!==h&&(32===d||9===d))-1===p&&-1!==c&&(p=h);else if(59===d||44===d){if(-1===c)throw SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h);let r=e.slice(c,p);44===d?(i(s,r,o),o=Object.create(null)):t=r,c=p=-1}else throw SyntaxError(`Unexpected character at index ${h}`)}else if(void 0===r){if(-1===p&&1===n[d])-1===c&&(c=h);else if(32===d||9===d)-1===p&&-1!==c&&(p=h);else if(59===d||44===d){if(-1===c)throw SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h),i(o,e.slice(c,p),!0),44===d&&(i(s,t,o),o=Object.create(null),t=void 0),c=p=-1}else if(61===d&&-1!==c&&-1===p)r=e.slice(c,h),c=p=-1;else throw SyntaxError(`Unexpected character at index ${h}`)}else if(l){if(1!==n[d])throw SyntaxError(`Unexpected character at index ${h}`);-1===c?c=h:a||(a=!0),l=!1}else if(u){if(1===n[d])-1===c&&(c=h);else if(34===d&&-1!==c)u=!1,p=h;else if(92===d)l=!0;else throw SyntaxError(`Unexpected character at index ${h}`)}else if(34===d&&61===e.charCodeAt(h-1))u=!0;else if(-1===p&&1===n[d])-1===c&&(c=h);else if(-1!==c&&(32===d||9===d))-1===p&&(p=h);else if(59===d||44===d){if(-1===c)throw SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h);let n=e.slice(c,p);a&&(n=n.replace(/\\/g,""),a=!1),i(o,r,n),44===d&&(i(s,t,o),o=Object.create(null),t=void 0),r=void 0,c=p=-1}else throw SyntaxError(`Unexpected character at index ${h}`);if(-1===c||u||32===d||9===d)throw SyntaxError("Unexpected end of input");-1===p&&(p=h);let f=e.slice(c,p);return void 0===t?i(s,f,o):(void 0===r?i(o,f,!0):a?i(o,r,f.replace(/\\/g,"")):i(o,r,f),i(s,t,o)),s}}},5936:e=>{"use strict";let t=Symbol("kDone"),r=Symbol("kRun");class n{constructor(e){this[t]=()=>{this.pending--,this[r]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[r]()}[r](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[t])}}}e.exports=n},7959:(e,t,r)=>{"use strict";let n;let i=r(9796),s=r(7878),o=r(5936),{kStatusCode:a}=r(9353),l=Buffer[Symbol.species],u=Buffer.from([0,0,255,255]),c=Symbol("permessage-deflate"),d=Symbol("total-length"),p=Symbol("callback"),h=Symbol("buffers"),f=Symbol("error");class m{constructor(e,t,r){this._maxPayload=0|r,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,n||(n=new o(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[p];this._deflate.close(),this._deflate=null,e&&e(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,r=e.find(e=>(!1!==t.serverNoContextTakeover||!e.server_no_context_takeover)&&(!e.server_max_window_bits||!1!==t.serverMaxWindowBits&&("number"!=typeof t.serverMaxWindowBits||!(t.serverMaxWindowBits>e.server_max_window_bits)))&&("number"!=typeof t.clientMaxWindowBits||!!e.client_max_window_bits));if(!r)throw Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:(!0===r.client_max_window_bits||!1===t.clientMaxWindowBits)&&delete r.client_max_window_bits,r}acceptAsClient(e){let t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let r=e[t];if(r.length>1)throw Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if("client_no_context_takeover"===t||"server_no_context_takeover"===t){if(!0!==r)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else throw Error(`Unknown parameter "${t}"`);e[t]=r})}),e}decompress(e,t,r){n.add(n=>{this._decompress(e,t,(e,t)=>{n(),r(e,t)})})}compress(e,t,r){n.add(n=>{this._compress(e,t,(e,t)=>{n(),r(e,t)})})}_decompress(e,t,r){let n=this._isServer?"client":"server";if(!this._inflate){let e=`${n}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[c]=this,this._inflate[d]=0,this._inflate[h]=[],this._inflate.on("error",v),this._inflate.on("data",y)}this._inflate[p]=r,this._inflate.write(e),t&&this._inflate.write(u),this._inflate.flush(()=>{let e=this._inflate[f];if(e){this._inflate.close(),this._inflate=null,r(e);return}let i=s.concat(this._inflate[h],this._inflate[d]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[d]=0,this._inflate[h]=[],t&&this.params[`${n}_no_context_takeover`]&&this._inflate.reset()),r(null,i)})}_compress(e,t,r){let n=this._isServer?"server":"client";if(!this._deflate){let e=`${n}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[d]=0,this._deflate[h]=[],this._deflate.on("data",g)}this._deflate[p]=r,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=s.concat(this._deflate[h],this._deflate[d]);t&&(e=new l(e.buffer,e.byteOffset,e.length-4)),this._deflate[p]=null,this._deflate[d]=0,this._deflate[h]=[],t&&this.params[`${n}_no_context_takeover`]&&this._deflate.reset(),r(null,e)})}}function g(e){this[h].push(e),this[d]+=e.length}function y(e){if(this[d]+=e.length,this[c]._maxPayload<1||this[d]<=this[c]._maxPayload){this[h].push(e);return}this[f]=RangeError("Max payload size exceeded"),this[f].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[f][a]=1009,this.removeListener("data",y),this.reset()}function v(e){if(this[c]._inflate=null,this[f]){this[p](this[f]);return}e[a]=1007,this[p](e)}e.exports=m},3958:(e,t,r)=>{"use strict";let{Writable:n}=r(2781),i=r(7959),{BINARY_TYPES:s,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:l}=r(9353),{concat:u,toArrayBuffer:c,unmask:d}=r(7878),{isValidStatusCode:p,isValidUTF8:h}=r(4568),f=Buffer[Symbol.species];class m extends n{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||s[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[l]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let t=this._buffers[0];return this._buffers[0]=new f(t.buffer,t.byteOffset+e,t.length-e),new f(t.buffer,t.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let r=this._buffers[0],n=t.length-e;e>=r.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),n),this._buffers[0]=new f(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((48&t[0])!=0){e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));return}let r=(64&t[0])==64;if(r&&!this._extensions[i.extensionName]){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(this._fin=(128&t[0])==128,this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(r){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(!this._fragmented){e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));return}this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented){e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));return}this._compressed=r}else if(this._opcode>7&&this._opcode<11){if(!this._fin){e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));return}if(r){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength){e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"));return}}else{e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));return}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&t[1])==128,this._isServer){if(!this._masked){e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"));return}}else if(this._masked){e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));return}126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),r=t.readUInt32BE(0);if(r>2097151){e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"));return}this._payloadLength=4294967296*r+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));return}this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&d(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=5,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,(e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0){t(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));return}this._fragments.push(r)}this.dataMessage(t),0===this._state&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=0;return}let t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?u(r,t):"arraybuffer"===this._binaryType?c(u(r,t)):"blob"===this._binaryType?new Blob(r):r,this._allowSynchronousEvents?(this.emit("message",n,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",n,!0),this._state=0,this.startLoop(e)}))}else{let n=u(r,t);if(!this._skipUTF8Validation&&!h(n)){e(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));return}5===this._state||this._allowSynchronousEvents?(this.emit("message",n,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",n,!1),this._state=0,this.startLoop(e)}))}}controlMessage(e,t){if(8===this._opcode){if(0===e.length)this._loop=!1,this.emit("conclude",1005,o),this.end();else{let r=e.readUInt16BE(0);if(!p(r)){t(this.createError(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));return}let n=new f(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!h(n)){t(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));return}this._loop=!1,this.emit("conclude",r,n),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)}))}createError(e,t,r,n,i){this._loop=!1,this._errored=!0;let s=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(s,this.createError),s.code=i,s[a]=n,s}}e.exports=m},4036:(e,t,r)=>{"use strict";let n;let{Duplex:i}=r(2781),{randomFillSync:s}=r(6113),o=r(7959),{EMPTY_BUFFER:a,kWebSocket:l,NOOP:u}=r(9353),{isBlob:c,isValidStatusCode:d}=r(4568),{mask:p,toBuffer:h}=r(7878),f=Symbol("kByteLength"),m=Buffer.alloc(4),g=8192;class y{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=u,this[l]=void 0}static frame(e,t){let r,i;let o=!1,a=2,l=!1;t.mask&&(r=t.maskBuffer||m,t.generateMask?t.generateMask(r):(8192===g&&(void 0===n&&(n=Buffer.alloc(8192)),s(n,0,8192),g=0),r[0]=n[g++],r[1]=n[g++],r[2]=n[g++],r[3]=n[g++]),l=(r[0]|r[1]|r[2]|r[3])==0,a=6),"string"==typeof e?i=(!t.mask||l)&&void 0!==t[f]?t[f]:(e=Buffer.from(e)).length:(i=e.length,o=t.mask&&t.readOnly&&!l);let u=i;i>=65536?(a+=8,u=127):i>125&&(a+=2,u=126);let c=Buffer.allocUnsafe(o?i+a:a);return(c[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(c[0]|=64),c[1]=u,126===u?c.writeUInt16BE(i,2):127===u&&(c[2]=c[3]=0,c.writeUIntBE(i,4,6)),t.mask)?(c[1]|=128,c[a-4]=r[0],c[a-3]=r[1],c[a-2]=r[2],c[a-1]=r[3],l)?[c,e]:o?(p(e,r,c,a,i),[c]):(p(e,r,e,0,i),[c,e]):[c,e]}close(e,t,r,n){let i;if(void 0===e)i=a;else if("number"==typeof e&&d(e)){if(void 0!==t&&t.length){let r=Buffer.byteLength(t);if(r>123)throw RangeError("The message must not be greater than 123 bytes");(i=Buffer.allocUnsafe(2+r)).writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else(i=Buffer.allocUnsafe(2)).writeUInt16BE(e,0)}else throw TypeError("First argument must be a valid error code number");let s={[f]:i.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,i,!1,s,n]):this.sendFrame(y.frame(i,s),n)}ping(e,t,r){let n,i;if("string"==typeof e?(n=Buffer.byteLength(e),i=!1):c(e)?(n=e.size,i=!1):(n=(e=h(e)).length,i=h.readOnly),n>125)throw RangeError("The data size must not be greater than 125 bytes");let s={[f]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};c(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,s,r]):this.getBlobData(e,!1,s,r):0!==this._state?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(y.frame(e,s),r)}pong(e,t,r){let n,i;if("string"==typeof e?(n=Buffer.byteLength(e),i=!1):c(e)?(n=e.size,i=!1):(n=(e=h(e)).length,i=h.readOnly),n>125)throw RangeError("The data size must not be greater than 125 bytes");let s={[f]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};c(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,s,r]):this.getBlobData(e,!1,s,r):0!==this._state?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(y.frame(e,s),r)}send(e,t,r){let n,i;let s=this._extensions[o.extensionName],a=t.binary?2:1,l=t.compress;"string"==typeof e?(n=Buffer.byteLength(e),i=!1):c(e)?(n=e.size,i=!1):(n=(e=h(e)).length,i=h.readOnly),this._firstFragment?(this._firstFragment=!1,l&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(l=n>=s._threshold),this._compress=l):(l=!1,a=0),t.fin&&(this._firstFragment=!0);let u={[f]:n,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:i,rsv1:l};c(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,u,r]):this.getBlobData(e,this._compress,u,r):0!==this._state?this.enqueue([this.dispatch,e,this._compress,u,r]):this.dispatch(e,this._compress,u,r)}getBlobData(e,t,r,n){this._bufferedBytes+=r[f],this._state=2,e.arrayBuffer().then(e=>{if(this._socket.destroyed){let e=Error("The socket was closed while the blob was being read");process.nextTick(v,this,e,n);return}this._bufferedBytes-=r[f];let i=h(e);t?this.dispatch(i,t,r,n):(this._state=0,this.sendFrame(y.frame(i,r),n),this.dequeue())}).catch(e=>{process.nextTick(_,this,e,n)})}dispatch(e,t,r,n){if(!t){this.sendFrame(y.frame(e,r),n);return}let i=this._extensions[o.extensionName];this._bufferedBytes+=r[f],this._state=1,i.compress(e,r.fin,(e,t)=>{if(this._socket.destroyed){v(this,Error("The socket was closed while data was being compressed"),n);return}this._bufferedBytes-=r[f],this._state=0,r.readOnly=!1,this.sendFrame(y.frame(t,r),n),this.dequeue()})}dequeue(){for(;0===this._state&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][f],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][f],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}function v(e,t,r){"function"==typeof r&&r(t);for(let r=0;r<e._queue.length;r++){let n=e._queue[r],i=n[n.length-1];"function"==typeof i&&i(t)}}function _(e,t,r){v(e,t,r),e.onerror(t)}e.exports=y},2504:(e,t,r)=>{"use strict";r(6342);let{Duplex:n}=r(2781);function i(e){e.emit("close")}function s(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let r=!0,a=new n({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",function(t,r){let n=!r&&a._readableState.objectMode?t.toString():t;a.push(n)||e.pause()}),e.once("error",function(e){a.destroyed||(r=!1,a.destroy(e))}),e.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(t,n){if(e.readyState===e.CLOSED){n(t),process.nextTick(i,a);return}let s=!1;e.once("error",function(e){s=!0,n(e)}),e.once("close",function(){s||n(t),process.nextTick(i,a)}),r&&e.terminate()},a._final=function(t){if(e.readyState===e.CONNECTING){e.once("open",function(){a._final(t)});return}null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",function(){t()}),e.close()))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,r,n){if(e.readyState===e.CONNECTING){e.once("open",function(){a._write(t,r,n)});return}e.send(t,n)},a.on("end",s),a.on("error",o),a}},2444:(e,t,r)=>{"use strict";let{tokenChars:n}=r(4568);e.exports={parse:function(e){let t=new Set,r=-1,i=-1,s=0;for(;s<e.length;s++){let o=e.charCodeAt(s);if(-1===i&&1===n[o])-1===r&&(r=s);else if(0!==s&&(32===o||9===o))-1===i&&-1!==r&&(i=s);else if(44===o){if(-1===r)throw SyntaxError(`Unexpected character at index ${s}`);-1===i&&(i=s);let n=e.slice(r,i);if(t.has(n))throw SyntaxError(`The "${n}" subprotocol is duplicated`);t.add(n),r=i=-1}else throw SyntaxError(`Unexpected character at index ${s}`)}if(-1===r||-1!==i)throw SyntaxError("Unexpected end of input");let o=e.slice(r,s);if(t.has(o))throw SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}},4568:(e,t,r)=>{"use strict";let{isUtf8:n}=r(4300),{hasBlob:i}=r(9353);function s(e){let t=e.length,r=0;for(;r<t;)if((128&e[r])==0)r++;else if((224&e[r])==192){if(r+1===t||(192&e[r+1])!=128||(254&e[r])==192)return!1;r+=2}else if((240&e[r])==224){if(r+2>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||224===e[r]&&(224&e[r+1])==128||237===e[r]&&(224&e[r+1])==160)return!1;r+=3}else{if((248&e[r])!=240||r+3>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||(192&e[r+3])!=128||240===e[r]&&(240&e[r+1])==128||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}if(e.exports={isBlob:function(e){return i&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:s,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},n)e.exports.isValidUTF8=function(e){return e.length<24?s(e):n(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=r(3739);e.exports.isValidUTF8=function(e){return e.length<32?s(e):t(e)}}catch(e){}},359:(e,t,r)=>{"use strict";let n=r(2361),i=r(3685),{Duplex:s}=r(2781),{createHash:o}=r(6113),a=r(9964),l=r(7959),u=r(2444),c=r(6342),{GUID:d,kWebSocket:p}=r(9353),h=/^[+/0-9A-Za-z]{22}==$/;class f extends n{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:c,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer((e,t)=>{let r=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(let r of Object.keys(t))e.on(r,t[r]);return function(){for(let r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,n)=>{this.handleUpgrade(t,r,n,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state){e&&this.once("close",()=>{e(Error("The server is not running"))}),process.nextTick(m,this);return}if(e&&this.once("close",e),1!==this._state){if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(m,this);else{let e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close(()=>{m(this)})}}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,n){t.on("error",g);let i=e.headers["sec-websocket-key"],s=e.headers.upgrade,o=+e.headers["sec-websocket-version"];if("GET"!==e.method){v(this,e,t,405,"Invalid HTTP method");return}if(void 0===s||"websocket"!==s.toLowerCase()){v(this,e,t,400,"Invalid Upgrade header");return}if(void 0===i||!h.test(i)){v(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(13!==o&&8!==o){v(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});return}if(!this.shouldHandle(e)){y(t,400);return}let c=e.headers["sec-websocket-protocol"],d=new Set;if(void 0!==c)try{d=u.parse(c)}catch(r){v(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let p=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==p){let r=new l(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let e=a.parse(p);e[l.extensionName]&&(r.accept(e[l.extensionName]),f[l.extensionName]=r)}catch(r){v(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let s={origin:e.headers[`${8===o?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(2===this.options.verifyClient.length){this.options.verifyClient(s,(s,o,a,l)=>{if(!s)return y(t,o||401,a,l);this.completeUpgrade(f,i,d,e,t,r,n)});return}if(!this.options.verifyClient(s))return y(t,401)}this.completeUpgrade(f,i,d,e,t,r,n)}completeUpgrade(e,t,r,n,i,s,u){if(!i.readable||!i.writable)return i.destroy();if(i[p])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return y(i,503);let c=o("sha1").update(t+d).digest("base64"),h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${c}`],f=new this.options.WebSocket(null,void 0,this.options);if(r.size){let e=this.options.handleProtocols?this.options.handleProtocols(r,n):r.values().next().value;e&&(h.push(`Sec-WebSocket-Protocol: ${e}`),f._protocol=e)}if(e[l.extensionName]){let t=e[l.extensionName].params,r=a.format({[l.extensionName]:[t]});h.push(`Sec-WebSocket-Extensions: ${r}`),f._extensions=e}this.emit("headers",h,n),i.write(h.concat("\r\n").join("\r\n")),i.removeListener("error",g),f.setSocket(i,s,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(f),f.on("close",()=>{this.clients.delete(f),this._shouldEmitClose&&!this.clients.size&&process.nextTick(m,this)})),u(f,n)}}function m(e){e._state=2,e.emit("close")}function g(){this.destroy()}function y(e,t,r,n){r=r||i.STATUS_CODES[t],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r
`+Object.keys(n).map(e=>`${e}: ${n[e]}`).join("\r\n")+"\r\n\r\n"+r)}function v(e,t,r,n,i,s){if(e.listenerCount("wsClientError")){let n=Error(i);Error.captureStackTrace(n,v),e.emit("wsClientError",n,r,t)}else y(r,n,i,s)}e.exports=f},6342:(e,t,r)=>{"use strict";let n=r(2361),i=r(5687),s=r(3685),o=r(1808),a=r(4404),{randomBytes:l,createHash:u}=r(6113),{Duplex:c,Readable:d}=r(2781),{URL:p}=r(7310),h=r(7959),f=r(3958),m=r(4036),{isBlob:g}=r(4568),{BINARY_TYPES:y,EMPTY_BUFFER:v,GUID:_,kForOnEventAttribute:b,kListener:E,kStatusCode:x,kWebSocket:w,NOOP:A}=r(9353),{EventTarget:{addEventListener:T,removeEventListener:S}}=r(1368),{format:C,parse:O}=r(9964),{toBuffer:N}=r(7878),I=Symbol("kAborted"),k=[8,13],R=["CONNECTING","OPEN","CLOSING","CLOSED"],P=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class j extends n{constructor(e,t,r){super(),this._binaryType=y[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=v,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=j.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(r=t,t=[]):t=[t]),function e(t,r,n,o){let a,c,d,f;let m={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:k[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...o,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=m.autoPong,!k.includes(m.protocolVersion))throw RangeError(`Unsupported protocol version: ${m.protocolVersion} (supported versions: ${k.join(", ")})`);if(r instanceof p)a=r;else try{a=new p(r)}catch(e){throw SyntaxError(`Invalid URL: ${r}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),t._url=a.href;let g="wss:"===a.protocol,y="ws+unix:"===a.protocol;if("ws:"===a.protocol||g||y?y&&!a.pathname?c="The URL's pathname is empty":a.hash&&(c="The URL contains a fragment identifier"):c='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',c){let e=SyntaxError(c);if(0===t._redirects)throw e;M(t,e);return}let v=g?443:80,b=l(16).toString("base64"),E=g?i.request:s.request,x=new Set;if(m.createConnection=m.createConnection||(g?D:U),m.defaultPort=m.defaultPort||v,m.port=a.port||v,m.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,m.headers={...m.headers,"Sec-WebSocket-Version":m.protocolVersion,"Sec-WebSocket-Key":b,Connection:"Upgrade",Upgrade:"websocket"},m.path=a.pathname+a.search,m.timeout=m.handshakeTimeout,m.perMessageDeflate&&(d=new h(!0!==m.perMessageDeflate?m.perMessageDeflate:{},!1,m.maxPayload),m.headers["Sec-WebSocket-Extensions"]=C({[h.extensionName]:d.offer()})),n.length){for(let e of n){if("string"!=typeof e||!P.test(e)||x.has(e))throw SyntaxError("An invalid or duplicated subprotocol was specified");x.add(e)}m.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(m.origin&&(m.protocolVersion<13?m.headers["Sec-WebSocket-Origin"]=m.origin:m.headers.Origin=m.origin),(a.username||a.password)&&(m.auth=`${a.username}:${a.password}`),y){let e=m.path.split(":");m.socketPath=e[0],m.path=e[1]}if(m.followRedirects){if(0===t._redirects){t._originalIpc=y,t._originalSecure=g,t._originalHostOrSocketPath=y?m.socketPath:a.host;let e=o&&o.headers;if(o={...o,headers:{}},e)for(let[t,r]of Object.entries(e))o.headers[t.toLowerCase()]=r}else if(0===t.listenerCount("redirect")){let e=y?!!t._originalIpc&&m.socketPath===t._originalHostOrSocketPath:!t._originalIpc&&a.host===t._originalHostOrSocketPath;e&&(!t._originalSecure||g)||(delete m.headers.authorization,delete m.headers.cookie,e||delete m.headers.host,m.auth=void 0)}m.auth&&!o.headers.authorization&&(o.headers.authorization="Basic "+Buffer.from(m.auth).toString("base64")),f=t._req=E(m),t._redirects&&t.emit("redirect",t.url,f)}else f=t._req=E(m);m.timeout&&f.on("timeout",()=>{L(t,f,"Opening handshake has timed out")}),f.on("error",e=>{null===f||f[I]||(f=t._req=null,M(t,e))}),f.on("response",i=>{let s=i.headers.location,a=i.statusCode;if(s&&m.followRedirects&&a>=300&&a<400){let i;if(++t._redirects>m.maxRedirects){L(t,f,"Maximum redirects exceeded");return}f.abort();try{i=new p(s,r)}catch(e){M(t,SyntaxError(`Invalid URL: ${s}`));return}e(t,i,n,o)}else t.emit("unexpected-response",f,i)||L(t,f,`Unexpected server response: ${i.statusCode}`)}),f.on("upgrade",(e,r,n)=>{let i;if(t.emit("upgrade",e),t.readyState!==j.CONNECTING)return;f=t._req=null;let s=e.headers.upgrade;if(void 0===s||"websocket"!==s.toLowerCase()){L(t,r,"Invalid Upgrade header");return}let o=u("sha1").update(b+_).digest("base64");if(e.headers["sec-websocket-accept"]!==o){L(t,r,"Invalid Sec-WebSocket-Accept header");return}let a=e.headers["sec-websocket-protocol"];if(void 0!==a?x.size?x.has(a)||(i="Server sent an invalid subprotocol"):i="Server sent a subprotocol but none was requested":x.size&&(i="Server sent no subprotocol"),i){L(t,r,i);return}a&&(t._protocol=a);let l=e.headers["sec-websocket-extensions"];if(void 0!==l){let e;if(!d){L(t,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}try{e=O(l)}catch(e){L(t,r,"Invalid Sec-WebSocket-Extensions header");return}let n=Object.keys(e);if(1!==n.length||n[0]!==h.extensionName){L(t,r,"Server indicated an extension that was not requested");return}try{d.accept(e[h.extensionName])}catch(e){L(t,r,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[h.extensionName]=d}t.setSocket(r,n,{allowSynchronousEvents:m.allowSynchronousEvents,generateMask:m.generateMask,maxPayload:m.maxPayload,skipUTF8Validation:m.skipUTF8Validation})}),m.finishRequest?m.finishRequest(f,t):f.end()}(this,e,t,r)):(this._autoPong=r.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){y.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){let n=new f({allowSynchronousEvents:r.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation}),i=new m(e,this._extensions,r.generateMask);this._receiver=n,this._sender=i,this._socket=e,n[w]=this,i[w]=this,e[w]=this,n.on("conclude",F),n.on("drain",q),n.on("error",H),n.on("message",V),n.on("ping",$),n.on("pong",J),i.onerror=z,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Y),e.on("data",X),e.on("end",Q),e.on("error",Z),this._readyState=j.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=j.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=j.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==j.CLOSED){if(this.readyState===j.CONNECTING){L(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===j.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=j.CLOSING,this._sender.close(e,t,!this._isServer,e=>{!e&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),K(this)}}pause(){this.readyState!==j.CONNECTING&&this.readyState!==j.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===j.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==j.OPEN){G(this,e,r);return}void 0===t&&(t=!this._isServer),this._sender.ping(e||v,t,r)}pong(e,t,r){if(this.readyState===j.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==j.OPEN){G(this,e,r);return}void 0===t&&(t=!this._isServer),this._sender.pong(e||v,t,r)}resume(){this.readyState!==j.CONNECTING&&this.readyState!==j.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===j.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==j.OPEN){G(this,e,r);return}let n={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[h.extensionName]||(n.compress=!1),this._sender.send(e||v,n,r)}terminate(){if(this.readyState!==j.CLOSED){if(this.readyState===j.CONNECTING){L(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=j.CLOSING,this._socket.destroy())}}}function M(e,t){e._readyState=j.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function U(e){return e.path=e.socketPath,o.connect(e)}function D(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=o.isIP(e.host)?"":e.host),a.connect(e)}function L(e,t,r){e._readyState=j.CLOSING;let n=Error(r);Error.captureStackTrace(n,L),t.setHeader?(t[I]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(M,e,n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function G(e,t,r){if(t){let r=g(t)?t.size:N(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){let t=Error(`WebSocket is not open: readyState ${e.readyState} (${R[e.readyState]})`);process.nextTick(r,t)}}function F(e,t){let r=this[w];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[w]&&(r._socket.removeListener("data",X),process.nextTick(W,r._socket),1005===e?r.close():r.close(e,t))}function q(){let e=this[w];e.isPaused||e._socket.resume()}function H(e){let t=this[w];void 0!==t._socket[w]&&(t._socket.removeListener("data",X),process.nextTick(W,t._socket),t.close(e[x])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function B(){this[w].emitClose()}function V(e,t){this[w].emit("message",e,t)}function $(e){let t=this[w];t._autoPong&&t.pong(e,!this._isServer,A),t.emit("ping",e)}function J(e){this[w].emit("pong",e)}function W(e){e.resume()}function z(e){let t=this[w];t.readyState===j.CLOSED||(t.readyState===j.OPEN&&(t._readyState=j.CLOSING,K(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function K(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),3e4)}function Y(){let e;let t=this[w];this.removeListener("close",Y),this.removeListener("data",X),this.removeListener("end",Q),t._readyState=j.CLOSING,this._readableState.endEmitted||t._closeFrameReceived||t._receiver._writableState.errorEmitted||null===(e=t._socket.read())||t._receiver.write(e),t._receiver.end(),this[w]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",B),t._receiver.on("finish",B))}function X(e){this[w]._receiver.write(e)||this.pause()}function Q(){let e=this[w];e._readyState=j.CLOSING,e._receiver.end(),this.end()}function Z(){let e=this[w];this.removeListener("error",Z),this.on("error",A),e&&(e._readyState=j.CLOSING,this.destroy())}Object.defineProperty(j,"CONNECTING",{enumerable:!0,value:R.indexOf("CONNECTING")}),Object.defineProperty(j.prototype,"CONNECTING",{enumerable:!0,value:R.indexOf("CONNECTING")}),Object.defineProperty(j,"OPEN",{enumerable:!0,value:R.indexOf("OPEN")}),Object.defineProperty(j.prototype,"OPEN",{enumerable:!0,value:R.indexOf("OPEN")}),Object.defineProperty(j,"CLOSING",{enumerable:!0,value:R.indexOf("CLOSING")}),Object.defineProperty(j.prototype,"CLOSING",{enumerable:!0,value:R.indexOf("CLOSING")}),Object.defineProperty(j,"CLOSED",{enumerable:!0,value:R.indexOf("CLOSED")}),Object.defineProperty(j.prototype,"CLOSED",{enumerable:!0,value:R.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(e=>{Object.defineProperty(j.prototype,e,{enumerable:!0})}),["open","error","close","message"].forEach(e=>{Object.defineProperty(j.prototype,`on${e}`,{enumerable:!0,get(){for(let t of this.listeners(e))if(t[b])return t[E];return null},set(t){for(let t of this.listeners(e))if(t[b]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[b]:!0})}})}),j.prototype.addEventListener=T,j.prototype.removeEventListener=S,e.exports=j},1506:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s,metadata:()=>i});var n=r(9510);r(7272);let i={title:"MindMate | Adaptive Study Buddy",description:"AI-powered study companion with adaptive plans, quizzes, and tutoring."};function s({children:e}){return n.jsx("html",{lang:"en",children:n.jsx("body",{className:"bg-ambient text-slate-100 antialiased",children:e})})}},908:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>s,default:()=>a});var n=r(8570);let i=(0,n.createProxy)(String.raw`C:\Users\JAHNVI SAXENA\Desktop\mindmate_-adaptive-study-buddy\app\page.tsx`),{__esModule:s,$$typeof:o}=i;i.default;let a=(0,n.createProxy)(String.raw`C:\Users\JAHNVI SAXENA\Desktop\mindmate_-adaptive-study-buddy\app\page.tsx#default`)},7272:()=>{},5506:(e,t,r)=>{"use strict";let n=r(3674);e.exports={pkg:n}},1324:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GCE_LINUX_BIOS_PATHS=void 0,t.isGoogleCloudServerless=o,t.isGoogleComputeEngineLinux=a,t.isGoogleComputeEngineMACAddress=l,t.isGoogleComputeEngine=u,t.detectGCPResidency=function(){return o()||u()};let n=r(7147),i=r(2037);t.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let s=/^42:01/;function o(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function a(){if("linux"!==(0,i.platform)())return!1;try{(0,n.statSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_DATE);let e=(0,n.readFileSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_VENDOR,"utf8");return/Google/.test(e)}catch{return!1}}function l(){for(let e of Object.values((0,i.networkInterfaces)()))if(e){for(let{mac:t}of e)if(s.test(t))return!0}return!1}function u(){return a()||l()}},759:function(e,t,r){"use strict";let n;var i,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(i=function(e){return(i=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=i(e),n=0;n<r.length;n++)"default"!==r[n]&&s(t,e,r[n]);return o(t,e),t}),l=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.gcpResidencyCache=t.METADATA_SERVER_DETECTION=t.HEADERS=t.HEADER_VALUE=t.HEADER_NAME=t.SECONDARY_HOST_ADDRESS=t.HOST_ADDRESS=t.BASE_PATH=void 0,t.instance=function(e){return m("instance",e)},t.project=function(e){return m("project",e)},t.universe=function(e){return m("universe",e)},t.bulk=y,t.isAvailable=v,t.resetIsAvailableCache=function(){n=void 0},t.getGCPResidency=_,t.setGCPResidency=b,t.requestTimeout=E;let u=r(206),c=r(9361),d=r(1324),p=a(r(5348));t.BASE_PATH="/computeMetadata/v1",t.HOST_ADDRESS="http://169.254.169.254",t.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",t.HEADER_NAME="Metadata-Flavor",t.HEADER_VALUE="Google",t.HEADERS=Object.freeze({[t.HEADER_NAME]:t.HEADER_VALUE});let h=p.log("gcp-metadata");function f(e){return e||(e=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||t.HOST_ADDRESS),/^https?:\/\//.test(e)||(e=`http://${e}`),new URL(t.BASE_PATH,e).href}async function m(e,r={},n=3,i=!1){let s=new Headers(t.HEADERS),o="",a={};"object"==typeof e?(new Headers(e.headers).forEach((e,t)=>s.set(t,e)),o=e.metadataKey,a=e.params||a,n=e.noResponseRetries||n,i=e.fastFail||i):o=e,"string"==typeof r?o+=`/${r}`:(function(e){Object.keys(e).forEach(e=>{switch(e){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${e}' is not a valid configuration option.`)}})}(r),r.property&&(o+=`/${r.property}`),new Headers(r.headers).forEach((e,t)=>s.set(t,e)),a=r.params||a);let l=i?g:u.request,d={url:`${f()}/${o}`,headers:s,retryConfig:{noResponseRetries:n},params:a,responseType:"text",timeout:E()};h.info("instance request %j",d);let p=await l(d);h.info("instance metadata is %s",p.data);let m=p.headers.get(t.HEADER_NAME);if(m!==t.HEADER_VALUE)throw RangeError(`Invalid response from metadata service: incorrect ${t.HEADER_NAME} header. Expected '${t.HEADER_VALUE}', got ${m?`'${m}'`:"no header"}`);if("string"==typeof p.data)try{return c.parse(p.data)}catch{}return p.data}async function g(e){let r={...e,url:e.url?.toString().replace(f(),f(t.SECONDARY_HOST_ADDRESS))};return Promise.any([(0,u.request)(e),(0,u.request)(r)])}async function y(e){let t={};return await Promise.all(e.map(e=>(async()=>{let r=await m(e);t[e.metadataKey]=r})())),t}async function v(){if(process.env.METADATA_SERVER_DETECTION){let e=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(e in t.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${e}\`, but it should be \`${Object.keys(t.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(e){case"assume-present":return!0;case"none":return!1;case"bios-only":return _()}}try{return void 0===n&&(n=m("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await n,!0}catch(e){if(process.env.DEBUG_AUTH&&console.info(e),"request-timeout"===e.type||e.response&&404===e.response.status)return!1;if(!(e.response&&404===e.response.status)&&(!e.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(e.code.toString()))){let t="UNKNOWN";e.code&&(t=e.code.toString()),process.emitWarning(`received unexpected error = ${e.message} code = ${t}`,"MetadataLookupWarning")}return!1}}function _(){return null===t.gcpResidencyCache&&b(),t.gcpResidencyCache}function b(e=null){t.gcpResidencyCache=null!==e?e:(0,d.detectGCPResidency)()}function E(){return _()?0:3e3}t.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),t.gcpResidencyCache=null,l(r(1324),t)},4574:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_AGENT=t.PRODUCT_NAME=t.pkg=void 0;let n=r(9830);t.pkg=n;let i="google-api-nodejs-client";t.PRODUCT_NAME=i;let s=`${i}/${n.version}`;t.USER_AGENT=s},1838:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleToken=void 0;var n=l(r(7147)),i=r(206),s=l(r(8287)),o=l(r(1017)),a=r(3837);function l(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var i,s,o={__proto__:null,default:e};if(null===e||"object"!=u(e)&&"function"!=typeof e)return o;if(i=t?n:r){if(i.has(e))return i.get(e);i.set(e,o)}for(var a in e)"default"!==a&&({}).hasOwnProperty.call(e,a)&&((s=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,a))&&(s.get||s.set)?i(o,a,s):o[a]=e[a]);return o})(e,t)}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function d(e,t,r){return e.set(p(e,t),r),r}function p(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw TypeError("Private element is not present on this object")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function f(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function g(e){var t="function"==typeof Map?new Map:void 0;return(g=function(e){if(null===e||!function(e){try{return -1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(y())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&v(i,r.prototype),i}(e,arguments,_(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),v(r,e)})(e)}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}function x(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var l=Object.create((n&&n.prototype instanceof a?n:a).prototype);return w(l,"_invoke",function(r,n,i){var s,a,l,u=0,c=i||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return s=t,a=0,l=e,p.n=r,o}};function h(r,n){for(a=r,l=n,t=0;!d&&u&&!i&&t<c.length;t++){var i,s=c[t],h=p.p,f=s[2];r>3?(i=f===n)&&(l=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=h&&((i=r<2&&h<s[1])?(a=0,p.v=n,p.n=s[1]):h<f&&(i=r<3||s[0]>n||n>f)&&(s[4]=r,s[5]=n,p.n=f,a=0))}if(i||r>1)return o;throw d=!0,n}return function(i,c,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&h(c,f),a=c,l=f;(t=a<2?e:l)||!d;){s||(a?a<3?(a>1&&(p.n=-1),h(a,l)):p.n=l:p.v=l);try{if(u=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(d=p.n<0)?l:r.call(n,p))!==o)break}catch(t){s=e,a=1,l=t}finally{u=1}}return{value:t,done:d}}}(r,i,s),!0),l}var o={};function a(){}function l(){}function u(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(w(t={},n,function(){return this}),t),d=u.prototype=a.prototype=Object.create(c);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,w(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=u,w(d,"constructor",u),w(u,"constructor",l),l.displayName="GeneratorFunction",w(u,i,"GeneratorFunction"),w(d),w(d,i,"Generator"),w(d,n,function(){return this}),w(d,"toString",function(){return"[object Generator]"}),(x=function(){return{w:s,m:p}})()}function w(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}(w=function(e,t,r,n){if(t)i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{var s=function(t,r){w(e,t,function(e){return this._invoke(t,r,e)})};s("next",0),s("throw",1),s("return",2)}})(e,t,r,n)}function A(e,t,r,n,i,s,o){try{var a=e[s](o),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function T(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){A(s,n,i,o,a,"next",e)}function a(e){A(s,n,i,o,a,"throw",e)}o(void 0)})}}var S=n.readFile?(0,a.promisify)(n.readFile):T(x().m(function e(){return x().w(function(e){for(;;)switch(e.n){case 0:throw new O("use key rather than keyFile.","MISSING_CREDENTIALS");case 1:return e.a(2)}},e)})),C="https://oauth2.googleapis.com/token",O=function(e){function t(e,r){var n,i,s;return m(this,t),i=t,s=[e],i=_(i),b(n=function(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,y()?Reflect.construct(i,s||[],_(this).constructor):i.apply(this,s)),"code",void 0),n.code=r,n}return function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(t,e),f(t)}(g(Error)),N=new WeakMap,I=new WeakSet;function k(e){return R.apply(this,arguments)}function R(){return(R=T(x().m(function e(t){return x().w(function(e){for(;;)switch(e.n){case 0:if(!N.get(p(N,this))||t.forceRefresh){e.n=1;break}return e.a(2,N.get(p(N,this)));case 1:return e.p=1,e.n=2,d(N,this,p(I,this,P).call(this,t));case 2:return e.a(2,e.v);case 3:return e.p=3,d(N,this,void 0),e.f(3);case 4:return e.a(2)}},e,this,[[1,,3,4]])}))).apply(this,arguments)}function P(e){return j.apply(this,arguments)}function j(){return(j=T(x().m(function e(t){var r;return x().w(function(e){for(;;)switch(e.n){case 0:if(!(!1===this.isTokenExpiring()&&!1===t.forceRefresh)){e.n=1;break}return e.a(2,Promise.resolve(this.rawToken));case 1:if(!(!this.key&&!this.keyFile)){e.n=2;break}throw Error("No key or keyFile set.");case 2:if(!(!this.key&&this.keyFile)){e.n=4;break}return e.n=3,this.getCredentials(this.keyFile);case 3:r=e.v,this.key=r.privateKey,this.iss=r.clientEmail||this.iss,r.clientEmail||p(I,this,M).call(this);case 4:return e.a(2,p(I,this,G).call(this))}},e,this)}))).apply(this,arguments)}function M(){if(!this.iss)throw new O("email is required.","MISSING_CREDENTIALS")}function U(){return D.apply(this,arguments)}function D(){return(D=T(x().m(function e(){var t;return x().w(function(e){for(;;)switch(e.n){case 0:if(this.accessToken){e.n=1;break}throw Error("No token to revoke.");case 1:return t="https://oauth2.googleapis.com/revoke?token="+this.accessToken,e.n=2,this.transporter.request({url:t,retry:!0});case 2:p(I,this,L).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims});case 3:return e.a(2)}},e,this)}))).apply(this,arguments)}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.keyFile=e.keyFile,this.key=e.key,this.rawToken=void 0,this.iss=e.email||e.iss,this.sub=e.sub,this.additionalClaims=e.additionalClaims,"object"===u(e.scope)?this.scope=e.scope.join(" "):this.scope=e.scope,this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis,e.transporter&&(this.transporter=e.transporter)}function G(){return F.apply(this,arguments)}function F(){return(F=T(x().m(function e(){var t,r,n,i,o,a,l,u,c,d;return x().w(function(e){for(;;)switch(e.n){case 0:return t=Math.floor(new Date().getTime()/1e3),r=this.additionalClaims||{},n=Object.assign({iss:this.iss,scope:this.scope,aud:C,exp:t+3600,iat:t,sub:this.sub},r),i=s.sign({header:{alg:"RS256"},payload:n,secret:this.key}),e.p=1,e.n=2,this.transporter.request({method:"POST",url:C,data:new URLSearchParams({grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:i}),responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});case 2:return o=e.v,this.rawToken=o.data,this.expiresAt=null===o.data.expires_in||void 0===o.data.expires_in?void 0:(t+o.data.expires_in)*1e3,e.a(2,this.rawToken);case 3:throw e.p=3,d=e.v,this.rawToken=void 0,this.tokenExpires=void 0,(u=d.response&&null!==(a=d.response)&&void 0!==a&&a.data?null===(l=d.response)||void 0===l?void 0:l.data:{}).error&&(c=u.error_description?": ".concat(u.error_description):"",d.message="".concat(u.error).concat(c)),d;case 4:return e.a(2)}},e,this,[[1,3]])}))).apply(this,arguments)}t.GoogleToken=function(){var e;return f(function e(t){var r;m(this,e),c(this,I),I.add(this),b(this,"expiresAt",void 0),b(this,"key",void 0),b(this,"keyFile",void 0),b(this,"iss",void 0),b(this,"sub",void 0),b(this,"scope",void 0),b(this,"rawToken",void 0),b(this,"tokenExpires",void 0),b(this,"email",void 0),b(this,"additionalClaims",void 0),b(this,"eagerRefreshThresholdMillis",void 0),b(this,"transporter",{request:function(e){return(0,i.request)(e)}}),r=void 0,c(this,N),N.set(this,r),p(I,this,L).call(this,t)},[{key:"accessToken",get:function(){return this.rawToken?this.rawToken.access_token:void 0}},{key:"idToken",get:function(){return this.rawToken?this.rawToken.id_token:void 0}},{key:"tokenType",get:function(){return this.rawToken?this.rawToken.token_type:void 0}},{key:"refreshToken",get:function(){return this.rawToken?this.rawToken.refresh_token:void 0}},{key:"hasExpired",value:function(){var e=new Date().getTime();return!this.rawToken||!this.expiresAt||e>=this.expiresAt}},{key:"isTokenExpiring",value:function(){var e,t=new Date().getTime(),r=null!==(e=this.eagerRefreshThresholdMillis)&&void 0!==e?e:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=t+r}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===u(e)&&(t=e,e=void 0),t=Object.assign({forceRefresh:!1},t),e){var r=e;p(I,this,k).call(this,t).then(function(e){return r(null,e)},e);return}return p(I,this,k).call(this,t)}},{key:"getCredentials",value:(e=T(x().m(function e(t){var r,n,i,s,a;return x().w(function(e){for(;;)switch(e.n){case 0:a=o.extname(t),e.n=".json"===a?1:".der"===a?4:".crt"===a?4:".pem"===a?4:".p12"===a?6:".pfx"===a?6:7;break;case 1:return e.n=2,S(t,"utf8");case 2:if(n=(r=JSON.parse(e.v)).private_key,i=r.client_email,!(!n||!i)){e.n=3;break}throw new O("private_key and client_email are required.","MISSING_CREDENTIALS");case 3:return e.a(2,{privateKey:n,clientEmail:i});case 4:return e.n=5,S(t,"utf8");case 5:return s=e.v,e.a(2,{privateKey:s});case 6:throw new O("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");case 7:throw new O("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE");case 8:return e.a(2)}},e)})),function(t){return e.apply(this,arguments)})},{key:"revokeToken",value:function(e){if(e){p(I,this,U).call(this).then(function(){return e()},e);return}return p(I,this,U).call(this)}}])}()},3674:e=>{"use strict";e.exports=JSON.parse('{"name":"gaxios","version":"7.1.3","description":"A simple common HTTP client specifically for Google APIs and services.","main":"build/cjs/src/index.js","types":"build/cjs/src/index.d.ts","files":["build/"],"exports":{".":{"import":{"types":"./build/esm/src/index.d.ts","default":"./build/esm/src/index.js"},"require":{"types":"./build/cjs/src/index.d.ts","default":"./build/cjs/src/index.js"}}},"scripts":{"lint":"gts check --no-inline-config","test":"c8 mocha build/esm/test","presystem-test":"npm run compile","system-test":"mocha build/esm/system-test --timeout 80000","compile":"tsc -b ./tsconfig.json ./tsconfig.cjs.json && node utils/enable-esm.mjs","fix":"gts fix","prepare":"npm run compile","pretest":"npm run compile","webpack":"webpack","prebrowser-test":"npm run compile","browser-test":"node build/browser-test/browser-test-runner.js","docs":"jsdoc -c .jsdoc.js","docs-test":"linkinator docs","predocs-test":"npm run docs","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","prelint":"cd samples; npm link ../; npm install","clean":"gts clean"},"repository":{"type":"git","directory":"packages/gaxios","url":"https://github.com/googleapis/google-cloud-node-core.git"},"keywords":["google"],"engines":{"node":">=18"},"author":"Google, LLC","license":"Apache-2.0","devDependencies":{"@babel/plugin-proposal-private-methods":"^7.18.6","@types/cors":"^2.8.6","@types/express":"^5.0.0","@types/extend":"^3.0.1","@types/mocha":"^10.0.10","@types/multiparty":"4.2.1","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","@types/tmp":"0.2.6","assert":"^2.0.0","browserify":"^17.0.0","c8":"^10.0.0","cors":"^2.8.5","express":"^5.0.0","gts":"^6.0.0","is-docker":"^3.0.0","jsdoc":"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0","karma":"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1","linkinator":"^6.1.2","mocha":"^11.1.0","multiparty":"^4.2.1","mv":"^2.1.1","ncp":"^2.0.0","nock":"^14.0.0-beta.13","null-loader":"^4.0.0","pack-n-play":"^4.0.0","puppeteer":"^24.0.0","sinon":"^21.0.0","stream-browserify":"^3.0.0","tmp":"0.2.5","ts-loader":"^9.5.2","typescript":"^5.8.3","webpack":"^5.35.0","webpack-cli":"^6.0.1"},"dependencies":{"extend":"^3.0.2","https-proxy-agent":"^7.0.1","node-fetch":"^3.3.2","rimraf":"^5.0.1"},"homepage":"https://github.com/googleapis/google-cloud-node-core/tree/main/packages/gaxios"}')},9830:e=>{"use strict";e.exports=JSON.parse('{"name":"google-auth-library","version":"10.5.0","author":"Google Inc.","description":"Google APIs Authentication Client Library for Node.js","engines":{"node":">=18"},"main":"./build/src/index.js","types":"./build/src/index.d.ts","repository":"googleapis/google-auth-library-nodejs.git","keywords":["google","api","google apis","client","client library"],"dependencies":{"base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11","gaxios":"^7.0.0","gcp-metadata":"^8.0.0","google-logging-utils":"^1.0.0","gtoken":"^8.0.0","jws":"^4.0.0"},"devDependencies":{"@types/base64-js":"^1.2.5","@types/jws":"^3.1.0","@types/mocha":"^10.0.10","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","assert-rejects":"^1.0.0","c8":"^10.0.0","codecov":"^3.0.2","gts":"^6.0.0","is-docker":"^3.0.0","jsdoc":"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0","karma":"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1","keypair":"^1.0.4","mocha":"^11.1.0","mv":"^2.1.1","ncp":"^2.0.0","nock":"^14.0.5","null-loader":"^4.0.0","puppeteer":"^24.0.0","sinon":"^21.0.0","ts-loader":"^8.0.0","typescript":"5.8.2","webpack":"^5.21.2","webpack-cli":"^4.0.0"},"files":["build/src","!build/src/**/*.map"],"scripts":{"test":"c8 mocha build/test","clean":"gts clean","prepare":"npm run compile","lint":"gts check --no-inline-config","compile":"tsc -p .","fix":"gts fix","pretest":"npm run compile -- --sourceMap","docs":"jsdoc -c .jsdoc.js","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile -- --sourceMap","webpack":"webpack","browser-test":"karma start","docs-test":"echo \'disabled until linkinator is fixed\'","predocs-test":"npm run docs","prelint":"cd samples; npm link ../; npm install"},"license":"Apache-2.0"}')}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,471],()=>r(6324));module.exports=n})();